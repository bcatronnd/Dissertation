---
abstract: |
    With development of new airborne optical systems, there is a significant
    amount of effort being put into maximizing the farfield performance of
    these optical systems. To meet this goal, the root mean square of the
    optical path difference, $\opdrms$, over the aperture, a measure of the
    nearfield optical distortions, is being reduced as much as possible.
    Part of this development process involves testing models of these
    systems with various configurations in wind tunnels. In these tests, the
    optical disturbances due to the testing environment are becoming a large
    percentage of the measured optical disturbances. It is now a necessity
    to be able to identify, measure, and remove the various noise sources
    that appear in aero-optical measurements that take place in wind
    tunnels.

    One of the primary sources of signal noise in these measurements, is
    acoustics. Both the wing-tunnel fan and the flow through out the tunnel
    generate large amounts of acoustic noise that travel throughout the
    tunnel as acoustic duct modes. The fan generates strong narrow-band
    signals at the blade-passing frequency and its harmonics. There are also
    significant broad-band acoustic duct mode signals along with vibration
    related signals and strong mostly-steady optical lensing signals that
    add to the overall measurement.

    A significant portion of this dissertation is dedicated to analyzing
    wind-tunnel optical wavefront data in multidimensional spectral space.
    The signal identification and filtering mostly take place in the
    multidimensional spectrum, where the optical wavefront is not only split
    into its temporal frequency components but also its spatial frequency
    components. A combination of three filters is able to remove most of the
    noise signals while retaining most of the aero-optical signal. A
    velocity filter, which retains a narrow band of signal that is traveling
    within a small velocity range, is able to remove most of the broad-band
    signal noise, especially at higher temporal-frequencies. A backward
    filter, which retains only the portion of a signal that is traveling in
    the direction of flow, removes signal that the velocity filter is not
    able to at lower temporal-frequencies. Finally a baseline filter
    identifies the baseline spectrum and removes narrow-band peaks.
author:
- Brian Lowell Catron
bibliography:
- '99\_references.bib'
title: 'Filtering of Acoustic Information from Aero-Optical Measurements'
---

To my wife Karen & our son Arthur

I would like to thank my advisors R. Mark Rennie and Eric J. Jumper
along with Stanislav Gordeyev for helping me grow not only in my ability
to take measurements, but also as a researcher, designing experiments
and analyzing the data. I would also like to think my fellow grad
students, particularly Jon Wells, Barry Pawlowski, Matt Kalensky, and
Matt Kemnetz, who endured alongside me. You helped me when I needed help
and gave me some interesting problems to solve.

Most of all I would like to thank my family. My parents, Kevin and Nila,
who pushed me to meet my potential when I was younger. I would like to
think you for the sacrifices you made for my benefit. Thank you Karen,
my wife, for putting up with my slow progress at times. Thank you for
everything you do for me and our child. Arthur, watching you grow and
learn brings me joy everyday.

Introduction {#chap:01_intro}
============

There have been two major attempts to field a directed-energy system
aboard an aircraft to date [@Jumper-2013-8KtN3pue]. The first was the
Airborne Laser Laboratory (ALL) which took place in the late 1970's and
early 1980's which used a CO$_2$ laser with a wavelength of 10.6-$\mu$m.
The second was the Airborne Laser (ABL) program which operated in the
2000's and used a COIL laser at 1.315-$\mu$m. Airborne optical systems
like ALL and ABL have to deal with a phenomenon known as "aero-optics,"
which refers to optical distortions caused by compressible aero-dynamic
flow features that pass through the outgoing beam. These optical
distortions were first noticed due to image degradation in wind tunnel
measurements in the 1950's [@Stine-1956-UaRzVZCe] as well as in
photo-reconnaissance missions in the 1960's [@Kyrazis-2013-vwKeEBym].

The peak on-target irradiance of a beam passing through an optical
disturbance, $I$, divided by the diffraction-limited performance, $I_0$,
is known as the Strehl ratio [@Mahajan-1982-kkXM4eaB], $\sr$,
$$\sr = \frac{I}{I_0} \textrm{.}
  \label{eqn:01_strehl_ratio_definition}$$ The diffraction-limited
performance is the beam intensity that would exist on the same target if
not for the optical disturbance. The Airborne Laser Laboratory had an
estimated Strehl ratio of 95%[@Jumper-2013-8KtN3pue] so that the
"aero-optics problem" effectively did not apply for this case. Following
the Airborne Laser Laboratory program there was a desire to move toward
shorter wavelengths in order to take advantage of improved
diffraction-limited performance, leading to a smaller-diameter focused
spot on target with a higher irradiance $I_0$: [@Jumper-2001-6QDh7zDy],
$$\frac{I_0}{P} = \frac{1}{\pi}\left(\frac{Ap}{\lambda z}\right)^2 \textrm{,}
  \label{eqn:01_farfield_intensity}$$ where $P$ is the laser output
power, $Ap$ is the aperture size, and $z$ is the propagation distance.
The improvement in diffraction-limited performance as the laser
wavelength is decreased is shown in Figure
[\[fig:01\_farfield\_intensity\]](#fig:01_farfield_intensity){reference-type="ref"
reference="fig:01_farfield_intensity"}.

![Diffraction-limited far-field intensity of a beam normalized by the
performance at
1-$\mu$m.](../matlab/01_introduction/farfield_intensity.eps)

[\[fig:01\_farfield\_intensity\]]{#fig:01_farfield_intensity
label="fig:01_farfield_intensity"}

By only changing the laser source from a 10-$\mu$m to 1-$\mu$m
wavelength the diffraction-limited performance can be increased 100
times.

Aero-optical issues start to become important as the wavelength is
decreased as is evident from the Maréchal approximation
[@Mahajan-1983-hg7ahvJM] which relates the Strehl ratio to wavelength,
$$\sr \approx \exp\left\{-\left[\frac{2\pi \opdrms}{\lambda}\right]^2\right\} \textrm{,}
  \label{eqn:01_strehl_ratio}$$ where $\opdrms$ is the spatial
root-mean-square of the optical path difference over the aperture and is
a way to quantify the optical disturbance as will be discussed further
in Chapter [2](#chap:02_lit_review){reference-type="ref"
reference="chap:02_lit_review"}. As stated above, the ALL had a Strehl
ratio of 95%; however, if the ALL system's laser was swapped with
another laser of a lower wavelength, the Strehl ratio would
significantly decrease as shown by Figure
[\[fig:01\_strehl\_ratio\]](#fig:01_strehl_ratio){reference-type="ref"
reference="fig:01_strehl_ratio"}.

![Strehl ratio due to the $\opdrms$ of the Airborne Laser Laboratory
(ALL) at various laser wavelengths. ALL had an estimated Strehl ratio of
95% with its 10.6-$\mu$m
laser.](../matlab/01_introduction/strehl_ratio.eps)

[\[fig:01\_strehl\_ratio\]]{#fig:01_strehl_ratio
label="fig:01_strehl_ratio"}

While going from 10 to 1-$\mu$m hypothetically results in a 100-fold
increase in diffraction-limited performance, the actual on-target
intensity that this hypothetical system obtains would be essentially
zero due to the much larger effect that aero-optical aberrations have on
the outgoing beam as the wavelength is reduced. This means that the
aero-optical problem can no longer be ignored, which was recognized as
one of the main developmental risks of the ABL program
[@DOTE-1999-HnkadUEw].

As the next generation of airborne directed-energy systems are developed
some amount of ground testing of those systems will need to occur. In
order to understand the aero-optical environment that these systems will
experience in the air, wind tunnel tests will need to be employed. These
tests are cheaper to perform than, for example, flight testing, and
allow for quicker iteration of design parameters. However, as will be
described in further detail in Chapter
[2](#chap:02_lit_review){reference-type="ref"
reference="chap:02_lit_review"}, wind-tunnel measurements of
aero-optical effects typically require passing a test beam into and
through the test-section, so that the test beam is susceptible to
acquiring additional optical contamination including but not limited to
the boundary layer present on the wall and the acoustic environment
generated by the wind tunnel fan [@Gordeyev-2014-jcJndkHM]. Note that it
is common in signal-processing terminology to use the word "noise" to
describe unwanted interference that appears in addition to the "signal"
that is the objective of the measurement; however, in this dissertation,
the word "contamination" is used to describe any optical noise sources
that are unrelated to the aero-optical signal, in order to avoid
confusion with use of the word "noise" to describe acoustic noise which,
as will be shown, is also a source of optical contamination.

Assuming that the optical disturbances from aero-optical effects are
statistically independent from the contaminating optical disturbances
from the testing environment, we can estimate the total optical
disturbance as
$$\opdrms_{TOTAL}^2 = \opdrms_{MODEL}^2+\opdrms_{ENVIRONMENT}^2 \textrm{.}
  \label{eqn:01_combined_opd}$$ As an example of the effect that optical
contamination may have on system design, Figure
[\[fig:01\_design\_iteration\]](#fig:01_design_iteration){reference-type="ref"
reference="fig:01_design_iteration"} illustrates a hypothetical
iterative design process, where the design objective is to obtain a
design that meets a required level of performance shown in red, in the
presence of a level of environmental optical contamination shown in
orange.

![Hypothetical iterative design process of an airborne directed-energy
system. The required performance level is shown by the red line and the
testing environment's contamination is shown by the orange
line.](../matlab/01_introduction/design_iteration.eps)

[\[fig:01\_design\_iteration\]]{#fig:01_design_iteration
label="fig:01_design_iteration"}

The design process was simulated by an initial aero-optical $\opdrms$
shown on the left of the plot, and the improvement in system performance
achieved with each design iteration was simulated as a nearly linear
reduction in $\opdrms$ combined with 15% random variation. If only the
measured data, that is, including the effect of environmental
contamination using Equation
[\[eqn:01\_combined\_opd\]](#eqn:01_combined_opd){reference-type="ref"
reference="eqn:01_combined_opd"}, is used to assess the system's
performance then three additional design iterations are needed to
achieve a usable design, which can add significantly to the development
time and costs. If the environmental contamination is greater than the
design requirement, the measured performance will never reach the
required performance criteria. However, if the environmental
contamination can be estimated, mitigated and/or removed, then the
measured performance is a more accurate evaluation of the true
aero-optical performance, and design convergence can be achieved more
quickly and with more accurate results.

This dissertation will examine the environmental contamination of
aero-optical measurements in wind tunnels, with a particular focus on
the contamination due to acoustic noise within the wind tunnel. A review
of the available literature and important concepts in given in Chapter
[2](#chap:02_lit_review){reference-type="ref"
reference="chap:02_lit_review"}. In Chapter
[3](#chap:03_optical_acoustics){reference-type="ref"
reference="chap:03_optical_acoustics"}, the optical disturbances caused
by acoustic waves from simple plane and spherical waves are presented,
leading to a process for estimating the acoustical environment within
the test section of a wind tunnel. The strength of an spherical acoustic
wave will be assessed with both microphone and optical measurements.
Multi-dimensional spectral techniques will be used to analyze optical
wavefronts in Chapter [4](#chap:04_dispersion){reference-type="ref"
reference="chap:04_dispersion"} and to filter optical wavefronts in
Chapter [6](#chap:06_single_filter){reference-type="ref"
reference="chap:06_single_filter"}. These filtering techniques will
contain some optical contamination particularly in regions where the
various signal components interfere with one another. In order to
further reduce the optical contamination, Chapter
[7](#chap:07_multiple_filter){reference-type="ref"
reference="chap:07_multiple_filter"} will utilize additional sensor
information from both microphones and accelerometers to remove some of
the overlapping contamination to obtain a better picture of the actual
optical performance of an airborne directed-energy system from ground
test measurements. This document along with the source code is archived
at <https://github.com/bcatronnd/Dissertation>.

Literature Review {#chap:02_lit_review}
=================

Strong narrow-band acoustic waves traveling upstream have been measured
in-flight with optical wavefronts from a turret as part of the AAOL
program [@DeLucca-2018-gBQdjTmT]. This was one of the first indications
that a temporally narrow-band acoustic signal related to a fan was a
noise source that could contribute significantly to the overall signal.
Additional measurements have shown both narrow-band and broad-band
acoustic signals measured in-flight through a flat window with both
boundary and shear layers present [@Gordeyev-2020-6HnfJMnC]. Broad-band
acoustic signals have been reported previously in optical wavefront
measurements during boundary layer measurements in wind-tunnels but the
effect was only important at low temporal frequencies
[@Gordeyev-2014-jcJndkHM; @Smith-2013-VXArwwux]. Optical measurements
have also been made looking specifically for the acoustic waves inside a
wind-tunnel, by looking for narrow-band optical disturbances associated
with the wind-tunnel fan, with various model support structures
[@Catron-2018-DdVp6VZf], or with acoustic duct modes, showing that the
optical disturbances due to the acoustic environment not only travel
upstream at $u-c$, but also downstream at $u+c$ and cross-stream at
$\pm c$ [@Catron-2020-x8njYmmu].

The literature review will consist of primarily two sections. The first
section will examine aero-optics while the second will look at acoustics
inside of ducts.

Aero-Optics
-----------

In optically active flows the index-of-refraction, $n$, varies locally
along with other fluid properties. Gladstone and Dale
[@Gladstone-1863-ND4wtDT9] found that the index-of-refraction is
primarily a function of density with a loose dependence on the
wavelength of light. Gladstone and Dale proposed a "specific refractive
energy" now known as the Gladstone-Dale constant, $K_{GD}$,
$$K_{GD} = \frac{n-1}{\rho}\textrm{.}
  \label{eqn:02_gladstone_dale_constant}$$ For air the refractive index
can be related to state quantities [@Valley-1965-F3k3cmv6]
$$n-1 = 77.6\times 10^{-6}\frac{p}{T}\left(1+\frac{7.53\times10^{-3}}{\lambda^2}\right)\textrm{,}
  \label{eqn:02_refractive_index_ptlambda}$$ where $p$ is in mbar, $T$
is in K, and $\lambda$ is in $\mu$m. By combining this relationship with
the ideal gas law, the Gladstone-Dale constant can be determined as a
function of light wavelength,
$$K_{GD} = 2.23\times10^{-4}\left(1+\frac{7.53\times10^{-3}}{\lambda_{\mu m}^2}\right) \: \left[\frac{m^3}{kg}\right]\textrm{.}
  \label{eqn:02_gladstone_dale_wavelength}$$ The Gladstone-Dale constant
for air over the visible range is shown in Figure
[\[fig:02\_gladstone\_dale\_wavelength\]](#fig:02_gladstone_dale_wavelength){reference-type="ref"
reference="fig:02_gladstone_dale_wavelength"}.

![Gladstone-Dale constant for air over the visible wavelength
range.](../matlab/02_background/gladstone_dale_wavelength.eps)

[\[fig:02\_gladstone\_dale\_wavelength\]]{#fig:02_gladstone_dale_wavelength
label="fig:02_gladstone_dale_wavelength"}

While the value for $K_{GD}$ does vary over the visible range, it is
only a few percent, and many sources use an average value of
2.27$\times10^{-4}$ m$^3$/kg for the visible and near-infrared
[@Gardiner-1980-reW8xrCb]. The Gladstone-Dale relationship is typically
presented as $$n = 1+K_{GD}\rho
  \label{eqn:02_gladstone_dale_relation}$$ but when applied to
situations where there are significant fluctuations in the flow an
alternate form is often more useful $$n'=K_{GD}\rho'
  \label{eqn:02_gladstone_dale_relation_fluctuating}$$ where $'$ denotes
the fluctuating component ($n' = n-\bar{n}$).

When a beam with an initially planar wave front passes through a region
of optically active flow its wavefront becomes aberrated. The optical
path length ($\opl$) at any point in the beam can be obtained by
integrating the index of refraction along the propagation of an optical
ray [@Klein-1986-8Vx29RfE].
$$\opl (x,y,t) = \int^{s_2}_{s_1} n(x,y,z,t)ds
  \label{eqn:02_opl}$$ The optical path difference ($\opd$), is then the
spatially-averaged $\textrm{OPL}$ over an aperture removed from the OPL.
$$\opd(x,y,t) = \opl(x,y,t)-\langle\opl(x,y,t)\rangle
  \label{eqn:02_opd}$$ When working with fluctuating components, the
$\opd$ can be calculated directly
$$\opd(x,y,t) = \int^{s_2}_{s_1} n'(x,y,z,t)ds \textrm{.}
  \label{eqn:02_opd_n}$$

As a finite beam of light travels normal to its wavefront it is
diffracted, producing a theoretical limit on the performance of an
optical system, i.e. diffraction-limited [@Born-1965-HHGYgjdH].
Sommerfeld defined diffraction as "any deviation of light rays from
rectilinear paths which cannot be interpreted as reflection or
refraction" [@Sommerfeld-1954-ep2AWrFF]. Diffraction through an aperture
can be approximated with the Huygens-Fresnel principle by assuming that
every point within the aperture produces a spherical wavelet
[@Huygens-1690-gD8nxCn8],
$$U(x_0,y_0) = \iint_{Ap} h(x_0,y_0;x_1,y_1)U(x_1,y_1)dx_1dy_1 \textrm{,}
  \label{eqn:02_huygens}$$ where $U$ is the complex amplitude, the
subscripts 0 and 1 represent the coordinates of the observation plane
and aperture plane respectively, and
$$h(x_0,y_0;x_1,y_1) = \frac{1}{j\lambda}\frac{\exp\{jkr_{01}\}}{r_{01}}\cos(\overrightarrow{n},\overrightarrow{r}_{01}) \textrm{,}
  \label{eqn:02_huygens_h}$$ where
$r_{01} = \sqrt{z^2+(x_0-x_1)^2+(x_0-y_1)^2}$, is the distance between
any point in the observation and aperture planes. Equation
[\[eqn:02\_huygens\]](#eqn:02_huygens){reference-type="ref"
reference="eqn:02_huygens"} can be expanded to infinite limits of
integration with the Kirchhoff boundary conditions where $U(x_1,y_1)$ is
equal to zero outside of the aperture. The obliquity factor,
$\cos(\overrightarrow{n},\overrightarrow{r}_{01})$, can be approximated
as being equal to one by assuming that the observation plane is at a
much greater distance than the size of the aperture and is a small
finite region. The accuracy of this assumption is with 5% if the angle
between $\overrightarrow{n}$ and $\overrightarrow{r}_{01}$ does not
exceed $18^\circ$[@Goodman-1968-zPUmuuzx]. With this assumption and for
similar accuracy, $r_{01}$ in the denominator of Equation
[\[eqn:02\_huygens\_h\]](#eqn:02_huygens_h){reference-type="ref"
reference="eqn:02_huygens_h"} can be replaced with $z$, resulting in
$$h(x_0,y_0;x_1,y_1) \approxeq \frac{1}{j\lambda z}\exp\{jkr_{01}\} \textrm{.}$$

The Fresnel approximation replaces the spherical wavelets with a
quadratic surface [@Fresnel-1818-FmMCMbDK],
$$h(x_0,y_0;x_1,y_1) = \frac{\exp\{jkz\}}{j\lambda z}\exp\left\{j\frac{k}{2z}[(x_0-x_1)^2+(y_0-y_1)^2]\right\} \textrm{,}
  \label{eqn:02_fresnel_approx}$$ which has a theoretical requirement
that $z^3 \gg \frac{\pi}{4\lambda}\max\{[(x_0-x_1)^2+(y_0-y_1)^2]^2\}$
due to the limited number of terms used in a binomial expansion of
$r_{01}$. In practice this limit is not that critical
[@Goodman-1968-zPUmuuzx]. By combining Equations
[\[eqn:02\_fraunhofer\]](#eqn:02_fraunhofer){reference-type="ref"
reference="eqn:02_fraunhofer"} and
[\[eqn:02\_fresnel\_approx\]](#eqn:02_fresnel_approx){reference-type="ref"
reference="eqn:02_fresnel_approx"}, an expression for Fresnel
diffraction can be obtained, $$\begin{aligned}
    U(x_0,y_0) =& \frac{\exp\{jkz\}}{j\lambda z}\exp\left\{j\frac{k}{2z}(x_0^2+y_0^2)\right\}\iint_{-\infty}^{+\infty}\left[U(x_1,y_1)\exp\left\{j\frac{k}{2z}(x_1^2+y_1^2)\right\}\right] \\
    &\exp\left\{-j\frac{2\pi}{\lambda z}(x_0x_1+y_0y_1)\right\} dx_1dy_1 \textrm{.}
  \end{aligned}
  \label{eqn:02_fresnel}$$ The function $U(x_0,y_0)$ may therefore be
found from a two-dimensional Fourier transform:
$$U(x_0,y_0) = \ft_2\left[U(x_1,y_1)\exp\left\{j\frac{k}{2z}(x_1^2+y_1^2)\right\}\right]
  \label{eqn:02_fresnel_fft}$$ where $\ft_2$ is the two-dimensional
Fourier transform and transform is evaluated at the spatial frequencies
$\xi_x = x_0/\lambda z$, $\xi_y = y_0/\lambda z$.

The Fraunhofer approximation [@Goodman-1968-zPUmuuzx],
$$z \gg \frac{k\max[x_1^2+y_1^2]}{2} \textrm{,}
  \label{eqn:02_fraunhofer_approx}$$ places further restrictions than
the Fresnel assumption approximation which results in
$\exp\left\{j\frac{k}{2z}(x_1^2+y_1^2)\right\}$ being approximately
unity over the aperture further simplifying Equation
[\[eqn:02\_fresnel\]](#eqn:02_fresnel){reference-type="ref"
reference="eqn:02_fresnel"} to $$\begin{aligned}
    U(x_0,y_0) =& \frac{\exp\{jkz\}}{j\lambda z}\exp\left\{j\frac{k}{2z}(x_0^2+y_0^2)\right\} \\
    &\iint_{-\infty}^{+\infty}U(x_1,y_1)\exp\left\{-j\frac{2\pi}{\lambda z}(x_0x_1+y_0y_1)\right\} dx_1dy_1 \textrm{.}
  \end{aligned}
  \label{eqn:02_fraunhofer}$$ Equation
[\[eqn:02\_fraunhofer\]](#eqn:02_fraunhofer){reference-type="ref"
reference="eqn:02_fraunhofer"} known as the Fraunhofer diffraction
integral. In Fraunhofer diffraction, the function $U(x_0,y_0)$ maybe
found from the Fourier transform of $U(x_1,y_1)$, when evaluated at the
spatial frequencies $\xi_x = x_0/\lambda z$, $\xi_y = y_0/\lambda z$.
For additional details on the derivation of Huygens, Fresnel, and
Fraunhofer diffraction, including more in depth discussion on the
assumptions and limits, see Goodman [@Goodman-1968-zPUmuuzx].

The optical path difference can be related to the complex amplitude by
[@Cicchiello-1997-RHxhNMxj],
$$U(x_1,y_1) = \exp\left\{j\frac{2\pi}{\lambda}\opd(x_1,y_1)\right\} \textrm{.}$$
Using the Fraunhofer diffraction integral, the nearfield $\opd$
disturbance can therefore be used to calculate the farfield intensity
profile ($I = UU^*$),
$$I(x_0,y_0) = \left|\ft_2\left(\exp\left\{j\frac{2\pi}{\lambda}\opd(x_1,y_1)\right\}\right)\right|^2 \textrm{,}$$
where the transform is evaluated at the spatial frequencies
$\xi_x = x_0/\lambda z$, $\xi_y = y_0/\lambda z$ in the observation
plane and the complex amplitude outside of the aperture is zero. For
cases in which optical aberrations are nonexistent (i.e.
$\opd(x,y,t)=0$), the farfield irradiance pattern that results from
Equation
[\[eqn:02\_fraunhofer\]](#eqn:02_fraunhofer){reference-type="ref"
reference="eqn:02_fraunhofer"} is caused entirely by diffraction from
the optical aperture, and is referred to as the "diffraction-limited"
irradiance pattern. For a beam with a flat wave front and circular
aperture, the farfield irradiance pattern is the Airy's disk, and the
peak irradiance at the center of the disk, $I_0$ , is the maximum
irradiance that can be achieved by the optical system:
$$I_0 = \left(\frac{kAp^2}{8z}\right)^2
  \label{eqn:02_airy_pattern}$$ where $k$ is the wavenumber
($k=2\pi /\lambda$), $Ap$ is the aperture diameter, and $z$ is the
distance from the aperture to the observation plane. In the presence of
aero-optical aberrations, $\opd(x,y,t)$ is non-zero, and the farfield
irradiance pattern in this case tends to be more spread out and diffuse
than the diffraction-limited case; furthermore, the beam may be shifted
off target by optical tip/tilt imposed by the aberrations.

The Strehl ratio ($\sr$), is the ratio of intensity on target ($I$) to
the diffraction-limited on target intensity ($I_0$): $$\sr=\frac{I}{I_0}
  \label{eqn:02_strehl_simple}$$ The Strehl ratio can be computed
accurately by applying Equation
[\[eqn:02\_fraunhofer\]](#eqn:02_fraunhofer){reference-type="ref"
reference="eqn:02_fraunhofer"} twice, once for the diffraction-limited
case to obtain $I_0$, and a second time with the $\opd$ field due to
aero-optical aberrations included to obtain $I$. The farfield
performance, can also be estimated via the Maréchal approximation:
$$\sr(t) \equiv \frac{I(t)}{I_0} \approx \exp \left\{-\left[\frac{2\pi \opdrms(t)}{\lambda}\right]^2\right\}
  \label{eqn:02_strehl_ratio}$$ where $\opdrms$ is the spatial rms of
the wave front and $\lambda$ is the wavelength of the beam.

![](../matlab/02_background/farfield_intensity.eps)

[\[fig:02\_farfield\_intensity\]]{#fig:02_farfield_intensity
label="fig:02_farfield_intensity"}

 

![](../matlab/02_background/all_strehl_ratio.eps)

[\[fig:02\_all\_strehl\_ratio\]]{#fig:02_all_strehl_ratio
label="fig:02_all_strehl_ratio"}

Equation
[\[eqn:02\_strehl\_ratio\]](#eqn:02_strehl_ratio){reference-type="ref"
reference="eqn:02_strehl_ratio"} reveals a key relationship between
$\opd$, wavelength, and the farfield performance, plotted in Figure
[\[fig:02\_all\_strehl\_ratio\]](#fig:02_all_strehl_ratio){reference-type="ref"
reference="fig:02_all_strehl_ratio"}, and shows that, for the same
aero-optical aberration, the Strehl ratio decreases substantially as
system wavelength decreases. On the other hand, Equation
[\[eqn:02\_airy\_pattern\]](#eqn:02_airy_pattern){reference-type="ref"
reference="eqn:02_airy_pattern"} shows that the diffraction-limited
farfield irradiance increases as the wavelength is shortened, plotted in
Figure
[\[fig:02\_farfield\_intensity\]](#fig:02_farfield_intensity){reference-type="ref"
reference="fig:02_farfield_intensity"}. Together, Figure
[\[fig:02\_farfield\_intensity\]](#fig:02_farfield_intensity){reference-type="ref"
reference="fig:02_farfield_intensity"} and
[\[fig:02\_all\_strehl\_ratio\]](#fig:02_all_strehl_ratio){reference-type="ref"
reference="fig:02_all_strehl_ratio"} show that as modern optical systems
move to shorter wavelengths to increase $I_0$, aero-optical aberrations
cause a much more serious degradation of the Strehl ratio, illustrating
why aero-optical considerations are critical in the development of new
airborne optical systems. Figure
[\[fig:02\_necessary\_opd\]](#fig:02_necessary_opd){reference-type="ref"
reference="fig:02_necessary_opd"} shows the $\opdrms$ necessary to
achieve various Strehl ratios over a range of wavelengths.

![$\opdrms$ values necessary to obtain Strehl ratios of 0.9, 0.7, and
0.5 over a range of
wavelengths.](../matlab/02_background/necessary_opd.eps)

[\[fig:02\_necessary\_opd\]]{#fig:02_necessary_opd
label="fig:02_necessary_opd"}

As the wavelength of light decreases the required $\opdrms$ decreases
linearly for a fixed Strehl ratio.

### Typical Optical Wavefront Measurement System

A diagram of a typical double-pass Shack-Hartmann wavefront front sensor
setup is shown in Figure
[\[fig:02\_typical\_wavefront\_system\]](#fig:02_typical_wavefront_system){reference-type="ref"
reference="fig:02_typical_wavefront_system"}.

![Typical double-pass optical wavefront measurement
setup.](../cad/wavefront_setup.pdf "fig:"){width="3.25in"} (-72,62)
(-145,78) (-135,65) (-150,200) (-130,405) (-112,432) (-95,160) (-80,155)
(-10,245) (5,260) (-59,441) (-90,480)

[\[fig:02\_typical\_wavefront\_system\]]{#fig:02_typical_wavefront_system
label="fig:02_typical_wavefront_system"}

The system starts with the laser in the bottom of the plot, which is
then expanded to a larger diameter. The beam expander used in this
research increased the diameter of the beam to approximately 1-inch. The
larger diameter beam then passes through a beam splitter where half of
the intensity is discarded and the other half proceeds to the primary
telescope. The primary telescope expands the beam to the desired size
for the first passage through the measurement region. For measurements
made in a wind-tunnel, the beam angle, $\gamma$, is typically defined
based on the flow direction [@Gordeyev-2014-jcJndkHM] with $0^\circ$
being looking straight into the flow and $180^\circ$ looking downstream.

A large mirror is used to return the beam along the same path for a
second passage through the measurement region where the primary
telescope shrinks the beam back down to a 1-inch diameter. On the return
path, the beam splitter sends half of the intensity back through the
beam expander to the laser and half to the reimaging telescope. The
reimaging telescope serves two purposes, the first is to create an image
plane for the wavefront sensor at the desired object plane location,
typically the return mirror for a double-pass setup. The second is to
reduce the beam diameter for the wavefront sensor to a size that depends
on the resolution and frame rate needed for a measurement.

The Shack-Hartmann wavefront sensor is comprised of a lenslet array and
a camera [@Geary-1995-TQXWWFW2]. A diagram of how the wavefront sensor
functions can be seen in Figure
[\[fig:02\_lenslet\_array\]](#fig:02_lenslet_array){reference-type="ref"
reference="fig:02_lenslet_array"}.

![Diagram of a Shack-Hartmann wavefront sensor comprised of four
lenslets. The black line represents the perturbed wavefront and the red
line the mean slope over each lenslet. The focal point of the wavefront
is shifted by $\Delta x$ from the center-line of the lenslet based on
the mean slope of the wavefront.
[@Shack-Hartman-Diagram-Wikipedia]](../other-sources/Shack_Hartmann_WFS_lensletarray.png){width="80%"}

[\[fig:02\_lenslet\_array\]]{#fig:02_lenslet_array
label="fig:02_lenslet_array"}

The perturbed wavefront is represented by the black lines on the top of
the figure. Each lenslet produces a focused spot on the image plane with
a location given by the average slope of the portion of the wavefront
that passes through the lenslet. By measuring the displacement,
[@Nightingale-2013-gqr4p7GY], of the focal dot from its normal position,
the average slope, $\theta_x$ and $\theta_y$, of the wavefront over a
lenslet can be measured,
$$\theta_x = \tan^{-1}{\frac{\Delta x}{f}} \approx\frac{\Delta x}{f} \textrm{,}$$
where $f$ is the focal length of the lenslet. With an array of gradient
data, the optical path difference at each lenslet can be calculated
using a number of integration methods [@Huang-2015-W29DqPyp], for
example, one well-known method is the Southwell method
[@Southwell-1980-KqUZMXRB].

### Boundary Layer Optical Distortions {#sect:02_BL_OPD}

Because optical wavefront measurements within a wind tunnel will usually
include the optical distortion from the boundary layer(s) on the
wind-tunnel wall(s), it is important to have some familiarity. The
time-averaged optical disturbance for a large aperture has been reported
as,
$$\opdrms = B(\gamma)K_{GD}\rho_\infty M^2\delta\sqrt{C_f}G(M) \textrm{,}
  \label{eqn:02_opdrms_gor}$$ where $C_f$ is the skin-friction
coefficient. The function $B(\gamma)$ accounts for angle between the
beam and the direction of flow, $\gamma$:
$$B(\gamma) = \frac{0.19}{\sin(\gamma)} \textrm{,}$$ and
$$G(M) = 1-0.19M^2+0.03M^4 \textrm{.}$$ Aperture size can be accounted
for by Figure
[\[fig:02\_gordeyev\_2014\]](#fig:02_gordeyev_2014){reference-type="ref"
reference="fig:02_gordeyev_2014"} (Figure 18 in Gordeyev
[@Gordeyev-2014-jcJndkHM]) with an approximation for the fit,
$$\frac{\opdrms(Ap)}{\opdrms} \approx 1-a\exp\left\{b\frac{Ap}{\delta}\right\}-(1-a)\exp\left\{c\frac{Ap}{\delta}\right\} \textrm{,}
  \label{eqn:02_opdrms_gor_fit}$$ where $a=0.7795$, $b=-0.9616$, and
$c=-0.1382$.

![Aperture size correction for $\opdrms$ (Figure 18 in Gordeyev
[@Gordeyev-2014-jcJndkHM]).](../other-sources/gordeyev_2014_figure_18.png){width="75%"}

[\[fig:02\_gordeyev\_2014\]]{#fig:02_gordeyev_2014
label="fig:02_gordeyev_2014"}

Duct Acoustics
--------------

This section will look at acoustics when confined to a duct in which the
acoustic waves primarily travel in the direction of one axis and have
walls confining the acoustics along the other two axes as is the case
inside of a wind tunnel. Figure
[\[fig:02\_duct\_drawing\]](#fig:02_duct_drawing){reference-type="ref"
reference="fig:02_duct_drawing"} shows the diagram used for deriving the
acoustic properties inside of a constant area duct.

![Duct with a rectangular
cross-section.](../autocad/02_background/duct_drawing.eps "fig:"){width="4.5in"}
(-155,62) (-227,113) (-103,119)$\mathbf{x}$ (-198,220)$\mathbf{y}$
(-26,4)$\mathbf{z}$

[\[fig:02\_duct\_drawing\]]{#fig:02_duct_drawing
label="fig:02_duct_drawing"}

The derivation presented here is primarily influenced by Munjal
[@Munjal-2014-w28y4EyP] along with Jacobsen and Juhl
[@Jacobsen-2013-PHD3v3YZ]. The assumption used in this derivation is
that the duct is of constant cross-section; methods used to solve for
the acoustic field in a wind tunnel with varying flow cross sections are
presented later in Section
[3.3](#sect:03_test_section){reference-type="ref"
reference="sect:03_test_section"}. This means that all mean quantities
($\rho_0$, $\mathbf{u_0}$, \...) are constant throughout space and time.
Starting with the linearized inviscid forms of the conservation of mass,
$$\frac{\mathbf{D}\rho}{\mathbf{Dt}} + \rho_0\nabla\cdot\mathbf{u} = 0 \textrm{,}
  % \frac{\partial\rho}{\partial t} + \mathbf{u}\cdot\nabla\rho + \rho_0(\nabla\cdot\mathbf{u}) = 0 \textrm{,}
  \label{eqn:02_cons_mass}$$ and conservation of momentum,
$$\rho_0\frac{\mathbf{Du}}{\mathbf{Dt}} + \nabla p = 0 \textrm{.}
  % \rho_0\frac{\partial\mathbf{u}}{\partial t} + \rho_0(\mathbf{u_0}\cdot\nabla)\mathbf{u} + \nabla p = 0 \textrm{.}
  \label{eqn:02_cons_mom}$$ The definition of the speed of sound
($\left.\frac{\partial p}{\partial\rho}\right|_s = c_0^2$) is then
substituted into Equation
[\[eqn:02\_cons\_mass\]](#eqn:02_cons_mass){reference-type="ref"
reference="eqn:02_cons_mass"},
$$\frac{1}{c_0^2}\frac{\mathbf{D}p}{\mathbf{Dt}} + \rho_0\nabla\cdot\mathbf{u} = 0 \textrm{,}
  % \frac{1}{c_0^2}\frac{\partial p}{\partial t} + \frac{1}{c_0^2}(\mathbf{u}\cdot\nabla p) + \rho_0(\nabla\cdot\mathbf{u}) = 0 \textrm{,}
  \label{eqn:02_cons_mass_p}$$ where $c_0$ is the speed of sound at
average fluid properties ($\rho_0$, $p_0$, $T_0$, \...). Next the
difference between the material derivative ($\mathbf{D}/\mathbf{Dt}$) of
Equation
[\[eqn:02\_cons\_mass\_p\]](#eqn:02_cons_mass_p){reference-type="ref"
reference="eqn:02_cons_mass_p"} and the partial derivative
($\partial/\partial\mathbf{x}$) of Equation
[\[eqn:02\_cons\_mom\]](#eqn:02_cons_mom){reference-type="ref"
reference="eqn:02_cons_mom"} with respect to space is taken which
results in the convected 3-D wave equation,
$$\left(\frac{\mathbf{D}^2}{\mathbf{Dt}^2}-c_0^2\nabla^2\right)p=0\textrm{.}
  \label{eqn:02_wave_conv_3_c}$$ Expanding the material derivative and
dividing by $c_0^2$,
$$\left(\frac{1}{c_0^2}\frac{\partial^2}{\partial t^2} + \frac{2\mathbf{M}}{c_0}\frac{\partial^2}{\partial t\partial\mathbf{x}} - (1-\mathbf{M}^2)\nabla^2\right)p = 0 \textrm{,}
  \label{eqn:02_wave_conv_expand}$$ where
$\mathbf{M} = \mathbf{u_0}/c_0$. By using the fact that
$c_0=\omega/k_0$, Equation
[\[eqn:02\_wave\_conv\_3\_c\]](#eqn:02_wave_conv_3_c){reference-type="ref"
reference="eqn:02_wave_conv_3_c"} can be written in a more convent form,
$$\left(\frac{1}{\omega^2}\frac{\partial^2}{\partial t^2} + \frac{2\mathbf{M}}{\omega k_0}\frac{\partial^2}{\partial t\partial\mathbf{x}} - \frac{1-\mathbf{M}^2}{k_0^2}\nabla^2\right)p = 0 \textrm{,}
  \label{eqn:02_wave_conv_3}$$ where $\omega$ is the angular frequency
and $k_0$ is the total wavenumber.

At this point the pressure field is written in complex form and assumed
to be separable in both time and space such that
$\hat{p}(\mathbf{x},t) = \hat{p}(x,y)\hat{p}(z)\hat{p}(t)$. The temporal
solution is assumed to take the form
$$\hat{p}(t) = \exp\left\{j\omega t\right\} \textrm{,}
  \label{eqn:02_pressure_solution_time}$$ which results in the spatial
component of the convecting wave equation
$$\left((1-\mathbf{M}^2)\nabla^2-2jk_0\mathbf{M}\nabla+k_0^2\right)\hat{p}(x,y)\hat{p}(z) = 0 \textrm{.}
  \label{eqn:02_wave_conv_space}$$ This can be further split into axial
and cross-sectional components by splitting $k_0$ into components,
$$k_0 = \sqrt{k_{xy}^2+k_z^2} \textrm{,}
  \label{eqn:02_k0}$$ and because the mean flow is only in the axial
direction ($\mathbf{M} = M\mathbf{\hat{k}}$). The cross-sectional
component is a typical Helmholtz equation
$$\left(\frac{\partial^2}{\partial x^2}+\frac{\partial^2}{\partial y^2}\right)\hat{p}_{xy}(x,y)+k_{xy}^2\hat{p}(x,y) = 0 \textrm{,}
  \label{eqn:02_wave_xy}$$ whose solution,
$$\hat{p}(x,y) = \Psi_m(x,y) \textrm{,}
  \label{eqn:02_pressure_solution_xy}$$ is one of an infinite number of
eigen-function solutions with discrete wavenumbers, $k_m$. The axial
component of the convecting wave equation,
$$(1-M^2)\frac{\partial^2\hat{p}(z)}{\partial z^2} - 2jk_0M\frac{\partial\hat{p}(z)}{\partial z} + k_z^2\hat{p}(z) = 0 \textrm{,}
  \label{eqn:02_wave_z}$$ retains the total wavenumber in the second
term which means its solution will depend on the cross-sectional
wavenumber value of the cross-sectional mode. The solution to the axial
convecting wave equation,
$$\hat{p}(z) = C^+_m\exp{\left\{-jk^+_{zm}z\right\}}+C^-_m\exp{\left\{+jk^-_{zm}z\right\}} \textrm{,}
  \label{eqn:02_pressure_solution_z}$$ has waves traveling in both
directions with the axial wavenumber in each direction for a given mode
$$k^\pm_{zm} = \frac{\mp Mk_0+\sqrt{k_0^2-(1-M^2)k_m^2}}{1-M^2} \textrm{.}
  \label{eqn:02_kzm}$$

The solution for a three-dimensional acoustic wave in a duct with a
constant but arbitrary cross-section in complex pressure is the
combination of the component solutions presented in Equations
[\[eqn:02\_pressure\_solution\_time\]](#eqn:02_pressure_solution_time){reference-type="ref"
reference="eqn:02_pressure_solution_time"},
[\[eqn:02\_pressure\_solution\_xy\]](#eqn:02_pressure_solution_xy){reference-type="ref"
reference="eqn:02_pressure_solution_xy"}, and
[\[eqn:02\_pressure\_solution\_z\]](#eqn:02_pressure_solution_z){reference-type="ref"
reference="eqn:02_pressure_solution_z"},
$$\hat{p}(x,y,z,t) = \Psi_m(x,y)\left(C^+_m\exp{\left\{-jk^+_{zm}z\right\}}+C^-_m\exp{\left\{+jk^-_{zm}z\right\}}\right)\exp\left\{j\omega t\right\} \textrm{.}
  \label{eqn:02_pressure_solution_duct}$$ The two solutions for a plane
wave ($\Psi_m=1$, $k_m=0$) traveling in a duct have a characteristic
speed of $u\pm c_0$. Acoustic modes will travel indefinitly if
$k_0^2-(1-M^2)k_m^2>0$ (the quantity inside of the square-root of
Equation [\[eqn:02\_kzm\]](#eqn:02_kzm){reference-type="ref"
reference="eqn:02_kzm"}). This presents a frequency at which a given
mode will cut-on,
$$f_{cuton} = \frac{c_0}{2\pi}\sqrt{(1-M^2)k_m^2} \textrm{.}
  \label{eqn:02_cuton_freq}$$ Below this frequency, an acoustic mode
will be exponentially attenuated as it travels through the duct.

### Characteristic Equations of Cross-Sections

In order to determine the characteristic equations of an acoustic field
within a cross-section the solution to Equation
[\[eqn:02\_wave\_xy\]](#eqn:02_wave_xy){reference-type="ref"
reference="eqn:02_wave_xy"} needs to be determined. In this research, it
will be assumed that the walls of the duct are perfectly rigid, giving
the following boundary condition for the 2-D Helmholtz equation:
$$\nabla p_{x,y}(x,y)\cdot\mathbf{n}_{wall} = 0
  \label{eqn:02_bc_rigig_wall}$$ This boundary condition results in the
acoustic waves being perfectly reflected off of the duct walls. There
are several known empirical solution sets of the characteristic
equations for specific geometries with the rigid wall assumption.

The first of these solutions is for a duct with rectangular
cross-section, $$\Psi_{m,n}(x,y) = \cos(k_xx)\cos(k_yy) \textrm{,}
  \label{eqn:02_psi_rect}$$ where the wave numbers along each axis are
$k_x = m\pi/l_x$ and $k_y = n\pi/l_y$. The duct has a width of $l_x$ and
a height of $l_y$. The total cross-sectional wave number for use in
determining the axial wave numbers is $$k_m^2 = k_x^2+k_y^2 \textrm{.}
  \label{eqn:02_wave_number_crosssection}$$ Figure
[\[fig:02\_cross\_section\_rect\]](#fig:02_cross_section_rect){reference-type="ref"
reference="fig:02_cross_section_rect"} shows the characteristic
functions when m=0:2 and n=0:3 for a rectangular cross-section of width
of $l_x$ and height of $l_y$.

![Characteristic solutions to Equation
[\[eqn:02\_wave\_xy\]](#eqn:02_wave_xy){reference-type="ref"
reference="eqn:02_wave_xy"} with rigid wall in a rectangular
cross-section where m=0:2 and n=0:3. Nodal lines are depicted by the
dot-dash lines. The cross-sectional wave numbers, $k_m$, listed are for
a duct of unit length and
height.](../matlab/02_background/cross_section_rect.eps)

[\[fig:02\_cross\_section\_rect\]]{#fig:02_cross_section_rect
label="fig:02_cross_section_rect"}

The lines depicted in the figure are nodal lines and represent locations
where there is zero pressure fluctuations for that acoustic mode.

The second set of known empirical solutions is for a circular
cross-section with radius $R$,
$$\Psi_{m,n}(r,\theta) = J_m(k_{mn}r)\exp\left\{\pm jm\theta\right\} \textrm{,}
  \label{eqn:02_psi_circ}$$ where $J_m$ is the $m^\textrm{th}$ Bessel
function of the first kind and the $\pm$ indicates the direction of
spin. If the left and right spin coefficients are equal in magnitude
then a non-spinning mode is created. In order to satisfy the solid wall
boundary condition $J_m'(k_{mn}R) = 0$ which determines a set of
discrete values for the cross-sectional wave number at the
$n^\textrm{th}$ zero for the $m^\textrm{th}$ Bessel function. Figure
[\[fig:02\_cross\_section\_circ\]](#fig:02_cross_section_circ){reference-type="ref"
reference="fig:02_cross_section_circ"} shows the characteristic
functions for a circular duct.

![Characteristic solutions to Equation
[\[eqn:02\_wave\_xy\]](#eqn:02_wave_xy){reference-type="ref"
reference="eqn:02_wave_xy"} with rigid wall in a circular cross-section
where m=0:2 and n=0:3. Nodal lines are depicted by the dot-dash lines.
The cross-sectional wave numbers, $k_m$, listed are for a duct of unit
radius.](../matlab/02_background/cross_section_circ.eps)

[\[fig:02\_cross\_section\_circ\]]{#fig:02_cross_section_circ
label="fig:02_cross_section_circ"}

Aero-Optical and Acoustical Coupling {#chap:03_optical_acoustics}
====================================

Acoustic waves are isentropic compression waves with the fluctuating
pressure, $p'$, determining the strength of the wave. This fluctuating
pressure is related to the sound pressure level, $\spl$ by
$$\spl = 20\log_{10}\left(\frac{p_{RMS}}{p_0}\right)
  \label{eqn:03_spl}$$ where $p_{RMS}$ is the root mean square of the
pressure fluctuation, and $p_0$ is the reference pressure (20 $\mu$Pa
for air). The pressure fluctuations can be related to the density
fluctuations via the definition of the speed of sound:
$$c_0^2 = \left(\frac{\partial p}{\partial \rho}\right)_s=\frac{p'}{\rho'}
  \label{eqn:03_speed_sound}$$ where $c_0$ is the speed of sound at mean
fluid properties and the subscript $s$ denotes constant entropy. It can
be shown by combining Equations
[\[eqn:02\_gladstone\_dale\_relation\_fluctuating\]](#eqn:02_gladstone_dale_relation_fluctuating){reference-type="ref"
reference="eqn:02_gladstone_dale_relation_fluctuating"} and
[\[eqn:02\_opd\]](#eqn:02_opd){reference-type="ref"
reference="eqn:02_opd"} that the fluctuating density can be related to
the $\opd$, $$\opd = K_{GD}\int_{s_1}^{s_2}{\rho'}ds \textrm{.}
  \label{eqn:03_opd_fluct}$$ This can be combined with Equation
[\[eqn:03\_speed\_sound\]](#eqn:03_speed_sound){reference-type="ref"
reference="eqn:03_speed_sound"},
$$\opd = \frac{K_{GD}}{c_0^2}\int_{s_1}^{s_2}{p'}ds \textrm{,}
  \label{eqn:03_opd_pressure}$$ to provide a way of computing the
optical path difference of a sound pressure field.

Simulating an Optical Wavefront Measurement from an Acoustic Field Function {#sect:03_simulated_beam}
---------------------------------------------------------------------------

The following analysis is presented for the case of a measurement field
subject to acoustic excitation at a discrete frequency. Parameter values
at each point in the field oscillate at the frequency of the acoustic
field, with a magnitude and phase relationship to the acoustic field
that can be represented by complex notation and that depends on the
physics of the interaction with the acoustic field.

The effect of a complex acoustic pressure field on an optical wavefront
can be simulated by applying Equation
[\[eqn:03\_opd\_pressure\]](#eqn:03_opd_pressure){reference-type="ref"
reference="eqn:03_opd_pressure"}. To accomplish this, two separate
coordinate systems will need to be defined. The first is the beam
coordinate system, $\mathbf{x}_B$, that will have a measurement
aperture, which is typically circular, defined in the xy-plane and
assuming the beam propagates in the z-direction. The second is the
acoustic coordinate system, $\mathbf{x}_A$, that will be defined based
on the source location or the geometry that the acoustic waves are
propagating through. A function representing the transformation from one
coordinate system to the other can be defined as
$$\mathbf{x}_A = R\mathbf{x}_B+T \textrm{,}
  \label{eqn:03_coord_transform}$$ where $R$ is a matrix which
represents the rotation and $T$ is a vector that represents the
translation.

The important parameters for defining the aperture on which the beam
coordinate system is based are the aperture size, $Ap$, and the spatial
discretization which, if the beam is measured using a Shack-Hartmann
wavefront sensor, is the number of lenslets or sub-apertures in the
wavefront sensor, $N_{lenslets}$. Assuming that the aperture is either
circular or square and the lenslet size and sub-aperture size is
approximately $Ap/N_{lenslets}$, the x locations of the center of the
sub-apertures go from $-Ap/2(1-1/N_{lenslets})$ to
$Ap/2(1-1/N_{lenslets})$ by steps of $Ap/N_{lenslets}$ with the y
locations having the same values. This gives a matrix representing both
$x_{Ap}$ and $y_{Ap}$ that is $N_{lenslets}$ by $N_{lenslets}$. For the
purpose of removing piston, tip, and tilt and creating a mask that
represents the beam aperture, the radial coordinates, $\rho_{Ap}$ and
$\theta_{Ap}$, of the aperture should also be calculated. A circular
beam will have a mask defined by, $$Mask_{Ap} =
  \begin{cases}
    1, & \text{if } \rho_{Ap}\leq Ap/2 \\
    0, & \text{otherwise.}
  \end{cases}$$ The beam coordinate frame is the aperture coordinates
extruded in the z-direction over the range of desired z-values.

After the beam coordinates are transformed into the acoustic coordinates
using Equation
[\[eqn:03\_coord\_transform\]](#eqn:03_coord_transform){reference-type="ref"
reference="eqn:03_coord_transform"}, the complex pressure field,
$\hat{p}(x,y,z,t)$ can be calculated at the points that are within the
optical beam. If the pressure field is separable into spatial and
temporal components, then the integration along the beam length only
needs to be done once for each temporal frequency,
$$\widehat{\opd}(x,y) = \frac{K_{GD}}{c_0^2}\int_{z_1}^{z_2} \hat{p}(x,y,z)_{Ap}dz \textrm{,}
  \label{eqn:03_opd_complex}$$ where $\widehat{\opd}(x,y)$ is the
complex optical path difference as measured in the aperture plane. If a
complex density field is known instead, than Equation
[\[eqn:03\_opd\_complex\]](#eqn:03_opd_complex){reference-type="ref"
reference="eqn:03_opd_complex"} becomes
$$\widehat{\opd}(x,y) = K_{GD}\int_{z_1}^{z_2} \hat{\rho}(x,y,z)_{Ap}dz \textrm{.}
  \label{eqn:03_opd_complex_density}$$ For the purposes of calculating
time-averaged optical properties of simulated beam passing through a
known complex pressure or density field a phase vector was defined,
$\phi = [0, 2\pi)$. The measurable component as a function of phase is
$$\opd(x,y,\phi) = \real\left[\widehat{\opd}(x,y)\exp\{-j\phi\}\right] \textrm{,}
  \label{eqn:03_opd_real_phase}$$ or as a function of time for all
temporal frequencies,
$$\opd(x,y,t) = \real\left[\sum\widehat{\opd}(x,y)\exp\{-j\omega t\}\right] \textrm{,}
  \label{eqn:03_opd_real}$$ where there is a separate
$\widehat{\opd}(x,y)$ computed for each temporal frequency. One of the
more important parameters that can be calculated from $\opd$ is the
spatial RMS, $\opdrms$, which is calculated at each time or phase step
at the points where the aperture mask equals one.

Simple Examples of Acoustic-Optical Coupling {#sect:03_examples}
--------------------------------------------

Two basic acoustic pressure fields will be numerically examined for
their optical properties. The first will be a planar acoustic wave that
will be numerically simulated over a variety of conditions. The second
will be a spherical acoustic wave that will be both numerically
simulated and validated experimentally.

### Planar Acoustic Waves {#sect:03_examples_planar}

A planar wave is the simplest solution to the wave equation and varies
only in time and the direction of travel. A planar wave can be
calculated from the set of solutions for duct acoustics, Equation
[\[eqn:02\_pressure\_solution\_duct\]](#eqn:02_pressure_solution_duct){reference-type="ref"
reference="eqn:02_pressure_solution_duct"}, given that $\Psi_m(x,y)=1$,
$$\hat{p}(z,t) = C_m\exp\left\{j(\omega t \mp k_{zm}^\pm z)\right\} \textrm{.}
  \label{eqn:03_plane_wave}$$ This section will show the effect that
acoustic waves have on the optical wavefront of a planar wave with the
general geometry shown in Figure
[\[fig:03\_planar\_sample\_domain\]](#fig:03_planar_sample_domain){reference-type="ref"
reference="fig:03_planar_sample_domain"}.

![General geometry for various sample calculations for showing the
acoustic-optical coupling
effect.](../matlab/03_aero_optics_acoustics/planar_sample_domain.eps)

[\[fig:03\_planar\_sample\_domain\]]{#fig:03_planar_sample_domain
label="fig:03_planar_sample_domain"}

For the following example, $l_n$ is the width of the acoustic
disturbance (for example, the width of the wind tunnel), $\theta$ is the
angle between the planar acoustic wave and the beam direction, $A_p$ is
the aperture diameter of the beam, and $\Lambda$ is the wavelength of
the acoustic wave.

Figure
[\[fig:03\_planar\_sample\_calc\_3\]](#fig:03_planar_sample_calc_3){reference-type="ref"
reference="fig:03_planar_sample_calc_3"} shows the time averaged
$\opdrms$ per meter of beam propagation when the beam path is parallel
($\theta=0$) to the peaks and troughs of the planar acoustic wave as
$\spl$ is varied.

![Theoretical time-averaged $\opdrms$ per meter of beam propagation as a
function of sound pressure level, $\spl$, for several $\Lambda/Ap$
ratios and
$\theta=0$.](../matlab/03_aero_optics_acoustics/planar_sample_calc_3.eps)

[\[fig:03\_planar\_sample\_calc\_3\]]{#fig:03_planar_sample_calc_3
label="fig:03_planar_sample_calc_3"}

As the sound pressure level increases the time averaged $\opdrms$ also
increases and can easily reach the point of being a significant factor
in the measured optical disturbance. There is little difference between
0.1 and 1 $\Lambda/Ap$, but as the wavelength gets much larger compared
to the beam diameter, then the optical effect of the noise is greatly
reduced, this effect is known as "aperture filtering." Aperture
filtering accounts for the fact that an aperture that is smaller than
the wavelength of the optical disturbance only passes a portion of that
optical disturbance, so that the measured $\opdrms$ is reduced
[@Siegenthaler-2005-KQ2HGmfp].

The effect of aperture filtering is more clearly shown in Figure
[\[fig:03\_planar\_sample\_calc\_1\]](#fig:03_planar_sample_calc_1){reference-type="ref"
reference="fig:03_planar_sample_calc_1"}.

![Theoretical time-averaged $\opdrms$ for a RMS sound pressure of 1 Pa
($\spl$ of 94 dB), $l_n$ of 1 m, and various angles and $\Lambda/Ap$
ratios.](../matlab/03_aero_optics_acoustics/planar_sample_calc_1.eps)

[\[fig:03\_planar\_sample\_calc\_1\]]{#fig:03_planar_sample_calc_1
label="fig:03_planar_sample_calc_1"}

As the $\Lambda/Ap$ ratio increases from 0.1, time-averaged $\opdrms$
remains fairly constant until it starts to drop around $\Lambda/Ap$ of
0.7 and starts to asymptotically approach zero which it basically
reaches by $\Lambda/Ap$ of 10. Figure
[\[fig:03\_planar\_sample\_calc\_1\]](#fig:03_planar_sample_calc_1){reference-type="ref"
reference="fig:03_planar_sample_calc_1"} also shows the effect of
changing the beam angle, $\theta$, through the acoustic field. For
nonzero $\theta$, the beam encounters alternating high and low index of
refraction as it passes through the test region, so that the
time-averaged $\opdrms$ begins to decrease compared to the
$\theta = 0^\circ$ case below $\Lambda/Ap=1$. There are also points of
zero optical disturbance that occur at
$\theta_{zero}=\tan^{-1}(n\Lambda/l_n)$ for $n\neq0$; these points occur
because the peaks and valleys of the optical disturbance caused by the
sound wave effectively cancel out over the length of the integration
path, $l_n/\cos\theta$.

Figures
[\[fig:03\_planar\_sample\_calc\_3\]](#fig:03_planar_sample_calc_3){reference-type="ref"
reference="fig:03_planar_sample_calc_3"} and
[\[fig:03\_planar\_sample\_calc\_1\]](#fig:03_planar_sample_calc_1){reference-type="ref"
reference="fig:03_planar_sample_calc_1"} show the optical effect of
plane acoustic waves in a no-flow environment. The effect of wind-tunnel
flow is to stretch (downstream-traveling waves) or compress
(upstream-traveling waves) the wavelength of the acoustic noise thereby
altering the filtering effect of the beam aperture. Figure
[\[fig:03\_planar\_sample\_calc\_2\]](#fig:03_planar_sample_calc_2){reference-type="ref"
reference="fig:03_planar_sample_calc_2"} shows a typical optical
disturbance from the two transverse acoustic waves (u+c and u-c) present
in a wind tunnel at Mach 0.6.

![Theoretical time-averaged $\opdrms$ for the two acoustic waves (u+c
and u-c) for the blade pass frequency (534 Hz) at Mach 0.6 with a RMS
sound pressure of 1 Pa ($\spl$ of 94 dB), $l_n$ of 1 m, and $Ap$ of 15
cm.](../matlab/03_aero_optics_acoustics/planar_sample_calc_2.eps)

[\[fig:03\_planar\_sample\_calc\_2\]]{#fig:03_planar_sample_calc_2
label="fig:03_planar_sample_calc_2"}

Both waves have an RMS sound pressure of 1 Pa and the beam has an
aperture of 15 cm and propagates through an acoustic field inside a duct
of width, $l_n$, of 1 m. Over the vast majority of the look back angles
the upstream-traveling acoustic wave has a much greater effect on the
optical disturbance compared to the downstream-traveling acoustic wave,
due to the much shorter wavelength of the upstream-traveling waves which
is less affected by aperture filtering. However, the upstream-traveling
wave goes through several zero points so that the downstream-traveling
wave dominates at some beam angles.

### Spherical Acoustic Waves {#sect:03_examples_spherical}

The acoustic field from a speaker may be assumed to be a spherical wave
from a pulsating point if the frequency is sufficiently low and the
measurement region is far enough away from the source
[@Randall-1951-9NtPPXPq]. This pressure field when converted to complex
pressure is represented by
$$\hat{p}(r,t) = \frac{A_0}{r}\exp\left\{-j(kr-\omega t)\right\} \textrm{,}
  \label{eqn:03_spherical_pressure}$$ where $A_0$ is the fluctuating
pressure strength and $r$ is the distance from the source to the
measurement point. The RMS pressure of this field can be represented by
$$p_{RMS} = \frac{|A_0|}{r\sqrt{2}} \textrm{.}
  \label{eqn:03_spherical_pressure_rms}$$

#### Theoretical $\opd$ Calculations

A set of optical properties were calculated for a beam passing through a
spherical acoustic field as defined by a point source using the process
described previously in Section
[3.1](#sect:03_simulated_beam){reference-type="ref"
reference="sect:03_simulated_beam"} and shown in Figure
[\[fig:03\_spherical\_simulation\]](#fig:03_spherical_simulation){reference-type="ref"
reference="fig:03_spherical_simulation"}.

![Diagram of the geometry used in the spherical wave
simulation.](../cad/spherical_simulation.pdf "fig:"){width="80%"}
(-140,130) (-140,155) (-95,43) (-240,115)Acoustic Source (-70,100)

[\[fig:03\_spherical\_simulation\]]{#fig:03_spherical_simulation
label="fig:03_spherical_simulation"}

These calculations used a circular aperture size of 0.25 m in diameter
that was assumed to be measured using a Shack-Hartmann WFS with 32x32
sub-apertures with a non-dimensional acoustic wavelength, $\Lambda$, of
$Ap/4$ to $10Ap$. The normal vector from the point source to the axis of
the measurement beam defined the coordinate system. This normal
distance, $R$, was a minimum $5Ap$ and a maximum of $25Ap$, keeping the
measurement beam away from the singularity at the origin of the acoustic
source. The $\opd$ for the beam was integrated over a distance of
$\pm5$-m from the plane of the point source. To calculate the
time-averaged $\opdrms$ the phase of the source was varied from 0 to
$2\pi$ with 25 total steps.

The result of these $\opdrms$ calculations is shown in Figure
[\[fig:03\_spherical\_sample\]](#fig:03_spherical_sample){reference-type="ref"
reference="fig:03_spherical_sample"}.

![Theoretical time-averaged $\opdrms$ for a spherical acoustic wave. The
top plot shows a perfect spherical acoustic signal integrated over
$\pm$5 m. The bottom plot shows has a Tukey window applied along the
beam length to partially emulate source directivity which significantly
reduces the measured
oscillations.](../matlab/03_aero_optics_acoustics/spherical_sample.eps "fig:")
![Theoretical time-averaged $\opdrms$ for a spherical acoustic wave. The
top plot shows a perfect spherical acoustic signal integrated over
$\pm$5 m. The bottom plot shows has a Tukey window applied along the
beam length to partially emulate source directivity which significantly
reduces the measured
oscillations.](../matlab/03_aero_optics_acoustics/spherical_sample_win.eps "fig:")

[\[fig:03\_spherical\_sample\]]{#fig:03_spherical_sample
label="fig:03_spherical_sample"}

The top plots shows the expected optical disturbance ratio,
$\opdrms/|A_0|$, for a perfectly spherical acoustic field measured over
the beam length. The oscillations in the solutions for different $R/Ap$
are caused by end effects in the integration. Because speakers often
have a directivity in their emission, the oscillations can be greatly
reduced by using a windowing function in the z-direction, such as a
Hanning or Tukey window, the roughly model this directivity as shown in
the bottom plot. While this plot was calculated with a single aperture
diameter, the general trend holds for all other aperture diameters that
were tested, the only effect was the size and width of the oscillations.

The peak of the optical disturbance ratio, $\opdrms/|A_0|$, is located
at $\Lambda/Ap\approx0.75$ for a circular aperture. The signal is
reduced above this value due to aperture filtering and below this value
because the shorter wavelengths have a reduced distance before
alternating high and low index-of-refraction regions reduce the optical
path difference. When the acoustic source point is sufficiently far
enough away from the measurement beam, $R/Ap\geq2$, the optical
disturbance ratio, $\opdrms/|A_0|$ when multiplied by $\sqrt{R/Ap}$, can
be collapsed onto a single curve for a range of $\Lambda/Ap$ of 0.1 to
10. Above $\Lambda/Ap=10$ the curves start to diverge away from one
another. An approximate function fit to these data is
$$\frac{\opdrms\sqrt{R/Ap}}{|A_0|} \approx \frac{p_1(\Lambda/Ap)^3+p_2(\Lambda/Ap)^2+p_3(\Lambda/Ap)+p_4}{(\Lambda/Ap)^3+q_1(\Lambda/Ap)^2+q_2(\Lambda/Ap)+q_3}
  \label{eqn:03_spherical_sample_fit}$$ with coefficient values shown
Table
[\[tab:03\_spherical\_sample\_coeff\]](#tab:03_spherical_sample_coeff){reference-type="ref"
reference="tab:03_spherical_sample_coeff"}. This functional fit has a
coefficient of determination, $R^2$, value of 0.9991.

   Coefficent         Value
  ------------ ------------
     $p_1$       -1.845e-05
     $p_2$        4.769e-04
     $p_3$        4.520e-03
     $p_4$        1.435e-03
     $q_1$        5.399e+00
     $q_2$       -5.145e+00
     $q_3$        4.869e+00

  : Curve fit values for Figure
  [\[fig:03\_spherical\_sample\]](#fig:03_spherical_sample){reference-type="ref"
  reference="fig:03_spherical_sample"} and Equation
  [\[eqn:03\_spherical\_sample\_fit\]](#eqn:03_spherical_sample_fit){reference-type="ref"
  reference="eqn:03_spherical_sample_fit"}

[\[tab:03\_spherical\_sample\_coeff\]]{#tab:03_spherical_sample_coeff
label="tab:03_spherical_sample_coeff"}

#### Measurement of a Spherical Acoustic Wave with an Optical Beam

A small bench top experiment was used to compare the simultaneous
optical and microphone measurements of an acoustic field from a speaker
as shown in Figure
[\[fig:03\_speaker\_test\]](#fig:03_speaker_test){reference-type="ref"
reference="fig:03_speaker_test"}.

![Spherical acoustic wave measurement
test.](../cad/speak_test.pdf "fig:"){width="3.5in"} (-146,25)Speaker
(-141,230)Beam (-160,310)

[\[fig:03\_speaker\_test\]]{#fig:03_speaker_test
label="fig:03_speaker_test"}

The distance from the center of the beam to the speaker was 102 mm with
a beam diameter of 28 mm. An ACO model 7016B microphone
[@ACO-Microphones] was placed directly over the speaker at a distance of
158 mm and was used with a Brüel & Kjær model 2670 preamplifier
[@Bruel-Kjaer-2670]. The speaker used was a Peerless model XT25SC90-04
[@Peerless-XT25SC90-04-1] which has a fairly flat on-axis response from
1 kHz to 40 kHz.

The wavefront measurements system utilized in these measurements is
similar to that shown in Figure
[\[fig:02\_typical\_wavefront\_system\]](#fig:02_typical_wavefront_system){reference-type="ref"
reference="fig:02_typical_wavefront_system"} except there was no primary
telescope. The speaker was located in the center of the measurement
region which was about 2 feet in length and the re-imaging telescope
reduced the beam diameter by a factor of two and re-imaged the return
mirror. Optical wavefronts and microphone measurements were taken at 49
kHz. The speaker was sinusoidally excited at three different frequencies
(9, 14, and 18 kHz) at a variety of voltages.

The absolute value of the fluctuating pressure strength, $|A_0|$, was
calculated two different ways. First, the power spectrum of the
microphone data was used to calculate the average $p_{RMS}$ at the
excitation frequency and the fluctuating pressure strength using
Equation
[\[eqn:03\_spherical\_pressure\_rms\]](#eqn:03_spherical_pressure_rms){reference-type="ref"
reference="eqn:03_spherical_pressure_rms"}. For the second method, the
optical wavefront was band-pass filtered at the excitation frequency
using a process that will be discussed in Chapter
[6](#chap:06_single_filter){reference-type="ref"
reference="chap:06_single_filter"}. The time averaged $\opdrms$ of the
filtered wavefront data was then used to calculate the fluctuating
pressure strength using Equation
[\[eqn:03\_spherical\_sample\_fit\]](#eqn:03_spherical_sample_fit){reference-type="ref"
reference="eqn:03_spherical_sample_fit"}.

The results of these measurements of the fluctuating pressure strength
is shown in Table
[\[tab:03\_spherical\_measurement\]](#tab:03_spherical_measurement){reference-type="ref"
reference="tab:03_spherical_measurement"}. The differences between the
two techniques for measuring the fluctuating pressure strength fell into
two groups. For the 9 kHz cases, the differences ranged from 20-26%
while for the higher frequency cases the differences were between
1.1-1.5%. In all cases the wavefront measurement reported a higher
fluctuating pressure strength. With the exception of the highest
excitation case at 9 kHz, the differences between the to techniques was
fairly constant for each frequency group. Some of these differences
maybe attributable to the frequency response of the microphone.

  --------------- --------------- ----------- ------------- --------------- -------------- -------
   $f_{speaker}$   $V_{speaker}$   $p_{RMS}$   OPD$_{RMS}$   $|A_0|_{mic}$   $|A_0|_{wf}$   Diff
       (Hz)            (mV)          (Pa)       ($\mu m$)     ($kg/s^2$)      ($kg/s^2$)     (%)
       9000             100          5.65       6.545e-04        1.26            1.55       20.38
       9000             250          12.23      1.421e-03        2.73            3.36       20.56
       9000             500          19.52      2.386e-03        4.36            5.64       25.62
       14000           1250          5.20       6.831e-04        1.16            1.18       1.24
       14000            250          9.33       1.230e-03        2.09            2.12       1.50
       14000            375          9.68       1.272e-03        2.16            2.19       1.16
       18000            125          3.73       4.987e-04        0.83            0.84       1.10
  --------------- --------------- ----------- ------------- --------------- -------------- -------

  : Comparison of microphone and wavefront computation of $|A_0|$

[\[tab:03\_spherical\_measurement\]]{#tab:03_spherical_measurement
label="tab:03_spherical_measurement"}

In Figure
[\[fig:03\_spherical\_plot\]](#fig:03_spherical_plot){reference-type="ref"
reference="fig:03_spherical_plot"}, measured wavefronts are compared to
the wavefronts simulated using the method described in Section
[3.1](#sect:03_simulated_beam){reference-type="ref"
reference="sect:03_simulated_beam"} for the highest excitation cases at
each frequency.

![Comparison of measured wavefront to simulated ones for the
highest-amplitude speaker excitation at each
frequency.](../matlab/03_aero_optics_acoustics/spherical_plot_measured.eps "fig:")
![Comparison of measured wavefront to simulated ones for the
highest-amplitude speaker excitation at each
frequency.](../matlab/03_aero_optics_acoustics/spherical_plot_simulated.eps "fig:")

[\[fig:03\_spherical\_plot\]]{#fig:03_spherical_plot
label="fig:03_spherical_plot"}

The 9 kHz case shows some anomalies on the measured wavefront on the
right side, and deviates from a spherical wave significantly, likely
contributing to the significantly higher estimated pulsating field
strength value when compared to the microphone estimate in Table
[\[tab:03\_spherical\_measurement\]](#tab:03_spherical_measurement){reference-type="ref"
reference="tab:03_spherical_measurement"}. The 14 and 18 kHz cases show
some remarkable agreement between the measured and simulated images.
Optical wavefront measurements can therefore be used for making
non-intrusive acoustic field measurements especially when the acoustic
field is simple.

Estimating the Acoustic Field Inside a Wind-Tunnel Test-Section {#sect:03_test_section}
---------------------------------------------------------------

Several mode-matching methods have been previously employed to solve the
acoustic field in ducts, ranging from methods designed to solve
axially-segmented turbofan duct liners [@McAlpine-2006-NrCzhW4Z] to
muffler modeling [@Ji-2013-agaCHhcP]. These methods require the entire
field to be solved simultaneously because there are duct modes traveling
in both directions at each axial-spatial location. Using the turbofan
duct liner version, a single azimuthal order, $m$, and only a few radial
orders, $n$, need to be computed for the various boundary conditions
with a constant mesh used through all the segments. In the muffler model
version, step changes in the cross-section are employed, allowing for a
constant mesh to be generated to account for all possible
cross-sections.

For a wind-tunnel that has numerous cross-sectional area changes,
specifically, a square cross-section for the test-section and a circular
cross-section for the fan, the mode-matching method can become
computational expensive. At each axial-location, all possible duct modes
need to be calculated up to at the very least the cutoff mode $k_m$, if
not higher [@Gabard-2008-H4mEEeVt], to fully resolve local duct modes.
As such, in order to reduce the computational cost of simulating the
acoustic environment inside of a wind tunnel, a mode marching method was
employed instead of a mode-matching method, where an initial
cross-sectional pressure field was marched from the wind-tunnel fan in
both directions around the wind-tunnel and through the test-section.
Although the mode-marching method is computationally simpler than the
mode-matching method, there are also arguments for using the
mode-marching method that are justified by the expected acoustic
behavior in typical wind-tunnel circuits. Specifically, since the
wind-tunnel test section normally has the smallest cross-sectional
dimensions, higher-order acoustic modes tend to be reflected away from
the test section; hence using a mode-marching method that does not
rigorously account for reflections or all high-order modes should not
add significant inaccuracy to the predicted results.

For the circular to square transition on either side of the wind-tunnel
fan, a deformable mesh was used such that there would be a one-to-one
mapping of mesh points throughout the transition. An example of the
deformable mesh is shown in Figure
[\[fig:deformable\_mesh\]](#fig:deformable_mesh){reference-type="ref"
reference="fig:deformable_mesh"} at both the square and circular limits
and halfway in between.

![Deformable mesh for calculating the acoustic modes in the circular to
square transitions at three
stages.](../matlab/03_aero_optics_acoustics/deformable_mesh.eps)

[\[fig:deformable\_mesh\]]{#fig:deformable_mesh
label="fig:deformable_mesh"}

Because cross-sectional wavenumber scales with the area
($k_m^2A=\textrm{const}$), all modes were solved for a cross-section of
unit area. For the simulation of the Notre Dame White Field wind tunnel
(described below) modes in the square cross-sections of the wind tunnel
were calculated with both the deformable mesh and a rectangular mesh in
order to allow for easy transitions in the cruciform region of this
wind-tunnel's diffuser.

### Mode-Marching Method Procedure {#sect:03_test_section_mode_marching}

1.  *Starting Acoustic Pressure Disturbance*\
    The method starts with an initial acoustic pressure disturbance that
    could be either measured, computed, or assumed. $$\hat{p}^0(x,y)$$
    For wind tunnels, the acoustic disturbance is generated by the main
    fan; hence $\hat{p}^0$ is the rotating radial fan modes associated
    with the rotating fan blades [@Cumpsty-1989-8wEYqb7t].

2.  *Modal Best Fit*\
    The pressure disturbance at the current axial location is best fit
    to the possible modes. $$\hat{p}^i(x,y)=\Psi_m^i(x,y)\cdot C_m^i$$
    where $\Psi_m^i$ are the possible modes for the local duct shape.

3.  *Transmitted Pressure Ratio*\
    The pressure attenuation due to Mach number change
    [@Powell-1959-W7KVArvn] as a ratio of transmitted pressure to
    incident pressure is computed for an acoustic wave traveling with
    subsonic flow,
    $$\frac{p_t}{p_i} = \left(\frac{1+M_n}{1+M_{n+1}}\right)\left(\frac{2M_{n+1}}{M_n+M_{n+1}}\right)\left(\frac{X_{n,n}}{X_{n,n+1}}\right)\left(\frac{X_{n,n}}{X_{n+1,n+1}}\right)^{1/(\gamma-1)} \textrm{,}
        \label{eqn:03_pressure_ratio_with}$$ or traveling against
    subsonic flow,
    $$\frac{p_t}{p_i} = \left(\frac{1-M_n}{1-M_{n+1}}\right)\left(\frac{2M_{n+1}}{M_n+M_{n+1}}\right)\left(\frac{X_{n,n}}{X_{n,n+1}}\right)\left(\frac{X_{n,n}}{X_{n+1,n+1}}\right)^{1/(\gamma-1)} \textrm{,}
        \label{eqn:03_pressure_ratio_against}$$ where
    $$X_{a,b} = 1+\frac{\gamma-1}{2}M_aM_b \textrm{.}$$

4.  *Reflected Pressure Ratio*\
    The reflected pressure ratio is a useful quantity to keeping track
    of, because one of the main assumptions of the mode marching method
    is that the reflections are negligible. The pressure attenuation due
    to Mach number change [@Powell-1959-W7KVArvn] as a ratio of
    reflected pressure to incident pressure is computed for an acoustic
    wave traveling with subsonic flow,
    $$\frac{p_r}{p_i} = \left(\frac{1+M_n}{1-M_n}\right)\left(\frac{M_{n+1}-M_n}{M_{n+1}+M_n}\right)\frac{Y_{n,n+1}}{X_{m,n+1}} \textrm{,}
        \label{eqn:03_pressure_ratio_with_reflected}$$ or traveling
    against subsonic flow,
    $$\frac{p_r}{p_i} = \left(\frac{1-M_n}{1+M_n}\right)\left(\frac{M_{n+1}-M_n}{M_{n+1}+M_n}\right)\frac{Y_{n,n+1}}{X_{m,n+1}} \textrm{,}
        \label{eqn:03_pressure_ratio_against_reflected}$$ where
    $$Y_{a,b} = 1-\frac{\gamma-1}{2}M_aM_b \textrm{.}$$

5.  *March Modes Forward*\
    March the acoustic modes forward to the next axial location.
    $$\hat{p}_{i+1}(x,y) = \frac{p_t}{p_i}\sum\Psi_M^i(x,y)\cdot C_m^i\cdot\exp\{\mp j k_{zm}^\pm z\}$$

6.  *Repeat*\
    Repeat steps 2-5 until the desired location is reached (i.e. the
    wind-tunnel test section). Different starting pressure disturbances
    can also be checked.

### University of Notre Dame White Field Wind-Tunnel Simulation {#sect:03_test_section_sim}

The University of Notre Dame White Field wind-tunnel is capable of
reaching speeds of Mach 0.6 in the 3 foot by 3 foot test-section. A CAD
model of the wind-tunnel is shown in Figure
[\[fig:03\_tunnel\_model\]](#fig:03_tunnel_model){reference-type="ref"
reference="fig:03_tunnel_model"}.

![CAD model of the University of Notre Dame Whitefield wind-tunnel. The
specifications of the tunnel at the numbered cross-sections are shown in
Table
[\[tab:03\_wind\_tunnel\_specs\]](#tab:03_wind_tunnel_specs){reference-type="ref"
reference="tab:03_wind_tunnel_specs"}.](../photos/whitefield_tunnel.png "fig:"){width="\textwidth"}
(-360,140) (-415,135) (-440,45) (-395,15) (-320,0) (-250,20) (-180,38)
(-132,48) (-80,32) (-60,40) (-25,135) (-50,165) (-180,190) (-315,155)

[\[fig:03\_tunnel\_model\]]{#fig:03_tunnel_model
label="fig:03_tunnel_model"}

The cross-sectional area and distance from the wind-tunnel fan going
upstream are presented in Table
[\[tab:03\_wind\_tunnel\_specs\]](#tab:03_wind_tunnel_specs){reference-type="ref"
reference="tab:03_wind_tunnel_specs"} along with some comments on the
segments between some of the cross-sections.

   Section   Area (m$^2$)   Z (m)  Comment
  --------- -------------- ------- ---------
      1          5.07       0.00   
      2          4.68       2.42   
      3          4.68       4.56   
      4          3.57       8.65   
      5          3.57       10.71  
      6          1.97       14.33  
      7          0.84       17.99  
      8          0.84       20.73  
      9          5.44       23.07  
     10          5.44       24.30  
     11          5.44       26.54  
     12          8.04       29.65  
     13          8.04       31.88  
     14          4.67       39.25  

  : Wind-tunnel cross-section specifications

[\[tab:03\_wind\_tunnel\_specs\]]{#tab:03_wind_tunnel_specs
label="tab:03_wind_tunnel_specs"}

For the distances in Table
[\[tab:03\_wind\_tunnel\_specs\]](#tab:03_wind_tunnel_specs){reference-type="ref"
reference="tab:03_wind_tunnel_specs"} the corners have been straightened
out and set to a length equal to the center-line arc from the entrance
to the exit of that segment. The transition segments on either side of
the wind-tunnel fan convert the circular cross-section to a square
cross-section. Between cross-section 6 and 7 the diffuser has a
cruciform splitting it into four separate segments in which the duct
modes were independently marched. The test-section is 2.75 m long and
the main contraction shape from section 8 to 9 follows a fifth-order
polynomial. Acoustic reflections that would be due to turning vanes or
other internal structures have been neglected along with the fan hub and
motor shaft geometry.

The wind-tunnel was discretized into smaller segments that were a
maximum of 0.25 m in length. The speed throughout the wind-tunnel was
determined via isentropic relations and the pressure transmission ratios
were computed using Equations
[\[eqn:03\_pressure\_ratio\_with\]](#eqn:03_pressure_ratio_with){reference-type="ref"
reference="eqn:03_pressure_ratio_with"} and
[\[eqn:03\_pressure\_ratio\_against\]](#eqn:03_pressure_ratio_against){reference-type="ref"
reference="eqn:03_pressure_ratio_against"}. Pressure reflection ratios
were calculated using Equations
[\[eqn:03\_pressure\_ratio\_with\_reflected\]](#eqn:03_pressure_ratio_with_reflected){reference-type="ref"
reference="eqn:03_pressure_ratio_with_reflected"} and
[\[eqn:03\_pressure\_ratio\_against\_reflected\]](#eqn:03_pressure_ratio_against_reflected){reference-type="ref"
reference="eqn:03_pressure_ratio_against_reflected"} and verified to be
small. Figure
[\[fig:03\_tunnel\_discretization\]](#fig:03_tunnel_discretization){reference-type="ref"
reference="fig:03_tunnel_discretization"} shows these parameters for the
tunnel at a Mach number of 0.6 in the test-section with flow going from
right-to-left.

![Wind-tunnel discretization at a Mach number of 0.6. The solid lines in
the sound transmission plots represent the transmitted pressure ratio
while the dotted lines represent the reflected pressure
ratio.](../matlab/03_aero_optics_acoustics/tunnel_discretization_0.60.eps "fig:")
(-162,375) (-215,60)Acoustic Propagation $\Longrightarrow$
(-235,190)$\Longleftarrow$ Acoustic Propagation

[\[fig:03\_tunnel\_discretization\]]{#fig:03_tunnel_discretization
label="fig:03_tunnel_discretization"}

For most of the wind-tunnel the Mach number is around 0.1 with the
transmission pressure ratio (solid lines) at effectively unity. In the
regions of rapid Mach number change around the contraction and the
test-section diffuser, the transmission pressure ratio can deviated
significantly from unity, especially for sound waves traveling upstream.
These regions also show some reflected pressure ratios (dotted lines)
that are non-negligible. For acoustic waves traveling in both
directions, the section on the opposite side of the test section
produces some reflected acoustic waves back into the test section.

The wind-tunnel fan was modeled using a circular duct mode of $m=8$ and
$n=0$ at a frequency of 520 Hz which corresponds to the blade-passing
frequency of the Mach number 0.6 case. The duct mode of $m=8$ and $n=0$
is the largest cut-on mode in which the azimuthal mode number is a
whole-number fraction of the total number of fan blades, 32. The
peak-to-peak acoustic pressure of the fan was set to unity to allow the
results to be easily scaled. To check for the possibility of some duct
modes only being present at certain orientations of the fan blades, the
initial acoustic pressure disturbance was rotated by replacing
$\omega t$ in the temporal portion of Equation
[\[eqn:02\_pressure\_solution\_duct\]](#eqn:02_pressure_solution_duct){reference-type="ref"
reference="eqn:02_pressure_solution_duct"} with a phase offset that
varied from 0 to 2$\pi$.

Cross-sectional slices of the acoustic field as the waves march upstream
from the fan through the circle to square transition are shown in Figure
[\[fig:03\_transition\_acoustics\]](#fig:03_transition_acoustics){reference-type="ref"
reference="fig:03_transition_acoustics"}.

![Cross-sectional slices of the acoustic field through the circle to
square transition for the acoustic waves traveling upstream. Left side
are the waves traveling from the fan at a phase of 0 radians and the
right side at a phase of $\pi$/2 radians. The top plots are the fan
acoustic field, the middle plots are halfway through the transition, and
the bottom plots are just into the square
duct.](../matlab/03_aero_optics_acoustics/tunnel_slices/tunnel_acoustic_against_0.6_8_0_0_001.eps "fig:")
![Cross-sectional slices of the acoustic field through the circle to
square transition for the acoustic waves traveling upstream. Left side
are the waves traveling from the fan at a phase of 0 radians and the
right side at a phase of $\pi$/2 radians. The top plots are the fan
acoustic field, the middle plots are halfway through the transition, and
the bottom plots are just into the square
duct.](../matlab/03_aero_optics_acoustics/tunnel_slices/tunnel_acoustic_against_0.6_8_0_1.5708_001.eps "fig:")\
![Cross-sectional slices of the acoustic field through the circle to
square transition for the acoustic waves traveling upstream. Left side
are the waves traveling from the fan at a phase of 0 radians and the
right side at a phase of $\pi$/2 radians. The top plots are the fan
acoustic field, the middle plots are halfway through the transition, and
the bottom plots are just into the square
duct.](../matlab/03_aero_optics_acoustics/tunnel_slices/tunnel_acoustic_against_0.6_8_0_0_006.eps "fig:")
![Cross-sectional slices of the acoustic field through the circle to
square transition for the acoustic waves traveling upstream. Left side
are the waves traveling from the fan at a phase of 0 radians and the
right side at a phase of $\pi$/2 radians. The top plots are the fan
acoustic field, the middle plots are halfway through the transition, and
the bottom plots are just into the square
duct.](../matlab/03_aero_optics_acoustics/tunnel_slices/tunnel_acoustic_against_0.6_8_0_1.5708_006.eps "fig:")\
![Cross-sectional slices of the acoustic field through the circle to
square transition for the acoustic waves traveling upstream. Left side
are the waves traveling from the fan at a phase of 0 radians and the
right side at a phase of $\pi$/2 radians. The top plots are the fan
acoustic field, the middle plots are halfway through the transition, and
the bottom plots are just into the square
duct.](../matlab/03_aero_optics_acoustics/tunnel_slices/tunnel_acoustic_against_0.6_8_0_0_012.eps "fig:")
![Cross-sectional slices of the acoustic field through the circle to
square transition for the acoustic waves traveling upstream. Left side
are the waves traveling from the fan at a phase of 0 radians and the
right side at a phase of $\pi$/2 radians. The top plots are the fan
acoustic field, the middle plots are halfway through the transition, and
the bottom plots are just into the square
duct.](../matlab/03_aero_optics_acoustics/tunnel_slices/tunnel_acoustic_against_0.6_8_0_1.5708_012.eps "fig:")

[\[fig:03\_transition\_acoustics\]]{#fig:03_transition_acoustics
label="fig:03_transition_acoustics"}

The plots on the left side are at an initial phase angle of 0 radians
and the right side are at a phase angle of $\pi$/2 radians. The top
plots are the cross-sectional slices of the acoustic field directly
upstream of the fan, the middle plots are halfway through the
transition, and the bottom plots are just into the square duct. As an
acoustic wave propagates upstream, a phase shift can be observed with
the halfway transitioned cross-sectional slices having an opposite local
phase. As the acoustic wave enters the square duct the 0 radian phase,
left side, bears little resemblance to the original acoustic wave while
the $\pi$/2 radian phase shows some significant similarities.

The acoustic field cross-section at the center of the test-section is
shown in Figure
[\[fig:03\_test\_section\_acoustics\]](#fig:03_test_section_acoustics){reference-type="ref"
reference="fig:03_test_section_acoustics"} for a variety of initial
phase angles.

![Cross-sectional acoustic field slices in the center of the
test-section at various initial phase
angles.](../matlab/03_aero_optics_acoustics/tunnel_slices/tunnel_acoustic_against_0.6_8_0_0_081.eps "fig:")
![Cross-sectional acoustic field slices in the center of the
test-section at various initial phase
angles.](../matlab/03_aero_optics_acoustics/tunnel_slices/tunnel_acoustic_against_0.6_8_0_0.5236_081.eps "fig:")
![Cross-sectional acoustic field slices in the center of the
test-section at various initial phase
angles.](../matlab/03_aero_optics_acoustics/tunnel_slices/tunnel_acoustic_against_0.6_8_0_1.0472_081.eps "fig:")
![Cross-sectional acoustic field slices in the center of the
test-section at various initial phase
angles.](../matlab/03_aero_optics_acoustics/tunnel_slices/tunnel_acoustic_against_0.6_8_0_1.5708_081.eps "fig:")
![Cross-sectional acoustic field slices in the center of the
test-section at various initial phase
angles.](../matlab/03_aero_optics_acoustics/tunnel_slices/tunnel_acoustic_against_0.6_8_0_2.0944_081.eps "fig:")
![Cross-sectional acoustic field slices in the center of the
test-section at various initial phase
angles.](../matlab/03_aero_optics_acoustics/tunnel_slices/tunnel_acoustic_against_0.6_8_0_2.618_081.eps "fig:")

[\[fig:03\_test\_section\_acoustics\]]{#fig:03_test_section_acoustics
label="fig:03_test_section_acoustics"}

As the fan blades rotate so too does the acoustic field within the
test-section. The real component of the duct modes are shown in Figure
[\[fig:03\_test\_section\_modes\]](#fig:03_test_section_modes){reference-type="ref"
reference="fig:03_test_section_modes"} as a function of the initial
phase angle. The primary duct mode in the test-section is the $m=2$,
$n=2$ mode with contributions from pairs of modes $m=0,2$, $n=2,0$ which
are in phase with one another and out of phase mode pairs $m=1,3$,
$n=3,1$. Note that for Figures
[\[fig:03\_test\_section\_modes\]](#fig:03_test_section_modes){reference-type="ref"
reference="fig:03_test_section_modes"} and
[\[fig:03\_test\_section\_modes\_with\]](#fig:03_test_section_modes_with){reference-type="ref"
reference="fig:03_test_section_modes_with"} the $m=0,2$, $n=2,0$ modes
overlap one another in the plots.

![The real component of the acoustic mode coefficients making up the
upstream-traveling acoustic field in the middle of the test-section as a
function of the initial phase
angle.](../matlab/03_aero_optics_acoustics/tunnel_acoustic_against_0.6_8_0.eps)

[\[fig:03\_test\_section\_modes\]]{#fig:03_test_section_modes
label="fig:03_test_section_modes"}

These five modes can be used to simulate the optical response of the fan
driven acoustics inside of the test section by using the maximum value
of the modal coefficient and a relative phase angle between the
different modes by using Equation
[\[eqn:02\_pressure\_solution\_duct\]](#eqn:02_pressure_solution_duct){reference-type="ref"
reference="eqn:02_pressure_solution_duct"} and
$$\widehat{\opd}(x,y) = \frac{K_{GD}}{c_0^2}\int_{z_1}^{z_2} \hat{p}(x,y,z)_{Ap}dz \textrm{,}
  \label{eqn:03_opd_complex}$$ where $\widehat{\opd}$ is the complex
optical path difference and $K_{GD}$ is the Gladstone-Dale constant. The
temporal portion of Equation
[\[eqn:02\_pressure\_solution\_duct\]](#eqn:02_pressure_solution_duct){reference-type="ref"
reference="eqn:02_pressure_solution_duct"} can be applied after the
integration process in Equation
[\[eqn:03\_opd\_complex\]](#eqn:03_opd_complex){reference-type="ref"
reference="eqn:03_opd_complex"} and just before taking the real
component to simulate a measured value at a particular instant in time.

The acoustic duct modes in the center of the test-section for the
acoustic waves traveling in the direction of the flow are shown in
Figure
[\[fig:03\_test\_section\_modes\_with\]](#fig:03_test_section_modes_with){reference-type="ref"
reference="fig:03_test_section_modes_with"}.

![The real component of the acoustic mode coefficients making up the
downstream-traveling acoustic field in the middle of the test-section as
a function of the initial phase
angle.](../matlab/03_aero_optics_acoustics/tunnel_acoustic_with_0.6_8_0.eps)

[\[fig:03\_test\_section\_modes\_with\]]{#fig:03_test_section_modes_with
label="fig:03_test_section_modes_with"}

The downstream-traveling acoustic field inside of the test-section is
comprised of the same duct modes as the upstream-traveling acoustic
field but the mode coefficient are approximately an order-of-magnitude
lower. All of the phase offsets for the modes remain the same except for
the $m=2$, $n=2$ mode which is now different by $\pi$ radians compared
to the upstream-traveling modes in Figure
[\[fig:03\_test\_section\_modes\]](#fig:03_test_section_modes){reference-type="ref"
reference="fig:03_test_section_modes"}. When the downstream-traveling
acoustic field enters the cruciform after the test-section a portion of
it is reflected, see Figure
[\[fig:03\_tunnel\_discretization\]](#fig:03_tunnel_discretization){reference-type="ref"
reference="fig:03_tunnel_discretization"}. When the maximum reflected
pressure ratio, approximately -0.2, is combined with the strength of the
downstream-traveling acoustic field, the acoustic field reflected back
into the test-section is 1-2 orders-of-magnitude lower than the
upstream-traveling acoustic field from the fan. On the other hand, the
reflected field from the upstream-traveling acoustic field after it
leaves the test-section is on the same order-of-magnitude as the
downstream-traveling acoustic field.

A comparison between a measured optical wavefront that has been
band-pass filtered at the blade-passing frequency and a simulated
optical wavefront that has been shot through the estimated acoustic
field computed by the mode-marching method is shown in Figure
[\[fig:03\_tunnel\_comparison\]](#fig:03_tunnel_comparison){reference-type="ref"
reference="fig:03_tunnel_comparison"}.

![Comparison of a measured optical wavefront and a simulated one passing
through the estimated acoustic
field.](../matlab/03_aero_optics_acoustics/tunnel_comparison.eps)

[\[fig:03\_tunnel\_comparison\]]{#fig:03_tunnel_comparison
label="fig:03_tunnel_comparison"}

Qualitatively, there is significant agreement between the two
wavefronts. Since there was no microphones installed in either the
test-section or around the wind-tunnel fan, there cannot be a
quantitative comparison made.

Summary {#sect:03_summary}
-------

Acoustic waves affect the transmission of light by causing the local
index-of-refraction to change with the pressure fluctuations. When the
acoustic field is well modeled, as was the case with the spherical wave
measurements, an optical wavefront measurement can provide an accurate
measurement of the acoustic field strength non-intrusively.

The mode-marching method provides a computationally rapid way of
estimating an acoustic signal as it travels through a duct system like a
wind-tunnel. This method assumes that the reflected component will be
minimal and can be ignored. A significant contribution of this work to
the computational procedure of this method is computing the
eigen-functions for the wind-tunnel fan transition geometries that are
neither circular nor rectangular. These computations would become even
more costly if the cross-section cannot be assumed to have a uniform
flow speed [@Wilson-2019-VV2zh7Au]. Finally, note that the mode-marching
method used here has neglected the effect that the corners would have on
the signal or other internal geometry such as the turning vanes or the
turbulence screens.

The main benefit to using a mode-marching method is to simulate
narrow-band signals that appear in the optical wavefront spectra and to
have some level of confidence that the source of that signal is the
wind-tunnel fan. If the narrow-band signal does not match up with the
simulated signal, it could have a source that may not be due to the
testing environment and would likely need to be investigated further. If
there is significant agreement between the measured and simulated
signals, a simple stop-band filter could be used to eliminate the
contamination.

Multidimensional Spectral Estimation of Optical Wavefronts {#chap:04_dispersion}
==========================================================

As described in Chapter [1](#chap:01_intro){reference-type="ref"
reference="chap:01_intro"}, the objective of this research is to develop
methods to evaluate and, if possible, eliminate the effect of
facility-related acoustic noise on aero-optical measurements. As such,
the first goal of the research is to establish analytical methods to
identify and isolate acoustic sources of optical signals within a given
data sample. This is a significant challenge since, as will be shown
later, acoustic sources of optical aberrations typically have a
magnitude and frequency content that is in the same range as the signal
that is the objective of the measurement. This chapter will begin with a
brief overview of some of the benefits to analyzing multidimensional
data in this way, followed be a short discussion on how these spectra
are calculated, and conclude with a more in depth discussion of the
analysis of multidimensional spectral estimates.

The multi-dimensional spectral approach that is employed throughout this
research helps identify and characterize acoustic sources of optical
noise as well as aero-optical signals. The spectral approach is also
used as the basis for methods to filter the acoustic sources. For
measurements in multiple dimensions, such as a line of sensors that are
recorded over time, a multidimensional spectral estimation not only
produces temporal frequency content but can also be used to identify the
direction and speed of travel of a particular wave.

The benefits of using multidimensional spectral estimation are shown in
Figure
[\[fig:04\_dispersion\_demo\]](#fig:04_dispersion_demo){reference-type="ref"
reference="fig:04_dispersion_demo"}.

![Multidimensional spectral estimation plot example and comparison to
traditional power spectrum measurements. A single row of an optical
wavefront measurement was used in this example. The top plot shows the
typical power spectrum averaged over the entire row of data. Both the
middle and bottom plots show the multidimensional spectrum plot with the
y-axis as spatial frequency in the middle and velocity in the bottom
assuming
$u=f/\xi_x$.](../matlab/04_dispersion_analysis/dispersion_demo.eps)

[\[fig:04\_dispersion\_demo\]]{#fig:04_dispersion_demo
label="fig:04_dispersion_demo"}

The spectra shown in the figure were computed using the OPD measured by
a single row of sub-apertures from a Shack-Hartmann optical wavefront
measurement in which a 5 inch diameter beam was propagated normally
through a wind-tunnel test section with a free-stream Mach number of
0.5. This measurement was performed in the University of Notre Dame
White Field Wind Tunnel in a test section that contained a model
representing the fuselage of the AAOL aircraft [@Jumper-2013-8KtN3pue]
with window that was flat and flush to the outer mold line of the
fuselage. The top plot shows a traditional power spectrum
ensemble-averaged over the row of data. Both the blade-passing frequency
(517 Hz) and its sub-harmonic had similar amplitudes with an additional
five harmonics showing significant peaks. There are three additional
strong peaks at approximately 3100, 4850, and 5850 Hz that are likely
due to fan vibration that limited the top speed of the tunnel for the
test.

Both the middle and bottom plots show the multidimensional spectral
estimation of the two-dimensional data, $\opd(x,t)$. Since the figure is
for illustrative purposes, colorbars were not shown; however, the color
is representative of the logarithm of the power or variance in the
wavefront signal (i.e. $\opdrms^2$) with yellow representing more power
and blue representing less. The colorbar range in this figure is the
same for the middle and bottom plots and is consistent with the other
plots throughout this chapter. In the middle plot the y-axis represents
the stream-wise spatial frequency, $\xi_x$ with the units of inverse
meters. It is important to note that, unlike temporal frequencies,
spatial frequencies can have positive or negative values depending on
the direction of travel of the disturbance, in Figure
[\[fig:04\_dispersion\_demo\]](#fig:04_dispersion_demo){reference-type="ref"
reference="fig:04_dispersion_demo"}, waves with positive spatial
frequencies are moving in the direction of flow. In the middle plot of
Figure
[\[fig:04\_dispersion\_demo\]](#fig:04_dispersion_demo){reference-type="ref"
reference="fig:04_dispersion_demo"}, there is a strong signal that
roughly lies on the zero spatial frequency ($\xi_x\approx0$) axis up to
a frequency of  2000 Hz, after which the signal in the spectrum can be
clearly seen to branch off into upstream- and downstream-moving
disturbances. The cause of the branching in the signal will be discussed
later, however note that the reason why the signal appears to lie on
$\xi_x\approx0$ at low frequencies is simply an artifact of plotting the
spectrum on semilog axes (which was done to better resolve the peaks in
the power spectrum in the top plot of the figure); as shown later in
plots with linear axes, the signal actually branches off into upstream-
and downstream-moving disturbances even at low frequencies. The
blade-passing frequency and its various harmonics can also be discerned
in the center plot, by the vertical "streaks" that line up with the
peaks in the standard spectrum shown in the top plot; the center
spectral plot shows that these fan blade-passing signals have
significant broadband spatial frequency content. All of these
narrow-band signals have a majority of their signal traveling upstream.
In addition to optical disturbances branching off in the upstream and
downstream moving directions there are significant disturbances along
zero spatial frequency representing a collection of standing waves. As
already mentioned, he data in Figure
[\[fig:04\_dispersion\_demo\]](#fig:04_dispersion_demo){reference-type="ref"
reference="fig:04_dispersion_demo"} were plotted logarithmically along
the temporal-frequency axis to better show the low frequency content
around the fan blade-passing frequency, and how the peaks in the power
spectrum in the top plot still appear in the multidimensional spectrum
in the middle plot. As shown later, when the multidimensional spectrum
is plotted linearly, the two primary upstream and downstream traveling
signals lay in a straight line.

A dispersion analysis can be performed on these multidimensional
spectral estimates. In order to obtain the velocity of a given wave we
can start with the most basic forms of the wave equation,
$$\hat{y} = a\exp\{j\theta\} \textrm{,}$$ where $\theta$ is the phase of
the wave and equal to $kx-\omega t$. From here we can take the partial
of $\theta$ with respect to time and set it equal to zero,
$$\frac{\partial\theta}{\partial t} = 0 = \frac{\partial k}{\partial t}\frac{\partial x}{\partial t}-\frac{\partial \omega}{\partial t}\frac{\partial t}{\partial t} \textrm{,}$$
which can be rearranged to
$$u = \frac{\partial \omega}{\partial k} = \frac{\partial f}{\partial \xi} \textrm{.}$$
If we are to assume that a wave packet intercepts the origin ($f=\xi=0$)
then every point on the spectral plot can be assumed to have a
disturbance velocity, $$u_{d} = \frac{f}{\xi_x} \textrm{.}
  \label{eqn:04_velocity_assumed}$$ This relationship shows that, for a
nondispersive medium such as air, the spatial frequency of a disturbance
is related linearly to the temporal frequency as $1/u_d$. The bottom
plot shows the same multidimensional spectral estimation plot as the
middle one but with the y-axis showing disturbance velocity $u_d$. The
bottom plot shows that the primary optical disturbance moving in the
direction of flow is moving at the free-stream velocity of approximately
175 m/s. The upstream traveling disturbance is traveling at the same
speed but due to the signal being broader is more difficult to measure
this way. Note that the stationary modes along $\xi_x\approx0$ in the
middle plot are nowhere to be found on the bottom plot; this is because
when the disturbance velocity for this these waves is calculated their
speed approaches infinity.

One-Dimensional Power Spectrum Calculation
------------------------------------------

Power spectral analysis is typically performed on one-dimensional data
sets, for example, a single sensor measurement over time. On the other
hand, as shown in Figure
[\[fig:04\_dispersion\_demo\]](#fig:04_dispersion_demo){reference-type="ref"
reference="fig:04_dispersion_demo"}, if a sensor array were used, a
multi-dimensional power spectrum could be computed that would also show
spatial frequency information. For a single-point measurement that
varies in time, $x(t)$, the power spectrum calculation is
$$S_{xx} = \frac{|\fft\{x(t)\}|^2}{Nf_{s}} \textrm{,}
 \label{eqn:04_basic_sxx}$$ where $\fft$ is the Fast Fourier Transform,
$N$ is the number of samples, and $f_{s}$ is the sample rate
[@Blackman-1958-4QtKgDb8]. For data that has only a real component the
Fast Fourier Transform function produces magnitude and phase relations
at each frequency step, $f_{s}/N$, over the range from zero-frequency up
to but not including the Nyquist frequency, $f_s/w$, with a mirrored set
of data that can be represented either below (starting at $-f_s/2$) or
above (ending just below $f_s$) this range. The Nyquist frequency not
being included and the mirrored data is due to an assumption that is
integral to the Fourier Transform, which is that the signal is assumed
to be periodic.

The total energy, $\sigma^2$, of the signal must be preserved through
the transform from physical space-time to frequency space
$$\sigma^2 = \frac{\sum x^2(t)}{N} = \Delta f\sum S_{xx}(f) \textrm{.}
  \label{eqn:04_fft_energy_conservation}$$ Additionally, because of the
periodic nature of the Fourier Transform and a finite sample length of
discrete data, spectral leakage can cause the power in one frequency bin
to leak into adjacent frequency bins. To minimize this spectral leakage,
windowing functions are employed which typically force the end points of
the signal to zero. The Hann window,
$$w(t) = 1/2\left[1-\cos\left(\frac{2\pi t}{T}\right)\right] \textrm{,}
 \label{eqn:04_hann_window}$$ is one of the more commonly used windowing
functions [@Braun-2001-qhqBfvYz] where $w(t)$ is the window function,
$t$ is the time at a given sample, and $T$ is the total sample time.
Since the windowing of a data set changes the signal energy some
correction is needed to be applied. For an arbitrary windowing function
the correction factor, $c_w$, can be obtained by substituting the
windowing function in place of $x(t)$ in Equation
[\[eqn:04\_fft\_energy\_conservation\]](#eqn:04_fft_energy_conservation){reference-type="ref"
reference="eqn:04_fft_energy_conservation"},
$$c_w = \frac{1}{\sqrt{\sum w^2(t)/N}} \textrm{.}
 \label{eqn:04_window_correction}$$ For a Hann window this correction
factor approaches $\sqrt{8/3}$ as $N$ goes to infinity. When Equation
[\[eqn:04\_basic\_sxx\]](#eqn:04_basic_sxx){reference-type="ref"
reference="eqn:04_basic_sxx"} is combined with a windowing function and
associated correction the double sided power spectra equation in one
dimension becomes
$$S_{xx} = \frac{|c_w\fft\{x(t) w(t)\}|^2}{Nf_{s}} \textrm{.}
 \label{eqn:04_windowed_sxx}$$

N-Dimensional Power Spectra Calculation
---------------------------------------

For measurements with multiple spatial and temporal dimensions the Fast
Fourier Transform is applied $n$-times where $n$ is the total number of
dimensions, with each application in a different dimension,
$$\fftn(x) = \fft(\fft(\cdots\fft(\fft(x,1),2)\cdots,n-1),n) \textrm{,}
 \label{eqn:04_fftn}$$ where $\fft(x,n)$ is the Fast Fourier Transform
of $x$ in the $n^{th}$ dimension [@An-1991-QKg7heKm]. For a
$n$-dimensional array the operation becomes [@McClellan-1982-rGQzuZ7t]
$$\mathbf{S_{xx}} =\frac{|c_w\fftn\{f(\mathbf{x}) w(\mathbf{x})\}|^2}{\prod{\overrightarrow{N}\overrightarrow{f_s}}} \textrm{,}
 \label{eqn:04_sxxn}$$ where $\mathbf{S_{xx}}$ is the $n$-dimensional
power spectra array or dispersion array, $f(\mathbf{x})$ is an
$n$-dimensional set of data, $w(\mathbf{x})$ is an $n$-dimensional
windowing function, $\overrightarrow{N}$ is a vector denoting the number
of elements in each dimension, $\overrightarrow{f_s}$ is a vector
denoting the sample rate in each dimension, and
$$c_w = \frac{1}{\sqrt{\sum w^2(\mathbf{x})/\prod{\overrightarrow{N}}}} \textrm{.}
 \label{eqn:04_windown}$$ The signal energy conservation relationship
becomes
$$\sigma^2=\frac{\sum\mathbf{x}}{\prod{\overrightarrow{N}}} = \prod{\overrightarrow{\Delta f_s}}\sum\mathbf{S_{xx}} \textrm{,}
  \label{eqn:04_fftn_energy_conservation}$$ where
$\overrightarrow{\Delta f_s}$ is a vector representing the frequency
step sizes in each dimension.

Non-Rectangular Spatial Windows
-------------------------------

For n-dimensional data sets that fill a rectangular array, a windowing
function can be created by multiplying together a series of
one-dimensional windowing functions in the direction of each dimension.
For non-rectangular data sets, such as is often the case with optical
wavefront measurements, a windowing function can take some additional
steps in its construction. In cases when the spatial measurement
locations are constant throughout time, the windowing function can be
split into two separate components,
$$w(\mathbf{x}) = w_t(t)\cdot w_s(x,y) \textrm{,}
 \label{eqn:04_window_sep}$$ the temporal windowing function, $w_t(t)$,
and the spatial windowing function, $w_s(x,y)$. This study uses a Hann
window for the temporal windowing function and a modified Hann window
for the spatial windowing function. For the case of a perfectly circular
aperture, the Hann window can be reformulated to be based on the
normalized radius, $\rho_N$, of the aperture, $$w_s(\rho_N) =
 \begin{cases}
  \frac{1+\cos(\pi\cdot\rho_N)}{2} & \textrm{if } \rho_N < 1 \\
  0                                & \textrm{otherwise.}
 \end{cases}
 \label{eqn:04_window_space}$$ This modified Hann window is
two-dimensional with a value of one at the center of the aperture and
decreases to zero at the edge of the aperture in the same manner as a
Hann windows decreases from the center to either end.

Because the wavefronts measurements often had a clipped edge or some
other obscuration, a different method was employed in this study. For an
arbitrary shaped aperture, the minimum distance from any given
measurement location to the edge of the aperture was used to create the
spatial windows. The minimum distance can be computed given the a set of
points ($x$ and $y$) that spans the measurement range and the set of
points outside of the aperture ($x_O$ and $y_O$),
$$d_{min}(x,y) = \min\left\{\sqrt{(x-x_{O})^2+(y-y_{O})^2}\right\} \textrm{.}
 \label{eqn:04_window_space_arb_dist}$$ This distance is then normalized
by the maximum value and the resulting spatial window given a modified
Hann window,
$$w_s(x,y) = \frac{1+\cos\left\{\pi\cdot\left(1-d_{min}^{norm}(x,y)\right)\right\}}{2} \textrm{.}
 \label{eqn:04_window_space_arb}$$ This same basic idea can be extended
to data sets where the locations of measurements in space vary with
time.

Wavefront Multidimensional Spectrum
-----------------------------------

At the beginning of this chapter a multidimensional spectral plot for
data resolved in time and one spatial dimension was shown along with a
typical power spectrum plot in Figure
[\[fig:04\_dispersion\_demo\]](#fig:04_dispersion_demo){reference-type="ref"
reference="fig:04_dispersion_demo"}. This was shown to facilitate a
simple discussion of some of the benefits of using multidimensional
spectrum analysis on optical wavefronts. That simple analysis was
performed on only a single row of a wavefront data set and provided an
insight into the disturbances that were moving in the horizontal (stream
wise) direction only. When multidimensional spectral estimation is
performed over all dimensions of a wavefront (i.e. time and both spatial
dimensions), as will be done for the remainder of this chapter,
additional detail is available, that also enables the determination of
optical disturbances moving vertically (i.e. cross-stream to the flow)
or in any direction in between. Figure
[\[fig:04\_dispersion\_comparison\]](#fig:04_dispersion_comparison){reference-type="ref"
reference="fig:04_dispersion_comparison"} shows a comparison between the
two-dimensional single row spectrum (bottom plot) with two different
representations of the same two-dimensional spectrum extracted from a
three-dimensional spectral calculation.

![Horizontal moving optical disturbances comparison. The top plot shows
a slice of the three-dimensional spectrum focusing on the plane waves
that are traveling in the horizontal direction. The middle plot is a
recreation of the two-dimensional spectrum by integrating through the
the vertical spatial frequencies. The bottom plot is the two-dimensional
spectrum.](../matlab/04_dispersion_analysis/dispersion_comparison.eps)

[\[fig:04\_dispersion\_comparison\]]{#fig:04_dispersion_comparison
label="fig:04_dispersion_comparison"}

Specifically, the top plot in Figure
[\[fig:04\_dispersion\_comparison\]](#fig:04_dispersion_comparison){reference-type="ref"
reference="fig:04_dispersion_comparison"} shows the "slice" of the
three-dimensional spectral estimation plot taken at $\xi_y=0\ m^{-1}$;
because this slice does not contain any information on vertically-moving
disturbance, it shows planar waves traveling in the horizontal
direction. The middle plot shows the same three-dimensional spectrum
integrated through the vertical spatial frequency axis to create an
estimate of the two-dimensional spectrum. The bottom plots shows the
two-dimensional spectral plot that was previously shown in Figure
[\[fig:04\_dispersion\_demo\]](#fig:04_dispersion_demo){reference-type="ref"
reference="fig:04_dispersion_demo"} but this time with a linear temporal
frequency axis. Both of the two-dimensional spectra in the top two plots
of Figure
[\[fig:04\_dispersion\_comparison\]](#fig:04_dispersion_comparison){reference-type="ref"
reference="fig:04_dispersion_comparison"}, whether directly computed or
integrated show a significant increase in the signal content between the
acoustic lines ($u\pm c$).

The three-dimensional spectral slice (top plot) shows significant signal
energy at the same characteristic velocities of the free-stream
velocity, $u$, and the acoustic lines, $u\pm c$, as the two-dimensional
spectrum (bottom plot), along with some additional signal laying along
the temporal-frequency axis at $\xi_y=0\ m^{-1}$. This signal represents
a collection of stationary modes at each temporal frequency. If this
were a flow-related phenomenon the velocity of the disturbance according
to Equation
[\[eqn:04\_velocity\_assumed\]](#eqn:04_velocity_assumed){reference-type="ref"
reference="eqn:04_velocity_assumed"} would be near infinity; as such, it
is more likely caused by mechanical vibration of the wind tunnel and
components of the optical measurement system. On the three-dimensional
spectrum plot there are signals that run parallel to $u$ and $u-c$ that
do not emanate from the origin but from $\xi_x\approx\pm80\ m^{-1}$; at
present an explanation for these signals cannot be given; however, it is
possible that this effect is caused by an optical ghost image. There is
also an aliased signal that runs parallel to $u+c$ starting on the right
side of Figure
[\[fig:04\_dispersion\_comparison\]](#fig:04_dispersion_comparison){reference-type="ref"
reference="fig:04_dispersion_comparison"} top at
$\xi_x\approx-50\ m^{-1}$ and decaying towards the left. Aliased signals
are due to the sample rate, either spatial or temporal, being to low.

The middle plot of Figure
[\[fig:04\_dispersion\_comparison\]](#fig:04_dispersion_comparison){reference-type="ref"
reference="fig:04_dispersion_comparison"} shows the integrated spectrum
through the vertical spatial frequency axis. This integration captures
the energy in all vertical disturbances which effectively recreates the
two-dimensional spectrum plot on the bottom of Figure
[\[fig:04\_dispersion\_comparison\]](#fig:04_dispersion_comparison){reference-type="ref"
reference="fig:04_dispersion_comparison"}. A reduced order spectrum like
this is calculated by $$S_{xx}^{n-1} = \int S_{xx}^n df_s^m \textrm{,}$$
where $S_{xx}^n$ is the n-dimensional spectrum and $df_s^m$ is the
differential frequency in the $m$-th dimension. This is also shown in
Figure
[\[fig:04\_dispersion\_max\]](#fig:04_dispersion_max){reference-type="ref"
reference="fig:04_dispersion_max"}.

![Recovery of time-based power spectrum from two-dimensional spectral
estimate.](../matlab/04_dispersion_analysis/dispersion_max.eps)

[\[fig:04\_dispersion\_max\]]{#fig:04_dispersion_max
label="fig:04_dispersion_max"}

While the integrated signal over estimated the spectrum going from
three-dimensions to two in Figure
[\[fig:04\_dispersion\_comparison\]](#fig:04_dispersion_comparison){reference-type="ref"
reference="fig:04_dispersion_comparison"}, it under estimates the
spectrum going from two to one dimensions. Unfortunately, due to the
limited number of spatial sample points and the large dynamic range of
the signal, this integrated value can contain a significant amount of
error.

Due to the the signal containing a majority of the power in a limited
number of spatial frequency bins, a reduced order spectrum can be
estimated by $$S_{xx}^{n-1} \approx \max(S_{xx}^n,m)f_s^m \textrm{,}$$
where $\max(S_{xx}^n,m)$ is the maximum value of the spectrum along
dimension $m$ and $f_s^m$ is the sample rate for that dimension. The
calculated temporal power spectrum from the two-dimensional spectrum
using the maximum value is a good estimation at the center of the
frequency range but has some additional decay at both low and high
frequencies. The calculated reduced order spectrum in Figure
[\[fig:04\_dispersion\_max\]](#fig:04_dispersion_max){reference-type="ref"
reference="fig:04_dispersion_max"} (red curve) appears to follow the
functional form of the actual one-dimensional spectrum (blue curve) but
with a small offset.

### 2-D Slices of the Multidimensional Spectral Estimation

The full multidimensional spectrum contains information of flow features
that are not only moving in the horizontal (stream-wise) direction as
the two-dimensional dispersion showed but also in every direction of the
two-dimensional optical wavefront. Figure
[\[fig:04\_dispersion\_xy\]](#fig:04_dispersion_xy){reference-type="ref"
reference="fig:04_dispersion_xy"} shows two-dimensional slices of the
full spectrum that on the top show the horizontal (stream-wise) moving
disturbances for a vertical spatial frequency of $\xi_y=0$ $m^{-1}$ and
on the bottom show the vertical (cross-stream) moving disturbances for a
horizontal spatial frequency of $\xi_x=0$ $m^{-1}$.

![Horizontal and vertical moving optical disturbances. This is the same
data as presented in Figure
[\[fig:04\_dispersion\_demo\]](#fig:04_dispersion_demo){reference-type="ref"
reference="fig:04_dispersion_demo"} but after calculating the full
three-dimensional spectral estimate. These optical disturbances are
plane waves that are traveling solely in their respective
directions.](../matlab/04_dispersion_analysis/dispersion_xy.eps)

[\[fig:04\_dispersion\_xy\]]{#fig:04_dispersion_xy
label="fig:04_dispersion_xy"}

Since the wavelength is $\lambda=1/\xi$, the waves that make up the
disturbances shown in these slices are plane waves that are traveling
solely in the horizontal or vertical directions.

The top plot of Figure
[\[fig:04\_dispersion\_xy\]](#fig:04_dispersion_xy){reference-type="ref"
reference="fig:04_dispersion_xy"} shows the two-dimensional spectrum for
horizontally moving optical disturbances that was shown previously.
There are three major flow-related structures that can be observed. The
large signal that lays along $u$ (solid line in Figure
[\[fig:04\_dispersion\_xy\]](#fig:04_dispersion_xy){reference-type="ref"
reference="fig:04_dispersion_xy"}) is the aero-optical effect of the
boundary layers on both walls of the wind tunnel. It can be seen that
the boundary-layer signal has a peak slightly less than the free-stream
velocity, $u$, and has a slight decay as the velocity decreases away
from the peak and a sharp decay as the velocity increases. For
reference, the dotted line at the top of Figure
[\[fig:04\_dispersion\_xy\]](#fig:04_dispersion_xy){reference-type="ref"
reference="fig:04_dispersion_xy"} denotes a velocity of $0.7u$. The
velocity of the strongest aberrating structures in the boundary layer
has typically been reported as approximately 0.83$u$
[@Gordeyev-2014-jcJndkHM], however, this data shows the boundary layer
velocity has a range of velocities at each given frequency in which the
peak velocity component has some dependence on the temporal frequency.
This can be more clearly seen in two temporal frequency slices in Figure
[\[fig:04\_dispersion\_slices\_velocity\]](#fig:04_dispersion_slices_velocity){reference-type="ref"
reference="fig:04_dispersion_slices_velocity"} which shows vertical
spatial frequency plotted against the normalized horizontal
(stream-wise) velocity.

![Temporal-frequency slices at 5 and 10 kHz with the various horizontal
velocities
labeled.](../matlab/04_dispersion_analysis/dispersion_slices_velocity.eps)

[\[fig:04\_dispersion\_slices\_velocity\]]{#fig:04_dispersion_slices_velocity
label="fig:04_dispersion_slices_velocity"}

Again, the figure shows strong decay of the signal as the speed
increases above the free-stream velocity and gradual decay as the speed
decreases. There is also additional signal decay as the absolute value
of the vertical spatial frequency increases. The velocity of this
boundary layer optical disturbance will be measured in Chapter
[6](#chap:06_single_filter){reference-type="ref"
reference="chap:06_single_filter"} using a velocity filter to show a
mean velocity of $0.85u$, which is near the generally accepted value of
$0.83u$ [@Gordeyev-2014-jcJndkHM].

The other two major flow-related structures in Figure
[\[fig:04\_dispersion\_xy\]](#fig:04_dispersion_xy){reference-type="ref"
reference="fig:04_dispersion_xy"} are related to acoustic signals
traveling in both directions through the wind-tunnel, denoted by the
dashed and dot-dash lines in the figure. The downstream-traveling
acoustic wave, $u+c$, has a low signal power than the upstream-traveling
acoustic wave, $u-c$. The likely explanation for this difference in
signal power is that most of the acoustic energy in the wind tunnel is
generated by the fan which propagates upstream and downstream within the
wind-tunnel ducting. However, sound waves that move in the flow
direction have their wavelength stretched as the flow is accelerated
into the test-section contraction, while sound waves moving against the
flow have their wavelength contracted. Hence the downstream-traveling
waves have a longer wavelength as they pass through the measurement beam
and thus more of the optical signal from the downstream-travelling waves
is filtered out due to aperture filtering [@Siegenthaler-2008-9Yutbt6c].
At low temporal frequencies, the blade-passing frequency ( 520 Hz) and
its associated harmonics appear as vertical lines with regular spacing
in Figure
[\[fig:04\_dispersion\_xy\]](#fig:04_dispersion_xy){reference-type="ref"
reference="fig:04_dispersion_xy"}.

The two main features on the vertical spectral slice plot on the bottom
of Figure
[\[fig:04\_dispersion\_xy\]](#fig:04_dispersion_xy){reference-type="ref"
reference="fig:04_dispersion_xy"} are the signals moving at the speed of
sound ($\pm c$) including some significant aliasing of these signals.
These two lines represent acoustic waves that are traveling either
straight up or down through the measurement beam. The blade-passing
frequency and its harmonics are also visible in the vertical moving wave
plots in both directions and have much less broadband spatial content in
the vertical direction. There are also high temporal frequency
narrow-band signals ($\sim$3, 5, and 6 kHz) that contain most of their
signal power at the speed of sound lines. These signals have some
dependence on the free-stream Mach number (see Figure
[\[fig:04\_dispersion\_mach\]](#fig:04_dispersion_mach){reference-type="ref"
reference="fig:04_dispersion_mach"}). These maybe vibrations originating
from the tunnel fan that are currently limiting the top speed of the
tunnel; some older optical wavefronts collected in this tunnel under
similar measurement conditions do not show these narrow-band signals.
Because the portion of these signals with the most power is traveling
vertically through the test section instead of steam wise, the tunnel
walls maybe excited by the fan and resonating.

The stationary modes that have been discussed previously that appear as
a broad horizontal band along the temporal frequency axis in the
horizontal spectral slice plot also appear in the same location in the
vertical spectral slice plot. These stationary modes appear the be
constant when viewed from either direction and through out time. As
stated by Blackman and Tukey, this kind of white-noise is generally not
physical unless it is bandwidth limited with a falloff of at least
$1/f^2$ [@Blackman-1958-4QtKgDb8]. Some of these stationary modes are
likely cause by vibrations of various optical elements, especially at
low temporal frequencies. At higher temporal frequencies, the stationary
modes maybe related to electronic noise from the high-speed camera,
higher order optical noise from the laser, or even numerical error from
the processing code.

### 3-D Representations of Multidimensional Spectral Estimation

While the two-dimensional slices are fairly informative, particularly
when it comes to signal strength of various flow structures and their
velocities, a three-dimensional plot allows better visualization of the
overall flow structures although some details are lost because typically
only one power level can be plotted at a time. The same data that has
been previously shown in two-dimensional form, is depicted in Figure
[\[fig:04\_dispersion\_3d\]](#fig:04_dispersion_3d){reference-type="ref"
reference="fig:04_dispersion_3d"} as an isosurface with a power of
$10^{-14}$ $\mu m^2/Hz/m^{-2}$ and shown from four different views.

![Three-dimensional view of the multidimensional spectral plot showing
an isosurface at a power of $10^{-14}$
$\mu m^2/Hz/m^{-2}$.](../matlab/04_dispersion_analysis/dispersion_3d.eps)

[\[fig:04\_dispersion\_3d\]]{#fig:04_dispersion_3d
label="fig:04_dispersion_3d"}

The largest feature is the boundary layer signal which resembles an
ellipsoidal plane that is tilted in the $f-\xi_s$ plane. The other main
feature is the acoustic signal which appears as a cone which is slightly
tilted in the direction of upstream-moving disturbances. The acoustic
signal separates into several spikes at high temporal frequencies some
of which are constructive interference from aliased signal
($\xi_x\approx25\ m^{-1},\ \xi_y\approx\pm60\ m^{-1}, \textrm{and}\ f\approx20 kHz$)
which is better visualized in the 20 kHz temporal frequency spectral
slice in Figure
[\[fig:04\_dispersion\_slices\_velocity\]](#fig:04_dispersion_slices_velocity){reference-type="ref"
reference="fig:04_dispersion_slices_velocity"}. There may also be a
small number of dominant duct modes at these high temporal frequencies.
The last feature is the stationary modes which appears as the
cylindrical structure along the center of the plot (near zero spatial
frequency in x and y), which have a near constant shape and magnitude
through all temporal frequency ranges.

Figure
[\[fig:04\_dispersion\_mach\]](#fig:04_dispersion_mach){reference-type="ref"
reference="fig:04_dispersion_mach"} shows two views of an isosurface of
the multidimensional spectrum over a range of Mach numbers.

![Multidimensional spectral estimate isosurfaces as the Mach number
increased from 0.3 to 0.5. The isosurfaces are all shown at a power of
$10^{-14}$
$\mu m^2/Hz/m^{-2}$.](../matlab/04_dispersion_analysis/dispersion_mach_0.3.eps "fig:")
![Multidimensional spectral estimate isosurfaces as the Mach number
increased from 0.3 to 0.5. The isosurfaces are all shown at a power of
$10^{-14}$
$\mu m^2/Hz/m^{-2}$.](../matlab/04_dispersion_analysis/dispersion_mach_0.4.eps "fig:")
![Multidimensional spectral estimate isosurfaces as the Mach number
increased from 0.3 to 0.5. The isosurfaces are all shown at a power of
$10^{-14}$
$\mu m^2/Hz/m^{-2}$.](../matlab/04_dispersion_analysis/dispersion_mach_0.5.eps "fig:")

[\[fig:04\_dispersion\_mach\]]{#fig:04_dispersion_mach
label="fig:04_dispersion_mach"}

All of these plots are of an isosurface with the same power as used in
Figure
[\[fig:04\_dispersion\_3d\]](#fig:04_dispersion_3d){reference-type="ref"
reference="fig:04_dispersion_3d"}. The stationary modes seem to be
constant throughout the range of Mach numbers indicating that they are
most likely not flow related. The boundary layer signal increases in
power significantly as the Mach number is increased while also the slope
and thus the velocity is significantly increased as well. As shown in
and discussed in Chapter [2](#chap:02_lit_review){reference-type="ref"
reference="chap:02_lit_review"}, the aero-optical $\opdrms$ of the
flat-plate boundary layer on the walls of the wind tunnel is expected to
vary according to Equation
[\[eqn:02\_opdrms\_gor\]](#eqn:02_opdrms_gor){reference-type="ref"
reference="eqn:02_opdrms_gor"}. Hence the significant increase in the
power of the boundary-layer spectrum with Mach number that can be
observed in Figure
[\[fig:04\_dispersion\_mach\]](#fig:04_dispersion_mach){reference-type="ref"
reference="fig:04_dispersion_mach"} is expected based on the $M^2$
dependence in Equation
[\[eqn:04\_opdrms\_bl\]](#eqn:04_opdrms_bl){reference-type="ref"
reference="eqn:04_opdrms_bl"}. The increase in slope of the
boundary-layer signal is also expected, and is caused by the increase in
the convection speed of the boundary-layer aero-optical disturbances as
the free-stream Mach number increases. The acoustic signal sees some
interesting evolution as well. Along with the strength greatly
increasing with Mach number, the slope of the upstream traveling
disturbances decreases significantly while the downstream moving
acoustic disturbances do not see much change other than an increase in
signal strength.

As the angle of the optical beam changes as it passes through the test
section the horizontal spatial frequency goes from measuring only the
axial component of the optical disturbance to measuring a combination of
the axial and span-wise component. This can be seen in Figure
[\[fig:04\_dispersion\_angle\]](#fig:04_dispersion_angle){reference-type="ref"
reference="fig:04_dispersion_angle"} with the same isosurface value as
shown in previous figures and at a Mach number of 0.5.

![Multidimensional spectral estimate isosurfaces of different viewing
angles through the test section at a Mach number of 0.5. The isosurfaces
are all shown at a power of $10^{-14}$
$\mu m^2/Hz/m^{-2}$.](../matlab/04_dispersion_analysis/dispersion_angle_90.eps "fig:")
![Multidimensional spectral estimate isosurfaces of different viewing
angles through the test section at a Mach number of 0.5. The isosurfaces
are all shown at a power of $10^{-14}$
$\mu m^2/Hz/m^{-2}$.](../matlab/04_dispersion_analysis/dispersion_angle_105.eps "fig:")
![Multidimensional spectral estimate isosurfaces of different viewing
angles through the test section at a Mach number of 0.5. The isosurfaces
are all shown at a power of $10^{-14}$
$\mu m^2/Hz/m^{-2}$.](../matlab/04_dispersion_analysis/dispersion_angle_120.eps "fig:")

[\[fig:04\_dispersion\_angle\]]{#fig:04_dispersion_angle
label="fig:04_dispersion_angle"}

The $90^\circ$ beam case at the top of Figure
[\[fig:04\_dispersion\_angle\]](#fig:04_dispersion_angle){reference-type="ref"
reference="fig:04_dispersion_angle"} has been shown previously and the
vertical component of the optical disturbance sees little change as the
viewing angle is increase except a small reduction in the boundary layer
signal and some additional signal at the high temporal frequencies in
the acoustic cone. As the angle is increased the side of the acoustic
cone traveling in the direction of flow is significantly increased in
power, with a large amount of the signal being aliased into the
upstream-traveling side appearing as 'stalactites' at odd angles. The
upstream-traveling acoustic signal is also increased in power but to a
lesser extent. The stationary mode pillar experiences some change as
well as the viewing angle hits $120^\circ$ and is stretched in the
horizontal direction.As the beam angle increases, the acoustic duct
modes begin to overlap one another in spectral space causing significant
constructive interference. This will be shown and discussed more fully
later in Section [4.4.3](#sect:04_acoustic_cone){reference-type="ref"
reference="sect:04_acoustic_cone"}. The effective velocity of the
optical disturbances is reduced for the disturbances traveling in the
same direction as the flow and increased for the disturbances traveling
in the opposite direction.

While these three-dimensional isosurfaces offer some significant insight
into the overall structure of the various optical disturbances they do
not fully show the spectral details. Plots of spatial vs temporal
frequencies for the horizontal and vertical plane waves were shown in
Figure
[\[fig:04\_dispersion\_xy\]](#fig:04_dispersion_xy){reference-type="ref"
reference="fig:04_dispersion_xy"} while Figure
[\[fig:04\_dispersion\_slices\]](#fig:04_dispersion_slices){reference-type="ref"
reference="fig:04_dispersion_slices"} shows slices at various temporal
frequencies.

![Multidimensional spectral estimate slices at various temporal
frequencies.](../matlab/04_dispersion_analysis/dispersion_slices.eps)

[\[fig:04\_dispersion\_slices\]]{#fig:04_dispersion_slices
label="fig:04_dispersion_slices"}

The temporal frequencies spectral slices shown are at: 0 Hz, the
blade-passing frequency at 517 Hz, the second harmonic of the
blade-passing frequency at 1551 Hz, and additional slices at 5, 10, and
20 kHz. The slice at 0 Hz temporal frequency shows the spatial
frequencies of the wavefront disturbance that does not change with time.
This temporally constant wavefront disturbance is typically called the
"mean lensing"component of the wavefront measurement, since it is has an
effect similar to a lens placed in the beam. The mean lensing slice at 0
Hz shows a mostly axisymmetric pattern with most of its power
concentrated at low spatial frequencies. There appear to be the
occasional spike radiating out from the center, most noticeably in line
with the boundary layer signal.

The next four slices, for $f$=517.1 Hz to 10 kHz, show a vertical line
associated with the boundary layers aero-optical disturbance, which
progressively moves towards positive x-spatial frequencies with
increasing frequency. The boundary-layer disturbance appears to be
rotated slightly counter-clockwise indicating that the interrogation
beam is slightly rotated between the test section and the wavefront
sensor. The boundary layer signals at the lower temporal frequencies
appear to have equal decay in both the positive and negative $\xi_x$
directions while at the higher frequencies, the decay is much more
gradual in the positive $\xi_x$ direction. This could be indicative of
the lower temporal frequency disturbances in the boundary layer
typically traveling at a more uniform speed very near the free-stream
velocity likely being either in the outer boundary layer or free-stream
tunnel turbulence. The higher temporal frequency disturbances seem to
have a much wider range of velocities that approach the free-stream
velocity and are likely small structures that reside in different parts
of the boundary layer and hence travel with a wide range of convection
velocities.

The acoustic disturbances show an interesting evolution as the temporal
frequency increases. At low temporal frequencies, the acoustic
disturbances are concentrated near zero spatial frequency and with
strong power. At high temporal frequencies the acoustic disturbances
appear as elliptically shaped rings. At 20 kHz, there are two elliptical
shapes that are easily identifiable, the smaller one is the signal that
is actually present at that frequency while the other one is aliased
data due to the limited temporal sample rate. There is constructive
interference where the two acoustic rings intersect. The 10 kHz slice
also shows a small amount of acoustic aliasing Both the 10 and 20 kHz
acoustic rings show some a non-uniform signal power throughout the
circumference which are also visible in the three-dimensional views as
the spikes at the high temporal frequencies.

### Acoustic Cone {#sect:04_acoustic_cone}

The shape of the acoustic cone can be visualized by plotting the
relationship between the temporal frequency and the vertical (i.e.
cross-stream) and axial (i.e. stream-wise) wavenumbers for a series of
acoustic duct modes . Figure
[\[fig:04\_dispersion\_sound\]](#fig:04_dispersion_sound){reference-type="ref"
reference="fig:04_dispersion_sound"} shows the acoustic cone mode lines
for a small set of duct modes at various Mach numbers for a duct that is
1 meter square and a beam passing through the duct at 90$^\circ$ to the
flow.

![Acoustic duct mode lines showing the spatial frequency location as a
function of temporal frequency, Mach number, and mode
number.](../matlab/04_dispersion_analysis/dispersion_sound.eps)

[\[fig:04\_dispersion\_sound\]]{#fig:04_dispersion_sound
label="fig:04_dispersion_sound"}

The lines here represent the solutions to Equation
[\[eqn:02\_kzm\]](#eqn:02_kzm){reference-type="ref"
reference="eqn:02_kzm"} for a series of cross-sectional acoustic modes;
essentially, these are $f-\xi_x$ planar "slices" of the cone-shaped
acoustic part of the spectrum, at various discrete values of $xi_y$. The
cross-sectional wavenumbers are $k_x = m\pi/l_x$ and $k_y = n\pi/l_y$
with the vertical spatial frequency, $\xi_y=\pm k_y/2\pi$. The
horizontal spatial frequency is related to the axial wavenumbers,
Equation [\[eqn:02\_kzm\]](#eqn:02_kzm){reference-type="ref"
reference="eqn:02_kzm"}, for sound traveling upstream or downstream.
Note that there is a 90$^\circ$ rotation between the duct and beam
coordinate systems (Equation
[\[eqn:03\_coord\_transform\]](#eqn:03_coord_transform){reference-type="ref"
reference="eqn:03_coord_transform"}).

The plot on the left of Figure
[\[fig:04\_dispersion\_sound\]](#fig:04_dispersion_sound){reference-type="ref"
reference="fig:04_dispersion_sound"} shows the acoustic cone when $m=0$
and $n\in [0,3]$ at Mach numbers of 0, 0.3, and 0.6. Only shown is the
positive vertical spatial frequency. As the vertical spatial frequency
of a duct-mode varies only with the mode number $n$ each set occupies a
distinct plane, $\xi_y=\pm n/2l_y$. Only acoustic cone modal lines
representing the cut-on duct modes are shown.

The plot on the right of Figure
[\[fig:04\_dispersion\_sound\]](#fig:04_dispersion_sound){reference-type="ref"
reference="fig:04_dispersion_sound"} shows the acoustic modal lines at
$\xi_y=0$ for $n=0$ which fill the inside of the acoustic cone. The Mach
number has a far greater impact on the acoustic cone for the waves
traveling upstream. As the Mach number increases, the cut-on frequency
(minimum value in $f$) decreases and the horizontal spatial frequency at
the cut-on frequency also decreases. This effect is more pronounced at
higher mode numbers. The phase velocity of a downstream-traveling
acoustic wave can travel upstream.

It may be possible to individually resolve the separate acoustic duct
modes using optical wavefronts if the spatial frequency resolution were
high enough. To measure of the vertical mode number, $n$, the spatial
frequency resolution would need to be $\Delta\xi_y\ge 1/2l_y$ for a
square duct. With a single beam going through the duct perpendicularly,
the axial wave number is directly measurable but its sensitivity is
diminished as the temporal frequency is increased. It would be most
sensitive to measuring modes that have just been cut-on.

When the optical beam is passing through a duct at an angle other than
$\gamma=90^\circ$ (parallel to the x-axis of the duct), it will measure
a combination of the axial wavenumber and the wavenumber along the
x-axis (assuming beam is rotating in the $x-z$ plane of the duct),
$$k^+_{hm} = k^+_{zm}\sin(\gamma)-k_x\cos(\gamma)$$ and
$$k^-_{hm} = -k^-_{zm}\sin(\gamma)+k_x\cos(\gamma) \textrm{.}$$ The
effective horizontal wavenumber, is related to the spatial frequency via
$\xi_x = k^\pm_{hm}/2\pi$. Figure
[\[fig:04\_dispersion\_sound\_angle\]](#fig:04_dispersion_sound_angle){reference-type="ref"
reference="fig:04_dispersion_sound_angle"} shows the acoustic duct mode
lines at Mach number of 0.6 over a range of beam angles.

![Acoustic duct mode lines as a function of viewing angle, $\gamma$, at
a Mach number of
0.6.](../matlab/04_dispersion_analysis/dispersion_sound_angle.eps)

[\[fig:04\_dispersion\_sound\_angle\]]{#fig:04_dispersion_sound_angle
label="fig:04_dispersion_sound_angle"}

As the beam angle is changed from $90^\circ$ the node lines for $m\neq0$
begin to be split at the cut-on frequency with the lines moving outward
along $\xi_x$ for angles greater than 90$^\circ$, while for angles less
than 90$^\circ$, the node lines cross and travel in the opposite
direction. This causes some of the node lines to begin to overlap near
the sonic lines causing constructive interference among the signals
which explains the increase in signal observed on the
downstream-traveling acoustic waves as the angle increased in Figure
[\[fig:04\_dispersion\_angle\]](#fig:04_dispersion_angle){reference-type="ref"
reference="fig:04_dispersion_angle"}. As the angle continues to either 0
or $180^\circ$ the beam is only capable of measuring $k_x$ and $k_y$
with the node lines being parallel to the temporal frequency axis and
starting at the cut-on frequency.

### Signal Aliasing

In the spectral slices shown in Figure
[\[fig:04\_dispersion\_xy\]](#fig:04_dispersion_xy){reference-type="ref"
reference="fig:04_dispersion_xy"}, when a signal crosses a plane
represented by one of the temporal or spatial Nyquist frequencies
(positive or negative) it is transposed to the conjugate Nyquist
frequency plane and continues on with the same gradient as before. This
behavior is illustrated in Figure
[\[fig:04\_dispersion\_tiling\]](#fig:04_dispersion_tiling){reference-type="ref"
reference="fig:04_dispersion_tiling"} by tiling the base (measured)
spectrum, which is shown as the slices of the horizontal moving
(stream-wise) disturbances.

![Spectrum tiling method to identify aliased data. Shown here as the
horizontal moving (stream-wise) disturbance slices, along with lines
representing the various characteristic velocities. The thick outline
shows the extent of the base spectrum with the thick dashed outlines
representing the various tiles of that base
spectrum.](../matlab/04_dispersion_analysis/dispersion_tiling.eps)

[\[fig:04\_dispersion\_tiling\]]{#fig:04_dispersion_tiling
label="fig:04_dispersion_tiling"}

The thick outline represents the base spectrum, while the thick dashed
outline represent the base spectrum in the tiled positions. The tiling
process for the spectral slices, $$S_{xx,T}^{\xi_y=0} = \left[
    \begin{array}{c c c}
      S_{xx}^{\xi_y=0} & S_{xx}^{\xi_y=0} & S_{xx}^{\xi_y=0} \\
      S_{xx}^{\xi_y=0} & S_{xx}^{\xi_y=0} & S_{xx}^{\xi_y=0} \\
      S_{xx}^{\xi_y=0} & S_{xx}^{\xi_y=0} & S_{xx}^{\xi_y=0}
    \end{array}
  \right] \textrm{,}$$ where $S_{xx}^{\xi_y=0}$ is the base spectral
slice showing the horizontal moving disturbances at $\xi_y=0$ and
$S_{xx,T}^{\xi_y=0}$ is the tiled variant. The temporal frequency is
tiled, $$\left. f\right|_{tiled} = \left[
    \begin{array}{c c c}
      f-f_s & f & f+f_s
    \end{array}
  \right] \textrm{,}$$ where the other frequencies are similarly tiled.
This tiling process works because the negative half ($f<0$) of the
spectrum is a duplication of the positive half ($f\ge0$) of the
spectrum. In this research, the spectrum is typically only shown for
positive temporal frequencies. The spectral power at any point in
frequency space ($\pm f,\pm\xi_x,\pm\xi_y$) will be equal to the
conjugate of that point ($\mp f,\mp\xi_x,\mp\xi_y$). This tiling process
could be used on the full multidimensional spectrum with the tiling
occurring on each axis. While only a three-by-three tiling process was
shown, the tiling process in theory needs to be extended to infinity but
in practice, with real signals being bandwidth limited, only a finite
number of tiles are required. This process has the effect of
artificially increasing the sampling rate [@Lynch-2021-DygYkEGU],
especially for spectra that are primarily two-dimensional with
structures traveling in only one direction (i.e. supersonic
boundary-layers).

Figure
[\[fig:04\_dispersion\_supersample\]](#fig:04_dispersion_supersample){reference-type="ref"
reference="fig:04_dispersion_supersample"} shows a zoomed in portion of
the Figure
[\[fig:04\_dispersion\_tiling\]](#fig:04_dispersion_tiling){reference-type="ref"
reference="fig:04_dispersion_tiling"}.

![Artificially increased temporal sample rate using a dispersion
analysis. The black box represents original dispersion
plot.](../matlab/04_dispersion_analysis/dispersion_supersample.eps)

[\[fig:04\_dispersion\_supersample\]]{#fig:04_dispersion_supersample
label="fig:04_dispersion_supersample"}

The black box again represents the base spectrum along with lines
representing the free-stream velocity and the sonic lines. When these
characteristic lines are extended past the original sample rate, aliased
information becomes more apparent. On the upstream moving disturbance
side there is some noticeable aliasing that is present including a
significant spike at 18 kHz (-80 $m^{-1}$) while aliased and about 31
kHz (-200 $m^{-1}$) when it has been unaliased. As that upstream moving
acoustic disturbance crosses the spatial Nyquist frequency, the signal
strength drops significantly to local background levels. The boundary
layer signal is unfortunately to well aligned with its tiled self for
any aliased data to be noticeable. The vertically moving disturbances
have some significant temporal aliasing but little to no spatial
aliasing.

There maybe some circumstances when aliased data cannot even be
identified, such is likely the case for the boundary layer signal shown
in the horizontal moving disturbances plot because the signal is
directly inline with its aliased self. This may also cause an issue when
trying to analyze the original spectrum, particularly at the higher
frequencies where the aliased data is sufficiently strong and
overlapping the true signal. To avoid this the sample rate velocity,
$$V_s=f/\xi \textrm{,}$$ should sufficiently different enough from the
disturbance's characteristic velocity. This difference will vary for the
depending on the spectral width of the signal. The sample rate velocity
of the spectrum in Figure
[\[fig:04\_dispersion\_supersample\]](#fig:04_dispersion_supersample){reference-type="ref"
reference="fig:04_dispersion_supersample"} is 176.4 m/s, the free-stream
velocity is 174.3 m/s and the boundary layer has a significant spectral
with to the signal such that it would be difficult to separate the real
and aliased signals. The upstream-traveling acoustic wave however is a
fairly thin signal that is distinguishable from the aliased signal and
it has a characteristic velocity of -173.0 m/s.

Figure
[\[fig:04\_dispersion\_3d\_tile\]](#fig:04_dispersion_3d_tile){reference-type="ref"
reference="fig:04_dispersion_3d_tile"} shows a portion of the spectrum
that has been tiled three-dimensionally.

![Three-dimensional tiling of an isosurface of the spectrum at a power
of $10^{-14.5}$
$\mu m^2/Hz/m^{-2}$.](../matlab/04_dispersion_analysis/dispersion_3d_tile.eps)

[\[fig:04\_dispersion\_3d\_tile\]]{#fig:04_dispersion_3d_tile
label="fig:04_dispersion_3d_tile"}

The power level of the isosurface in this plot is different from those
previously shown ($10^{-14.5}$ $\mu m^2/Hz/m^{-2}$). The level for the
previous isosurface plots was chosen because it showed minimal signal
aliasing. In Figure
[\[fig:04\_dispersion\_3d\_tile\]](#fig:04_dispersion_3d_tile){reference-type="ref"
reference="fig:04_dispersion_3d_tile"} the base spectrum is colored in
blue and the tiled portion is shown in red. This plot shows only the
portion of the spectrum between 40 and 60% of the temporal sample rate.
The acoustic cone is the primary structure in this plot that can be seen
to having aliasing present. The 'stalactites' that became apparent at
higher beam angles are also apparent at this power level and are a
continuation from the tiled spectrum above. With spectra that have
significant three-dimensional content, this process is most useful for
identifying portions of the signal that are aliased. There is future
work that can be done in both filtering the aliased data and
artificially increasing the sample rate of the wavefront measurement.

Summary {#summary}
-------

The use of multidimensional spectral estimation on optical wavefronts
can provide significant additional insight to the various components
that are being measured, including the desired aero-optical signal but
also various forms of noise including sound and vibration. The process
of filtering these multidimensional spectra will be discussed in
Chapters [6](#chap:06_single_filter){reference-type="ref"
reference="chap:06_single_filter"} and
[7](#chap:07_multiple_filter){reference-type="ref"
reference="chap:07_multiple_filter"}.

Synthetic Wavefront {#chap:05_synthetic}
===================

In the preceding chapter, the way that wavefront data appears in
multidimensional spectra was shown using data acquired in Notre Dame's
White Field wind tunnel, for a representative wind-tunnel aero-optical
test setup shown in Figure
[\[fig:02\_typical\_wavefront\_system\]](#fig:02_typical_wavefront_system){reference-type="ref"
reference="fig:02_typical_wavefront_system"}. The spectra and
accompanying discussion showed how individual sources of optical
aberration can be identified in the spectra, such as boundary-layer
aero-optical signals, acoustic noise sources, mechanical vibration, etc.
In following chapters of this dissertation, filtering techniques will be
presented for extracting or removing signals or noise sources from
wavefront data such as shown in Chapter
[3](#chap:03_optical_acoustics){reference-type="ref"
reference="chap:03_optical_acoustics"}. As a first step towards this
objective of developing and examining filtering approaches, this chapter
presents methods used to construct a "synthetic" wavefront that contains
typical optical and aero-optical signals, which will be used to test and
examine different filtering techniques described in Chapter
[6](#chap:06_single_filter){reference-type="ref"
reference="chap:06_single_filter"}.

In order to best understand how some basic filters perform on a set of
data, a fully known synthetic wavefront was generated such that all of
the various components could be generated separately with the combined
product filtered and compared to the synthetic wavefront containing only
relevant aero-optical data. This was done by constructing a
multidimensional spectrum where each source component was separately
generated with parameters that can be modified to alter the output
signal as necessary. The resulting multidimensional spectrum could then
be used to create the equivalent spatial- and temporally-resolved
wavefront signal in the physical domain by inverse Fourier transforming
the spectrum.

This synthetic wavefront generation technique produces a qualitative
representation that closely matches the measured wavefront but leaves
room for improvement in producing a more physically accurate synthetic
wavefront. It should be stressed that, although physical models for the
spectral behavior are presented for some of the signal components, the
shape of the spectrum for each signal component was largely constructed
to qualitatively match details observed in the spectra for experimental
data such as shown in Chapter
[3](#chap:03_optical_acoustics){reference-type="ref"
reference="chap:03_optical_acoustics"}. This qualitative character to
the constructed spectrum for some components should not influence the
ability to use the synthesized spectral and wavefront data for
examination of filtering approaches, since the constructed data still
have the important behaviors exhibited by measured data.

The synthetic wavefront was generated to approximate the same sampling
conditions used to acquire the data first presented in Section
[3.4](#sect:03_summary){reference-type="ref"
reference="sect:03_summary"}; these sampling conditions are reasonably
typical for Shack-Hartmann wavefront measurements at the time of
writing. The sample rate was 200 m$^{-1}$ (i.e. 200 lenslets/m
equivalent in the measurement beam) with 64 ($2^6$) samples in the
spatial dimensions and 30,000 Hz with 8192 ($2^{13}$) samples in the
temporal dimension. Figure
[\[fig:05\_dispersion\_comp\_real\]](#fig:05_dispersion_comp_real){reference-type="ref"
reference="fig:05_dispersion_comp_real"} shows the multidimensional
spectra estimation of the measured wavefront that was used for the
model.

![Multidimensional spectral estimation that the synthetic wavefront is
based on.](../matlab/05_synthetic_wavefront/dispersion_comp_real.eps)

[\[fig:05\_dispersion\_comp\_real\]]{#fig:05_dispersion_comp_real
label="fig:05_dispersion_comp_real"}

The optical wavefront was measured in the University of Notre Dame
Whitefield wind tunnel at a Mach number of 0.6 with a 10-inch diameter
beam. The beam angle through the test section was $90^\circ$.

The signals that were assumed to be statistically independent from one
another, such as the boundary layer signal, were converted into
dimensional space separately and then summed together, while signals
that were assumed to be related to one another, such as the sound and
vibration components, were first summed together in frequency space.
Figure
[\[fig:05\_synthetic\_dispersion\_input\]](#fig:05_synthetic_dispersion_input){reference-type="ref"
reference="fig:05_synthetic_dispersion_input"} shows the input
dispersion plot with each signal component separately colored.

![Synthetic wavefront input dispersion plot of an aero-optical signal
and various signal corruption components. The aero-optical signal is
shown in red, the stationary modes in blue, duct acoustics in magenta,
blade-passing frequency related corruption in green, slowly varying
mean-lensing in yellow, and background in
cyan.](../matlab/05_synthetic_wavefront/synthetic_wavefront.eps)

[\[fig:05\_synthetic\_dispersion\_input\]]{#fig:05_synthetic_dispersion_input
label="fig:05_synthetic_dispersion_input"}

The aero-optical signal is shown in red, the stationary modes in blue,
duct acoustics in magenta, blade-passing frequency related noise in
green, slowly varying mean-lensing in yellow, and background noise in
cyan.

General Spectrum Construction
-----------------------------

The general process of developing most of the component signals was to
determine an approximate shape, normalize it in the appropriate
dimensions, and scale the result by using a function derived from a
hyperbola,
$$\frac{\log_{10}(WF)-b}{b^2}-\frac{\xi_{\rho_N}^2}{a^2} = 1 \textrm{,}
 \label{eqn:05_scaling_hyperbola}$$ such that the signal strength at
unity of the normalized radial frequency,
$\log_{10}(WF(\xi_{\rho_N}=1))$, and the limiting slope, $a/b$, are
inputs. This results in the signal strength of the wavefront being
$$\log_{10}(WF) = b-\sqrt{\frac{\xi_{\rho_N}^2}{m^2}+b^2} \textrm{,}
 \label{eqn:05_wavefront_strength}$$ where
$$b = \frac{1}{2\log_{10}(WF(\xi_{\rho_N}=1))}\cdot\left(\log_{10}(WF(\xi_{\rho_N}=1))^2-\frac{1}{m^2}\right) \textrm{.}
 \label{eqn:05_wavefront_strength_b}$$

Aero-Optical Signal
-------------------

The aero-optical signal was generated to approximate an optical beam
passing perpendicularly through a test section with boundary layers on
each of the test section walls. An ellipsoid was chosen to approximate
the boundary-layer signal because it is the simplest shape that best
resembles the aero-optical signal in Figure
[\[fig:05\_dispersion\_comp\_real\]](#fig:05_dispersion_comp_real){reference-type="ref"
reference="fig:05_dispersion_comp_real"}. This signal was approximated
by creating an ellipsoid,
$$\xi_{\rho_N}^2 = (\xi_{x,R}/a_x)^2+(\xi_{y,R}/a_y)^2+(f_R/a_t)^2$$
which had been rotated into the plane representing the boundary-layer's
dispersion velocity,
$$\left[\begin{array}{c} \xi_{x,R} \\ \xi_{y,R} \\ f_R \end{array}\right] = \left[\begin{array}{c c c} \cos\theta_u & 0 & \sin\theta_u \\ 0 & 1 & 0 \\ -\sin\theta_u & 0 & \cos\theta_u \end{array}\right]\left[\begin{array}{c} \xi_{x} \\ \xi_{y} \\ f \end{array}\right]$$
where $\theta_u=\tan^{-1}(-1/u_{BL})$. Equations
[\[eqn:05\_wavefront\_strength\]](#eqn:05_wavefront_strength){reference-type="ref"
reference="eqn:05_wavefront_strength"} and
[\[eqn:05\_wavefront\_strength\_b\]](#eqn:05_wavefront_strength_b){reference-type="ref"
reference="eqn:05_wavefront_strength_b"} were then used to calculate the
multidimensional spectrum of the boundary layer signal. The values used
are shown in Table
[\[tab:05\_boundary\_layer\]](#tab:05_boundary_layer){reference-type="ref"
reference="tab:05_boundary_layer"}. In Figure
[\[fig:05\_synthetic\_dispersion\_input\]](#fig:05_synthetic_dispersion_input){reference-type="ref"
reference="fig:05_synthetic_dispersion_input"} the aero-optical signal
is shown in red.

              Variable                 Value
  --------------------------------- -----------
                $a_x$                    8
                $a_y$                   90
                $a_t$                   175
                 $m$                   -0.13
              $u_{BL}$               163.2 m/s
   $\log_{10}(WF(\xi_{\rho_N}=1))$     -14.5

  : Values used in the construction of the multidimensional spectrum for
  the boundary layer signal

[\[tab:05\_boundary\_layer\]]{#tab:05_boundary_layer
label="tab:05_boundary_layer"}

Stationary Mode Signals
-----------------------

The collection of stationary modes is a temporally constant signal at
low spatial frequencies that is often has a cross-section in the plane
of spatial-frequencies that is circular. In the particular case that is
being modeled, the stationary modes have a cross-section of two circular
regions offset along the $\xi_x$-axis that just overlap one another. A
smooth function was chosen to approximate this overlapping circle type
stationary mode,
$$\xi_{\rho_N} = \frac{\xi_\rho}{\xi_{\rho_0}\sqrt{10-6\cos{(2\xi_\theta+\pi)}}} \textrm{.}
 \label{eqn:05_epicycloid_simple}$$ This spectrum for the stationary
modes component is shown in blue in Figure
[\[fig:05\_synthetic\_dispersion\_input\]](#fig:05_synthetic_dispersion_input){reference-type="ref"
reference="fig:05_synthetic_dispersion_input"}. Table
[\[tab:05\_stationary\_modes\]](#tab:05_stationary_modes){reference-type="ref"
reference="tab:05_stationary_modes"} shows the values used in generating
the spectrum.

              Variable               Value
  --------------------------------- --------
                 $m$                 -0.175
           $\xi_{\rho_0}$              5
   $\log_{10}(WF(\xi_{\rho_N}=1))$   -14.5

  : Values used in the construction of the multidimensional spectrum for
  the signal of the stationary modes

[\[tab:05\_stationary\_modes\]]{#tab:05_stationary_modes
label="tab:05_stationary_modes"}

Sound and Vibration Signals
---------------------------

The sound and vibrating component signals are comprised of two parts.
The first of these is the blade-passing frequency and its harmonic
disturbances (shown in green in Figure
[\[fig:05\_synthetic\_dispersion\_input\]](#fig:05_synthetic_dispersion_input){reference-type="ref"
reference="fig:05_synthetic_dispersion_input"}) and the second is the
acoustic duct modes (shown in magenta).

### Blade-Passing Frequency Disturbance

Like the stationary modes, the blade-passing frequency disturbances were
modeled with the same cross-sectional shape as the stationary mode,
Equation
[\[eqn:05\_epicycloid\_simple\]](#eqn:05_epicycloid_simple){reference-type="ref"
reference="eqn:05_epicycloid_simple"}, but as narrow-band discs,
$$\xi_{\rho_N}^2 = \frac{\sqrt{\xi_x^2+(AR\xi_y)^2}}{\xi_{\rho,BPF}\sqrt{10-6\cos(2\xi_\theta+\pi)}}+\left(\frac{f\pm BPF n}{f_T}\right)^2
  \label{eqn:05_blade_passing_frequency}$$ where $AR$ is the aspect
ratio of the cross-sectional shape, $n$ is the harmonic number, $f_T$ is
the disc thickness, and $\xi_{rho,BPF}$ is
$$\xi_{rho,BPF} = \frac{\xi_{\rho_0}}{\sqrt{1+\frac{BPF n-BPF}{f_c}}}$$
where $f_c$ is the effectively cutoff frequency for modulating the
strength of each disc as the harmonic number increased from $n=0.5$ to
$n=5$ in steps of 0.5. A list of values is shown in Table
[\[tab:05\_bpf\]](#tab:05_bpf){reference-type="ref"
reference="tab:05_bpf"}.

              Variable               Value
  --------------------------------- --------
                $AR$                   1
                $BPF$                500 Hz
                $f_c$                500 Hz
                $f_T$                100 Hz
                 $m$                 -0.13
           $\xi_{\rho_0}$              20
   $\log_{10}(WF(\xi_{\rho_N}=1))$    -14

  : Values used in the construction of the multidimensional spectrum for
  the blade-passing frequency disturbance

[\[tab:05\_bpf\]]{#tab:05_bpf label="tab:05_bpf"}

### Acoustic Cone {#acoustic-cone}

The acoustic duct mode disturbances form a cone which in the $f-\xi_x$
plane is defined by the lines $u\pm c$, while in the $f-\xi_y$ plane is
defined by the speed of sound. At each temporal frequency step an
ellipse was defined based on the constraining lines and the distance to
that ellipse used to calculate a normalized radial frequency,
$$\xi_{\rho_N}^2 = \frac{\sqrt{(\xi_x-\xi_{x_0})^2+(\xi_y-\xi_{y_0})^2}}{\sqrt{\xi^2_{x_a}\cos^2\xi_\theta+\xi^2_{y_a}\sin^2\xi_\theta-1}} \frac{\sqrt{\xi^2_{x_a}\cos^2\xi_\theta+\xi^2_{y_a}\sin^2\xi_\theta}}{\xi_{\rho_T}} \textrm{,}$$
where $\xi_{x_0}$ and $\xi_{y_0}$ are the midpoint between the sonic
lines in the x and y directions as a function of $f$, $\xi_{x_a}$ and
$\xi_{y_a}$ are the distances from the midpoint to the sonic lines as a
function of $f$, and $\xi_{\rho_T}$ is the thickness of the ellipse. The
strength of the disturbance was decreased logarithmically as a function
of $|f|$ from $f=0$ to $f=f_s/2$ with Equation
[\[eqn:05\_wavefront\_strength\_b\]](#eqn:05_wavefront_strength_b){reference-type="ref"
reference="eqn:05_wavefront_strength_b"} becoming,
$$b(f) = \frac{1}{2b_0(f)}\left(b_0^2(f)-\frac{1}{m^2}\right) \textrm{,}$$
where $$\begin{aligned}
    b_0(f) =& \frac{\log_{10}(WF(\xi_{\rho_N}=1,f=f_s/2))-\log_{10}(WF(\xi_{\rho_N}=1,f=0))}{f_s/2}|f| \\ &+\log_{10}(WF(\xi_{\rho_N}=1,f=f_0)) \textrm{.}
  \end{aligned}$$

Two low-pass spatial filters (more discussion in Chapter
[6](#chap:06_single_filter){reference-type="ref"
reference="chap:06_single_filter"}) were used to replicate some of the
signal attenuation that happens at the low spatial frequencies in the
x-direction. First a low-pass filter in $\rho$ was used,
$$WF = WF\sqrt{\frac{1}{1+\left(\frac{\xi_\rho}{\xi_{c_\rho}}\right)^2}} \textrm{,}$$
followed by a low-pass filter in the x-direction,
$$WF = WF\sqrt{\frac{1}{1+\left(\frac{\xi_x}{\xi_{c_x}}\right)^2}} \textrm{.}$$
The values used in creating the spectrum are shown in Table
[\[tab:05\_cone\]](#tab:05_cone){reference-type="ref"
reference="tab:05_cone"}.

                  Variable                      Value
  ----------------------------------------- --------------
                     $m$                         -0.3
                 $\xi_{c_x}$                 115 m$^{-1}$
               $\xi_{c_\rho}$                200 m$^{-1}$
               $\xi_{\rho_T}$                 8 m$^{-1}$
     $\log_{10}(WF(\xi_{\rho_N}=1,f=0))$         -13
   $\log_{10}(WF(\xi_{\rho_N}=1,f=f_s/2))$       -16

  : Values used in the construction of the multidimensional spectrum for
  the acoustic cone disturbance

[\[tab:05\_cone\]]{#tab:05_cone label="tab:05_cone"}

Mean-Lensing Signal
-------------------

The mean lensing part of the optical signal is the integrated effect of
steady optical aberrations added by lenses, mirror, windows, etc, in the
beam path. The aberrations are effectively random and a physical model
cannot be developed for them. The mean-lensing signal (shown in yellow
in Figure
[\[fig:05\_synthetic\_dispersion\_input\]](#fig:05_synthetic_dispersion_input){reference-type="ref"
reference="fig:05_synthetic_dispersion_input"}) uses same
cross-sectional as the blade-passing frequency disturbances and
represents the slowly varying spatial disturbance,
$$\xi_{\rho_N}^2 = \frac{\sqrt{\xi_x^2+(AR\xi_y)^2}}{\xi_{\rho_0}\sqrt{10-6\cos(2\xi_\theta+\pi)}}+\left(\frac{f}{f_T}\right)^2 \textrm{.}
  \label{eqn:05_mean_lensing}$$ Table
[\[tab:05\_mean\_lensing\]](#tab:05_mean_lensing){reference-type="ref"
reference="tab:05_mean_lensing"} shows a list of the values used in
creating this component of the wavefront signal.

              Variable               Value
  --------------------------------- -------
                $AR$                 0.55
                $f_T$                50 Hz
                 $m$                 -0.5
           $\xi_{\rho_0}$             25
   $\log_{10}(WF(\xi_{\rho_N}=1))$   -14.5

  : Values used in the construction of the multidimensional spectrum for
  the mean-lensing disturbance

[\[tab:05\_mean\_lensing\]]{#tab:05_mean_lensing
label="tab:05_mean_lensing"}

Background Noise Signal
-----------------------

Background noise in the wavefront data originates from sources which are
random in nature. The background noise disturbance (with a few small
spots shown in cyan in Figure
[\[fig:05\_synthetic\_dispersion\_input\]](#fig:05_synthetic_dispersion_input){reference-type="ref"
reference="fig:05_synthetic_dispersion_input"}) was simulated using
normally distributed random noise with a mean noise level,
$\mu(\log_{10}(WF))=-18$, and deviation, $\sigma(\log_{10}(WF))=0.75$.

Synthetic Wavefront Creation
----------------------------

A synthetic signal can be created from a power spectrum by solving for
$x$ in Equation
[\[eqn:04\_basic\_sxx\]](#eqn:04_basic_sxx){reference-type="ref"
reference="eqn:04_basic_sxx"} and using the Inverse Fast Fourier
Transform,
$$x(t) = \real\left[\ifft\left\{\sqrt{S_{xx}\cdot N\cdot f_{samp}}\cdot\exp{i\phi}\right\}\right] \textrm{,}
 \label{eqn:05_ifft}$$ where $\real$ is the real component and $\phi$ is
a random set of phases for each point in the measurement space. As shown
previously this relation can be extended into $n$-dimensions,
$$f(\mathbf{x}) = \real\left[\ifftn\left\{\sqrt{\mathbf{S_{xx}}\cdot\prod{\overrightarrow{N}\cdot \overrightarrow{f}_{samp}}}\cdot\exp{i\mathbf{\phi}}\right\}\right] \textrm{.}
 \label{eqn:05_ifftn}$$ Care should be taken when constructing the
random set of phases, as the zero-frequency component has zero phase,
$\phi(0,0,0) = 0$, and the phases on either side of it are conjugates of
one another,
$\phi(\pm\xi_x,\pm\xi_y,\pm f)=-\phi(\mp\xi_x,\mp\xi_y,\mp f)$.

It was assumed that the aero-optical signal, the stationary modes, the
background noise, and the sound and vibration combination of modes were
statistically independent of one another and, as such, could be
separately transformed into physical space. The components of the sound
and vibration sources, the blade-passing frequency, the acoustic cone,
and the mean-lensing, were assumed to be related to one another and thus
were summed together in frequency space prior to being transformed into
physical space. Once the separate components were in physical space the
total wavefront was obtained by summing up the separate components with
the aero-optical signal saved along side the total wavefront. Some
frames from the synthetic wavefront are shown in Figure
[\[fig:05\_synthetic\_frames\]](#fig:05_synthetic_frames){reference-type="ref"
reference="fig:05_synthetic_frames"} with the total wavefront shown on
top and the aero-optical only signal shown on the bottom.

![Sample frames from the synthetic wavefront with the total wavefront
signal on top and the aero-optical only signal bottom. Flow is from
right to
left.](../matlab/05_synthetic_wavefront/synthetic_frames_total.eps "fig:")
![Sample frames from the synthetic wavefront with the total wavefront
signal on top and the aero-optical only signal bottom. Flow is from
right to
left.](../matlab/05_synthetic_wavefront/synthetic_frames_ao.eps "fig:")

[\[fig:05\_synthetic\_frames\]]{#fig:05_synthetic_frames
label="fig:05_synthetic_frames"}

Flow is from right to left. The aero-optical signal is noticeable to
some degree in the total wavefront signal, but can be overpowered by the
various noise sources.

Comparison to Measured Data
---------------------------

A multidimensional spectral plot of the total synthetic wavefront is
shown in Figure
[\[fig:dispersion\_comp\_synthetic\]](#fig:dispersion_comp_synthetic){reference-type="ref"
reference="fig:dispersion_comp_synthetic"}.

![Synthetic wavefront output dispersion plot of an aero-optical signal
and various signal corruption
components.](../matlab/05_synthetic_wavefront/dispersion_comp_synthetic.eps)

[\[fig:dispersion\_comp\_synthetic\]]{#fig:dispersion_comp_synthetic
label="fig:dispersion_comp_synthetic"}

In this view the aero-optical signal is more noticeable but there still
remains some significant overlap with the various noise sources. While
the mean-lensing component is not as visible in this isosurface, the
rest of the dispersion plot in a good representation of the input
dispersion plot shown in Figure
[\[fig:05\_synthetic\_dispersion\_input\]](#fig:05_synthetic_dispersion_input){reference-type="ref"
reference="fig:05_synthetic_dispersion_input"}. The blade-passing
frequency was depicted as symmetric in the synthetic wavefront while
measured data (shown in Figure
[\[fig:04\_dispersion\_3d\]](#fig:04_dispersion_3d){reference-type="ref"
reference="fig:04_dispersion_3d"}) shows more signal on the side
traveling in the direction of flow. The harmonics of the BPF are more on
the upstream traveling side of the dispersion and are a little less
pronounced in the measured data. The total synthetic wavefront has a
$\opdrms$ of $0.0112\pm0.0006\mu m$ with the aero-optical only signal
having a $\opdrms$ of $0.0073\pm0.0003\mu m$. The measured wavefront
presented in Figure
[\[fig:04\_dispersion\_3d\]](#fig:04_dispersion_3d){reference-type="ref"
reference="fig:04_dispersion_3d"} had a $\opdrms$ of
$0.0874\pm0.0263\mu m$. The overall $\opdrms$ of the synthetic wavefront
was $12.8\%$ when compared to the measured wavefront indicating that the
algorithms used to generate the wavefront are not representative of
reality and can provide a future path of research in order to produce
more realistic synthetic wavefronts.

Wavefront Multidimensional Spectral Filtering Techniques {#chap:06_single_filter}
========================================================

This chapter will examine a variety of filtering techniques used on
multidimensional spectra of optical wavefronts. While none of the
filters presented here are novel, many are based on well known digital
filters, their application to filtering optical wavefronts is something
that needs to be studied. This chapter will start out by examining some
filters that are applied to just the wavefront data itself and will then
examine a filtering technique that incorporates additional sensors data
in the filtering process.

By using multidimensional spectral estimates on wavefronts, as shown in
Chapter [4](#chap:04_dispersion){reference-type="ref"
reference="chap:04_dispersion"}, differences in source disturbances
become clearly evident. When just the wavefront measurement itself is
available, digital filters can be used to separate or isolate a single
disturbance source or at least minimize the impact from other sources.
The digital filters used in this dissertation, use a transfer function,
$H(j\omega)$, and are applied in Fourier space. The transfer functions
themselves are typically derived in Laplace space, $H(s)$, but because
$s=j\omega$ they are valid in Fourier space as well
[@Hamming-1998-CdhcDuvZ]. The transfer function is composed of two
components which attenuate the signal, gain and phase. The filter gain
is the magnitude of the transfer function, $G(\omega) = |H(j\omega)|$,
while the filter phase is the argument,
$\Phi(\omega) = \arg(H(j\omega))$. In the simplest case, the filtered
signal is the inverse Fourier transform of the gain multiplied by the
Fourier transform of the signal,
$$f_F(\mathbf{x}) = \real\left(\ifftn[H(j\mathbf{\omega})\fftn\{\mathbf{x}\}]\right) \textrm{,}
 \label{eqn:06_filter_function}$$ where $f$ is the signal function and
$f_F$ is the filtered signal.

Temporal Filter Methods
-----------------------

The methods presented in this section are based on Butterworth filters
but could be extended to other types of filters. The square of the
transfer function of a Butterworth filter is
[@Butterworth-1930-DvDrjKha],
$$|H(j\omega)|^2 = G^2(\omega) = \frac{G_0^2}{1+\left(\frac{j\omega}{j\omega_c}\right)^{\pm2n}} \textrm{,}
 \label{eqn:06_butterworth}$$ where $G_0$ is the zero-frequency gain,
$\omega_c$ is the cutoff angular frequency, $n$ is the filter order
(number of filters in a series), and $\pm$ represents either a low-pass
($+$) or high-pass ($-$) filter. The gain of this filter is
$$G(\omega) = \frac{G_0}{\sqrt{1+\left(\frac{\omega}{\omega_c}\right)^{\pm2n}}} \textrm{.}
  \label{eqn:06_butterworth_gain}$$ A band-pass filter can be
constructed by placing a low-pass filter in series with a high-pass
filter and a band-stop by placing the two types in parallel.

In many tests, a large portion of the wavefront noise is at low
frequencies primarily caused by mechanical vibration. In general, a
high-pass filter is useful in temporal space for removing this noise,
since in many cases most of the power in the aero-optical signal occurs
at higher frequency than the low-frequency mechanical vibration. as
shown in Figure
[\[fig:06\_filter\_temporal\]](#fig:06_filter_temporal){reference-type="ref"
reference="fig:06_filter_temporal"}.

![The $opdrms$ of high-pass temporal filtered wavefronts relative to the
$opdrms$ of the aero-optical only unfiltered wavefront (top). Power
spectra of both of the simulated wavefront versions
(bottom).](../matlab/06_single_sensor_filtering/filter_temporal.eps)

[\[fig:06\_filter\_temporal\]]{#fig:06_filter_temporal
label="fig:06_filter_temporal"}

The top plot in this figure shows the high-pass filtered $\opdrms$ of
both the total and aero-optical only wavefronts normalized by the
unfiltered $\opdrms$ of the aero-optical only wavefront, for high-pass
filters with various cutoff frequencies. The results in Figure
[\[fig:06\_filter\_temporal\]](#fig:06_filter_temporal){reference-type="ref"
reference="fig:06_filter_temporal"} were computed using wavefronts that
were simulated using the methods described in Chapter
[5](#chap:05_synthetic){reference-type="ref"
reference="chap:05_synthetic"}. For reference, the bottom plot of Figure
[\[fig:06\_filter\_temporal\]](#fig:06_filter_temporal){reference-type="ref"
reference="fig:06_filter_temporal"} shows the power spectra of just the
aero-optical portion of the wavefront (red curve) and the total
wavefront (blue curve) which includes vibration-related peaks associated
with the blade-passing frequency and its harmonics. The figure shows how
a high-pass filter decreases the energy in the total wavefront and in
the actual aero-optical wavefront, as the filter cutoff frequency
increases. As shown in the top plot, at low cutoff frequency, the filter
primarily removes vibration effects from the total signal; however, as
the cutoff frequency increases, the filter also removes actual
aero-optical signal. At around 1200 Hz, the $\opdrms$ of the total
signal is equal to the $\opdrms$ of the actual aero-optical signal; at
this cutoff frequency  75% of the aero-optical signal remains and the
remaining signal is made up by the remaining contamination. This
approach can provide a computationally inexpensive way of estimating the
aero-optical portion of the wavefront for calculations that rely on the
$\opdrms$ of a wavefront. While it is more straightforward to determine
a cutoff frequency for this synthetic wavefront since all of the signal
components are fully known, a measured wavefront will likely take some
knowledge or expectation of the contamination that is present in the
measurement in order to select a high-pass filter cutoff frequency.

An example of wavefronts that result from band-pass and band-stop
filtering is shown in Figure
[\[fig:06\_filter\_temporal\_bandpass\]](#fig:06_filter_temporal_bandpass){reference-type="ref"
reference="fig:06_filter_temporal_bandpass"}.

![Measured wavefronts filtered at the blade-passing frequency
(532$\pm$10 Hz). The left column is band-stop filtered while the right
is band-pass
filtered.](../matlab/06_single_sensor_filtering/filter_temporal_bandpass.eps)

[\[fig:06\_filter\_temporal\_bandpass\]]{#fig:06_filter_temporal_bandpass
label="fig:06_filter_temporal_bandpass"}

The figure shows several wavefront frames of measured data acquired in
the Notre Dame White Field wind tunnel and presented previously in
Chapter [3](#chap:03_optical_acoustics){reference-type="ref"
reference="chap:03_optical_acoustics"} (see Figure
[\[fig:03\_tunnel\_comparison\]](#fig:03_tunnel_comparison){reference-type="ref"
reference="fig:03_tunnel_comparison"}) that are band-stop filtered in
the left column and band-pass filtered in the right column. The flow is
from right-to-left and the band-pass filtered wavefront clearly shows
upstream-moving optical disturbances (moving left-to-right against the
flow direction) associated with acoustic duct modes traveling upstream
from the fan. On the other hand, the band-stop filtered wavefronts on
the left of Figure
[\[fig:06\_filter\_temporal\_bandpass\]](#fig:06_filter_temporal_bandpass){reference-type="ref"
reference="fig:06_filter_temporal_bandpass"} show much slower-moving
optical disturbances that are in general moving in the direction of the
flow. In particular, the downstream-moving disturbances on the left side
of Figure
[\[fig:06\_filter\_temporal\_bandpass\]](#fig:06_filter_temporal_bandpass){reference-type="ref"
reference="fig:06_filter_temporal_bandpass"} have the appearance of
boundary-layer aero-optical disturbances, with a scale on the order of
the boundary-layer thickness.

Note that for filters that operate in one dimension, the filters were
applied over both positive and negative frequencies to the n-dimensional
Fourier transform in order to preserve the direction of travel of the
signal. This also allowed several filters to be applied in series
without having to perform a Fourier and inverse Fourier transform for
each successive filter. Temporal filters are also used in sizing and/or
designing adaptive optics systems [@Greenwood-1977-aWDqUh6C] for
example. A low-pass filter with a cutoff at the bandwidth of either a
fast-steering or deformable mirror is often used to define the signal
that the system needs to reject [@Whiteley-2007-bHbWRWUu]. A control
system may need to have the bandwidth reduced in order to keep a
mirror's travel within limits [@Madec-2012-YJ8eWhPB], while a high-pass
filter would inform designers of the remaining optical aberrations that
cannot be corrected.

Upstream/Downstream Moving {#chap:06_up_down_filter}
--------------------------

In the preceding section, filters based on temporal frequency only were
discussed. In this section, another filtering approach is presented in
which signals are identified based on their dispersion velocity. For the
filtering of upstream and downstream moving optical disturbances a
logistic function was chosen,
$$f(x) = \frac{1}{1+\exp\{-kx\}} \textrm{.}
 \label{eqn:06_logistic}$$ This function was then expanded into
two-dimensions ($x$ and $t$). For a filter that removes disturbances
moving against the direction of flow, the filter should ideally return a
value of one in both the first and third quadrants and zero otherwise
when plotted in a graph of temporal versus spatial frequency. To
accomplish this, the logistic curve in each dimension was scaled and
offset to output values between negative one and positive one,
$$G_t(f) = \frac{2}{1+\exp\{-k_tf\}}-1
 \label{eqn:06_logistic_time}$$ and
$$G_x(\xi_x) = \frac{2}{1+\exp\{\pm k_x\xi_x\}}-1 \textrm{,}
 \label{eqn:06_logistic_space}$$ where $\pm$ determines whether the
filter is designed to act on upstream-traveling disturbances ($+$) or
downstream-traveling ($-$). These two gain functions are then multiplied
together and scaled to output values between zero and one,
$$G(\xi_x,f) = \frac{(G_t\cdot G_x)+1}{2} \textrm{.}
 \label{eqn:06_up_down_filter}$$ As the values of $k_x$ and $k_t$ go to
infinity an ideal filter is obtained. In a plot of the gain with the
horizontal spatial frequency on the x-axis and the temporal frequency on
the y-axis, an ideal filter for obtaining only the downstream traveling
disturbances would have a gain of one in the first and third quadrants,
zero in the second and fourth quadrants, and a value of $1/2$ when
either frequency is zero. The value of $1/2$ would equally split the
component of a disturbance that is neither traveling upstream or
downstream between the two directions.

The multidimensional spectrum using an ideal upstream-moving moving
filter on the synthetic wavefront is shown in Figure
[\[fig:06\_filter\_downstream\]](#fig:06_filter_downstream){reference-type="ref"
reference="fig:06_filter_downstream"} alongside the spectrum of the
unfiltered wavefront.

![Multidimensional spectral isosurface of the synthetic wavefront with a
downstream filter in
place.](../matlab/06_single_sensor_filtering/filter_downstream.eps)

[\[fig:06\_filter\_downstream\]]{#fig:06_filter_downstream
label="fig:06_filter_downstream"}

All of the upstream traveling disturbances are removed and the
disturbances at the stream-wise spatial frequency $\xi_x=0$ m$^{-1}$ are
significantly reduced. Some of the stationary modes (the vertical
cylinder along $\xi_x=0$ and $\xi_y=0$) remain while only the acoustic
and vibration signals that are propagating in the direction of flow
remain. The aero-optical signal from the boundary layer is clipped
slightly at $\xi_x=0$ due to the spatial width of the signal. The ratio
of the time-averaged spatial-RMS of the filtered signal when compared to
the aero-optical only signal was 1.24 while the unfiltered ratio was
1.53. When the filter was applied to the wavefront with only the
aero-optical boundary layer signal present the $\opdrms$ was reduced to
96% that of the unfiltered wavefront, showing that the filter does not
reduce the energy of aero-optical signals convecting with the flow.
Hence, this filter method will retain any disturbance that is traveling
in the direction of flow. Even with an ideal filter there is some slight
attenuation of the aero-optical signal due to signal having some
spectral width that crosses into upstream-moving portion of the
dispersion plot.

Velocity Filtering {#chap:06_velocity_filter}
------------------

For a nondispersive medium such as air, flow structures traveling at a
given speed have a constant slope on a multidimensional spectral plot. A
plane in the multidimensional spectral plot can therefore be used to
measure a flow structure's velocity in both $x$ and $y$-directions. The
distance from any given point in the multidimensional spectral space to
a plane described by the velocities $u_x$ and $u_y$ can be computed by
$$d = \frac{|u_x\xi_x+u_y\xi_y-f|}{\sqrt{u_x^2+u_y^2+1}} \textrm{.}
 \label{eqn:06_dist_point_2_plane}$$ Equation
[\[eqn:06\_dist\_point\_2\_plane\]](#eqn:06_dist_point_2_plane){reference-type="ref"
reference="eqn:06_dist_point_2_plane"} above can therefore be used to
construct a low-pass or high-pass filter that retains only disturbances
that are traveling at that velocity, or to exclude those disturbances,
$$G(d) = \frac{1}{\sqrt{1+\left(\frac{d}{d_c}\right)^{\pm2n}}} \textrm{.}
  \label{eqn:06_butterworth_velocity}$$ where $d_c$ is the cutoff
distance from the plane defined by the velocities $u_x$ and $u_y$.
Because of differences in the temporal and spatial sample rates of
several orders of magnitude, the filter function employed in this
research used frequencies that have been normalized by the sample rate.

An example of a low-pass velocity-filter applied to the synthetic
wavefront generated in Chapter
[5](#chap:05_synthetic){reference-type="ref"
reference="chap:05_synthetic"} is shown in Figure
[\[fig:06\_filter\_velocity\]](#fig:06_filter_velocity){reference-type="ref"
reference="fig:06_filter_velocity"}.

![Multidimensional spectral isosurface of the synthetic wavefront with a
low-pass velocity-filter in
place.](../matlab/06_single_sensor_filtering/filter_velocity.eps)

[\[fig:06\_filter\_velocity\]]{#fig:06_filter_velocity
label="fig:06_filter_velocity"}

The filter was constructed for a $u_x$ set at the mean boundary-layer
velocity, and $u_y$ set to zero. The values of the other two filter
parameters were selected as $d_c=1/80$, and $n=1$, which were chosen in
a trial-and-error process in which values were chosen, the filtered
multidimensional spectrum was computed, and refinements to the parameter
values were made based on how well the filtered spectrum captured just
the boundary-layer signal. Figure
[\[fig:06\_filter\_velocity\]](#fig:06_filter_velocity){reference-type="ref"
reference="fig:06_filter_velocity"} shows that, using these filter
parameters, the velocity-filtered multidimensional spectrum successfully
retains primarily only the aero-optical signal with some additional
low-frequency content from the blade-passing frequency and harmonic
disturbances as well as some stationary and acoustic disturbances. The
ratio of the $\opdrms$ relative to that of the aero-optical-only signal
went from 1.53 in the unfiltered case to 1.01 in the filtered case,
showing that the velocity filter has filtered out a substantial amount
of noise and other unrelated signals from the aero-optical signal of the
boundary layer, which is presumed to be the objective of the
measurement. As such, this method can provide a very effective way to
quickly estimate the $\opdrms$ of a convecting aero-optical disturbance
in a noise-contaminated wavefront.

Another use of the velocity filter is measuring the speed of a broadband
convecting disturbance such as the aero-optical signal of a boundary
layer. This can be accomplished by applying a series of low-pass
velocity filters to the multidimensional spectrum of the wavefront along
with a high-pass radial frequency filter to remove a significant portion
of the stationary modes and acoustic cone,
$$S_{xx,f}(\xi_x,\xi_y,f) = S_{xx}(\xi_x,\xi_y,f) G_v^2 G_\rho^2 \textrm{,}
  \label{eqn:06_velocity_filter_measurement}$$ where $G_v$ is the
velocity filter and $G_\rho$ is the radial frequency
($\xi_rho^2 = \xi_x^2+\xi_y^2$) filter. Once the wavefront has been
filtered in multidimensional spectral space, the total power remaining
in the filtered spectrum can be calculated,
$$P = \sum (S_{xx,f}\prod{\overrightarrow{f_s}}) \textrm{.}$$ The
average convective velocity of the structure is then given by the filter
parameters that produce the maximum power in the filtered signal.

This velocity finding procedure described in the preceding paragraph was
tested on the synthetic wavefront generated in Chapter
[5](#chap:05_synthetic){reference-type="ref"
reference="chap:05_synthetic"}, which had a known boundary-layer mean
velocity. The results of the velocity finding analysis are shown in
Figure
[\[fig:06\_filter\_velocity\_measure\]](#fig:06_filter_velocity_measure){reference-type="ref"
reference="fig:06_filter_velocity_measure"}, which shows the power in
the filtered signal as a function of the $u_x$ parameter using in the
velocity filter component of Equation
[\[eqn:06\_velocity\_filter\_measurement\]](#eqn:06_velocity_filter_measurement){reference-type="ref"
reference="eqn:06_velocity_filter_measurement"}.

![Boundary layer velocity measurement of the synthetic wavefront using a
combination of a low-pass velocity filter and a high-pass radial
frequency filter. The maximum value at $u_{BL}/U=0.8$ corresponds with
the actual value used in the creation of the synthetic
wavefront.](../matlab/06_single_sensor_filtering/filter_velocity_measure.eps)

[\[fig:06\_filter\_velocity\_measure\]]{#fig:06_filter_velocity_measure
label="fig:06_filter_velocity_measure"}

The low-pass velocity filter used the same parameters as used previously
except that $u_x$ was varied and the high-pass radial frequency filter
used a cutoff value of 0.1 with an order of $n=2$. The radial frequency,
$\xi_\rho$, was normalized by the spatial sampling rate. In this case,
the boundary layer speed was determined to be 163 m/s which corresponds
to the design velocity of the synthetic signal of $0.8U$. For signals
where the mean-velocity component of the aero-optical signal is not
aligned with either the horizontal or vertical axis, both velocity
components can be varied in the velocity filter. This produces a
three-dimensional surface of filtered signal power as a function of
$u_x$ and $u_y$ in the velocity filter, where the velocity components of
the moving signal are given by the maximum power of the surface. An
example of this method is shown in Figure
[\[fig:06\_filter\_velocity\_real\]](#fig:06_filter_velocity_real){reference-type="ref"
reference="fig:06_filter_velocity_real"}, which was computed using
experimental wavefront data acquired in the White Field wind tunnel at
M=0.5.

![Velocity low-pass filter used to determine the mean disturbance
velocity of measured data presented in Figure
[\[fig:04\_dispersion\_3d\]](#fig:04_dispersion_3d){reference-type="ref"
reference="fig:04_dispersion_3d"}. The velocity in the x-direction was
measured to be 152 m/s and 3 m/s in the
y-direction.](../matlab/06_single_sensor_filtering/filter_velocity_real.eps)

[\[fig:06\_filter\_velocity\_real\]]{#fig:06_filter_velocity_real
label="fig:06_filter_velocity_real"}

In this case the same filtering parameters were used as the synthetic
case except the distance cutoff was $d_c=1/40$ and both $u_x$ and $u_y$
were variables. The velocity components of the boundary-layer optical
disturbances determined from Figure
[\[fig:06\_filter\_velocity\_real\]](#fig:06_filter_velocity_real){reference-type="ref"
reference="fig:06_filter_velocity_real"} are 152 m/s in the x-direction
and 3 m/s in the y-direction. This boundary-layer velocity is
approximately 0.85 times the freestream velocity when compared to the
pitot probe measurement of the free-stream velocity, which is very close
to the accepted speed of the optically-aberrating structures in a
boundary-layer flow [@Gordeyev-2014-jcJndkHM]. The overall flow angle of
the boundary-layer with respect to the orientation of the measurement
beam was approximately $1.1^\circ$.

Baseline Spectrum {#chap:06_baseline}
-----------------

If all of the narrow-band temporal signals in a data set can be assumed
to be measurement contamination that needs to be filtered out, a method
for calculating the baseline of the spectrum provides a simple way of
filtering a portion of the signal contamination. For example, during
analysis of Raman spectra, the baseline spectra must often be removed
[@Schulze-2012-GmyAqzC7]. This task is often performed manually which
has resulted in a number of attempts to create automated techniques to
estimate the baseline spectra
[@Mosier-Boss-1995-keK3ckUN; @Schulze-2005-QkUeywxD; @Schulze-2012-GmyAqzC7; @Zhao-2007-HAc6j8Wb].
One of those techniques [@Schulze-2012-GmyAqzC7], a small-window
moving-average based, fully automated baseline estimation method was
used in this research. For this method, at each spatial frequency
location, the baseline spectrum was computed along the temporal axis.
This process estimates the baseline spectrum, $\mathbf{b}$, from the
measured spectrum, $\mathbf{m}$,
$$\mathbf{m} = (\mathbf{b}+\mathbf{x})*\mathbf{p}+\mathbf{n} = \mathbf{b}*\mathbf{p}+\mathbf{x}*\mathbf{p}+\mathbf{n} \textrm{,}$$
where $\mathbf{x}$ is a pure or underlying signal vector, $\mathbf{p}$
is an instrumental blurring function, $\mathbf{n}$ is measurement noise,
and $*$ is convolution operator.

Figure
[\[fig:06\_filter\_baseline\]](#fig:06_filter_baseline){reference-type="ref"
reference="fig:06_filter_baseline"}, shows the multidimensional spectrum
of an unfiltered measurement (top left) and its estimated baseline
spectrum (top right).

![Baseline spectrum estimation. The top left plot shows the unfiltered
multidimensional spectrum and the baseline spectrum on the top right.
The green line in each of these plots represents the location at which
the spectra in the bottom plot is
shown.](../matlab/06_single_sensor_filtering/filter_baseline.eps)

[\[fig:06\_filter\_baseline\]]{#fig:06_filter_baseline
label="fig:06_filter_baseline"}

The bottom plot of the figure shows the unfiltered and baseline spectra
along the green line in the two multidimensional spectral plots. The
total power of the signal has been reduced by $~71\%$ with all of the
narrow-band signals removed. A large portion of this signal removal is
the very low temporal frequency components. The blade-passing frequency
and harmonics are completely removed but the broadband acoustic
duct-modes remain intact. The peak of the boundary-layer signal is
reduced slightly as well as the high frequency fluctuations.

Basic Filter Summary
--------------------

Three different basic wavefront filters were shown and discussed in this
chapter. The temporal filter is most useful when filtering out a
frequency band of optical noise. Besides filtering out optical noise,
band-pass filters can be used to analyze a wavefront over a narrow-band
to examine the optical aberrations at specific frequencies that
significantly contribute to the overall optical disturbance; for
example, as was shown in Chapter
[3](#chap:03_optical_acoustics){reference-type="ref"
reference="chap:03_optical_acoustics"}, band-pass filters along with an
implementation of an acoustic mode-marching method can help determine
with some confidence that a narrow-band signal is likely to have been
created by the wind-tunnel fan and can be removed.

Filters that separate upstream and downstream-moving disturbances are
useful to filter out the optical contamination that comes from acoustic
signals that are traveling upstream from a wind-tunnel fan. These
filters would also be useful for separating out an aero-optical signal
that has a broad range of velocities that can occur in a span wise
measurement of a boundary layer. The velocity filter is the most useful
for isolating the aero-optical portion of a wavefront measurement given
the aero-optical signal has a fairly narrow and constant velocity range.
This filter also can be used to measure the speed associated with an
optical disturbance in both x and y-directions.

The spectral baseline provides an simple way of removing all of the
narrow-band signals with slight attenuation to the broadband signals.
The broadband acoustic and stationary modes remain but could be filtered
with via other techniques such as using a velocity filter. Narrow-band
features that are not likely to be environmental contamination could be
easily added back in.

Multiple Sensor Filtering of Optical Wavefronts
-----------------------------------------------

In the previous sections, methods of filtering optical wavefront
corruption by applying a variety of filters to the wavefront in the
multidimensional spectral domain were investigated. These techniques
involve only data from the optical wavefront itself and user knowledge
and experience to obtain filtered data. When additional data are
available, such as from microphones or accelerometers, a targeted filter
approach becomes possible.

This kind of approach is described in a previous study
[@DeLucca-2014-RAJvGdv7] in which a combination of linear stochastic
estimation (LSE) and spectral proper orthogonal decomposition (SPOD) was
used to remove vibration related contamination from aero-optical
wind-tunnel measurements. This process along with optical tip and tilt
removal showed approximately an 85% removal of contamination in the
measured $\opdrms$ by using accelerometer measurements to remove
vibration effects from optical wavefront measurements.

Finally, this chapter concludes by showing results produced by applying
the LSE-SPOD filter to experimental wavefront data acquired in the White
Field wind tunnel, both by itself and in combination with the filters
described in Chapter [6](#chap:06_single_filter){reference-type="ref"
reference="chap:06_single_filter"}. The objective of the filtering
approaches shown was to filter out contamination from the aero-optical
signal produced by the boundary layer on the measurement aperture. The
performance of the various filtering methods are compared and
recommendations for the best filtering approach are given.

### Optical Tip and Tilt

Although they are usually not employed in aero-optical investigations,
Zernike polynomials have been traditionally used for modal decomposition
of the optical aberrations of an optical system [@Born-1965-HHGYgjdH].
These polynomials are defined on the unit circle and form a set of
orthogonal functions, $$Z_n^m(\rho,\theta) = R_n^m(\rho)\cos(m\theta)
  \label{eqn:07_zernike}$$ where $R_n^m(\rho)$ is the radial basis
function and $\cos(m\theta)$ is the angular basis function. For values
of $-m$ the angular basis function becomes $\sin(m\theta)$. The radial
basis function are developed from Jacobi polynomials but for purposes of
this study, only a few simple ones will be used. An optical wavefront
can be represented by a summation of Zernike polynomials multiplied by
their corresponding coefficients $$\wf = \sum Z_ja_j \textrm{.}
  \label{eqn:07_zernike_coeff}$$

The Noll naming scheme is a method of organizing the Zernike polynomials
into a single notation of $Z_j$, along with normalizing each polynomial
to have a spatial RMS equal to one [@Noll-1976-HHKzd88f]. The first
three of these using the Noll naming scheme are piston, tip, and tilt.
Piston is simply the average $\opd$ value of the wavefront
$$Z_1 = 1 \textrm{.}
  \label{eqn:07_zernike_1}$$ Tip and tilt are the best planar fit to the
$\opd$ along the x-axis and y-axis respectively where tip is
$$Z_2 = 2\rho\cos\theta \textrm{,}
  \label{eqn:07_zernike_2}$$ and tilt is
$$Z_3 = 2\rho\sin\theta \textrm{.}
  \label{eqn:07_zernike_3}$$ Once the coefficients for these modes are
solved for they can be removed from the original wavefront, $WF$:
$$WF^F = WF-\sum Z_ja_j \textrm{.}$$

### LSE-SPOD

The LSE-SPOD technique starts with performing SPOD on the primary data
set and then using the Fourier transforms of the additional sensor data
to perform a filtering operation. The spectral proper orthogonal
decomposition technique is described in detail by Schmidt and Colonius
[@Schmidt-2020-m2emACkX]. A schematic of the SPOD algorithm is shown in
Figure
[\[fig:07\_spod\_algorithm\]](#fig:07_spod_algorithm){reference-type="ref"
reference="fig:07_spod_algorithm"}.

![Schematic of the SPOD algorithm (taken from [@Schmidt-2020-m2emACkX]).
The numbers in parentheses denote the equations
used.](../other-sources/schmidt_2020_figure_01.jpeg "fig:") (-20,235)
(-230,210) (-20,102) (-231,69)

[\[fig:07\_spod\_algorithm\]]{#fig:07_spod_algorithm
label="fig:07_spod_algorithm"}

The algorithm begins by separating the original data set, $Q$, into a
number of smaller blocks, $$Q = \left[
  \begin{matrix}
    \mid & \mid & & \mid \\
    q^{(1)} & q^{(2)} & \cdots & q^{(N)} \\
    \mid & \mid & & \mid
  \end{matrix}
  \right]\textrm{,}\quad Q\in\mathbb{C}^{M\times N}
  \label{eqn:07_data_block}$$ where $M$ is the total number of degrees
of freedom (number of spatial points times the block length in time) and
$N$ is the number of blocks. Each block is then Fourier Transformed in
the temporal dimension or through all dimensions. Once in the frequency
domain the data blocks are then reorganized by creating new blocks of
identical temporal-frequencies, $$\hat{Q} = \left[
  \begin{matrix}
    \mid & \mid & & \mid \\
    \hat{q}^{(1)} & \hat{q}^{(2)} & \cdots & \hat{q}^{(N)} \\
    \mid & \mid & & \mid
  \end{matrix}
  \right]\textrm{,}\quad \hat{Q}\in\mathbb{C}^{M\times N}
  \label{eqn:07_frequency_block}$$ where $M$ is now the number of
spatial points times the number of blocks and $N$ is block length in
time. Proper orthogonal decomposition is then performed separately on
each temporal-frequency block via either traditional POD
$$\hat{C} = \frac{1}{N-1}\hat{Q}\hat{Q}^H \textrm{,}
  \label{eqn:07_pod_01}$$
$$\hat{C}W\hat{\Phi}=\hat{\Phi}\hat{\Lambda} \textrm{,}
  \label{eqn:07_pod_02}$$ or the method of snapshots,
$$\hat{Q}^HW\hat{Q}\hat{\Psi}=\hat{\Psi}\hat{\Lambda} \textrm{,}
  \label{eqn:07_pod_03}$$ $$\hat{\Phi}=\hat{Q}\hat{\Psi} \textrm{,}
  \label{eqn:07_pod_04}$$ where $H$ denotes the Hermitian transpose, $W$
is a weighting matrix, $\Phi$ is the set of deterministic spatial
functions, $\Lambda$ is the eigen-values, and $\Psi$ is the coefficient
matrix.

The linear stochastic estimation portion of the technique is described
by Adrian [@Adrian-1975-VenaZyuv]. This process uses a linear sum,
$L_{ij}$, of additional measurements, $y_j$, to approximate a measured
signal, $x_i$, $$x_i^{LSE}=L_{ij}y_j \textrm{,}
  \label{eqn:07_lse_01}$$ where
$$L_{ij} = \langle x_iy_k\rangle\langle y_jy_k\rangle^{-1} \textrm{.}
  \label{eqn:07_lse_02}$$ When combined with SPOD, the estimation
matrix, $L$, becomes
$$L=(\hat{\Psi}\hat{y}^H)(\hat{y}\hat{y}^H)^{-1} \textrm{,}
  \label{eqn:07_lse_spod_01}$$ which allows for an estimated version of
the coefficient matrix to be calculated
$$\hat{\Psi}^E=L\hat{y} \textrm{.}
  \label{eqn:07_lse_spod_02}$$ The estimated coefficient matrix contains
portions of the original signal that best resemble the additional sensor
data. Assuming that the additional sensor data represents signal
contamination of the original signal, a filtered coefficient matrix can
be computed from the difference between the original and estimated
coefficient matrices. $$\hat{\Psi}^F=\hat{\Psi}-\hat{\Psi}^E \textrm{.}
  \label{eqn:07_lse_spod_03}$$ A filtered signal, $Q^F$ can be
constructed by using the filtered coefficient matrix and the spatial
functions, $$\hat{Q} = \hat{\Psi}^F\hat{\Phi}^H \textrm{.}$$

### Filtering Experimental Data

The filtering technique described in the preceding section was applied
to the same data sets that were shown in Figure
[\[fig:04\_dispersion\_mach\]](#fig:04_dispersion_mach){reference-type="ref"
reference="fig:04_dispersion_mach"}, either separately or in combination
with the basic filtering methods described earlier in this chapter.
Simultaneous accelerometer and microphone measurements were made
alongside the optical wavefront measurements. The locations of some of
the additional sensors are shown in Figure
[\[fig:07\_sensor placement\]](#fig:07_sensor placement){reference-type="ref"
reference="fig:07_sensor placement"} with a CAD drawing of the test
section in Figure
[\[fig:07\_test\_section\_mic\_accel\]](#fig:07_test_section_mic_accel){reference-type="ref"
reference="fig:07_test_section_mic_accel"}. Table
[\[tab:07\_sensor\_list\]](#tab:07_sensor_list){reference-type="ref"
reference="tab:07_sensor_list"} shows a list of the additional sensors
including the number designation used in Figures
[\[fig:07\_sensor placement\]](#fig:07_sensor placement){reference-type="ref"
reference="fig:07_sensor placement"} and
[\[fig:07\_test\_section\_mic\_accel\]](#fig:07_test_section_mic_accel){reference-type="ref"
reference="fig:07_test_section_mic_accel"}, the model of the sensor and
preamplifier used as well as a sensor grouping designation.

![The locations of some of the additional sensors used in the LSE-SPOD
filtering. The sensors are labeled with the sensor numbers, see Table
[\[tab:07\_sensor\_list\]](#tab:07_sensor_list){reference-type="ref"
reference="tab:07_sensor_list"}.](../photos/IMG_9655.jpeg "fig:"){width="90%"}
(-65,120) (-40,220) (-50,165) (-125,40) (-243,240) (-180,120) (-320,110)

[\[fig:07\_sensor placement\]]{#fig:07_sensor placement
label="fig:07_sensor placement"}

![CAD drawing view of the inside of the test-section with some of the
sensor locations labeled. Flow is from left to right. The numbers in the
circles are the sensor numbers on the model side of the test-section.
The numbers in the square are the sensor numbers opposite of the model
side. The dashed line represents the optics window opposite of the model
for the beam angle of $90^\circ$. The window was moved up and downstream
depending on the beam
angle.](../cad/test_section_mic_accel.pdf "fig:"){width="90%"} (-272,77)
(-274,60) (-131,61) (-133,45) (-203,82) (-220,46) (-188,46) (-188,12)
(-243,100) (-140,100) (-350,10)Flow $\Longrightarrow$

[\[fig:07\_test\_section\_mic\_accel\]]{#fig:07_test_section_mic_accel
label="fig:07_test_section_mic_accel"}

   Channel    Sensor Type      Model        Preamp         Group
  --------- --------------- ------------ ------------ ---------------
      1       Microphone     ACO 7016B     B&K 2690       Ambient
      2       Microphone      B&K 4939     B&K 2690       Ambient
      3       Microphone     PCB 103B02    PCB 483C    Test Section
      4       Microphone     PCB 103B02    PCB 483C    Test Section
      5       Microphone     PCB 103B02    PCB 483C    Test Section
      6       Microphone     PCB 103B02    PCB 483C    Test Section
      7      Accelerometer   PCB 352C33    PCB 483C    Primary Lens
      8      Accelerometer   PCB 352C33    PCB 483C    Test Section
      9      Accelerometer   PCB 352C33    PCB 483C    Test Section
     10      Accelerometer   PCB 352C33    PCB 483C    Test Section
     11      Accelerometer   PCB 352C33   PCB 482A22   Test Section
     12      Accelerometer   PCB 352C33   PCB 482A22   Test Section
     13      Accelerometer   PCB 352C33   PCB 482A22   Test Section
     14      Accelerometer   PCB 352C33   PCB 482A22   Optics Bench
     15      Accelerometer   PCB 352C33   PCB 482A22   Return Mirror
     16      Accelerometer   PCB 352C33   PCB 482A22   Return Mirror

  : Additional sensors used the the LSE-SPOD filtering.

[\[tab:07\_sensor\_list\]]{#tab:07_sensor_list
label="tab:07_sensor_list"}

All of the test-section mounted sensors are shown in their approximate
locations in Figure
[\[fig:07\_test\_section\_mic\_accel\]](#fig:07_test_section_mic_accel){reference-type="ref"
reference="fig:07_test_section_mic_accel"} in a view that is looking at
the wind-tunnel model from inside of the test-section with the flow
moving from left-to-right. The dashed box represent the optical window
on the opposite side of the tunnel from the model which was moved up or
downstream depending on the beam angle relative to the flow. Sensors
11-13 were attached to this optical window and moved with it. The
picture in Figure
[\[fig:07\_sensor placement\]](#fig:07_sensor placement){reference-type="ref"
reference="fig:07_sensor placement"} was taken from the opposite side of
the test-section and model that is shown in Figure
[\[fig:07\_test\_section\_mic\_accel\]](#fig:07_test_section_mic_accel){reference-type="ref"
reference="fig:07_test_section_mic_accel"} and as such the flow goes
from right-to-left.

Two microphones were used for ambient measurement (a ACO 7016B
[@ACO-Microphones] and a Brüel & Kjær 4939 [@Bruel-Kjaer-4939]), four
microphones were used for test-section noise measurement (PCB 103B02
[@PCB-103B02-C]), and ten accelerometers were located throughout the
setup (PCB 352C33 [@PCB-352C33-H]). One of the ambient microphones was
mounted to the top of the optics bench facing the test-section and can
be seen in Figure
[\[fig:07\_sensor placement\]](#fig:07_sensor placement){reference-type="ref"
reference="fig:07_sensor placement"} just to the right of the primary
lens and the other ambient microphone was hanging below the optics bench
end towards the test-section.

The test-section microphones were in groups of two either upstream or
downstream from the optical beam by about 20-inches, with the upstream
microphone locations viewable in Figure
[\[fig:07\_sensor placement\]](#fig:07_sensor placement){reference-type="ref"
reference="fig:07_sensor placement"} (sensors 3 and 4) and shown in
Figure
[\[fig:07\_test\_section\_mic\_accel\]](#fig:07_test_section_mic_accel){reference-type="ref"
reference="fig:07_test_section_mic_accel"}. The model installed in the
test-section represents the outside of an aircraft fuselage with a
5-foot diameter and is angled to account for the aircraft's
angle-of-attack ( 6$^\circ$) for steady-level-flight at cruise. This
results in the fuselage model being shifted approximately 2-inches
higher from the test-section centerline upsteam at the microphone
location. The duct microphones were placed about 2.75-inches from the
model centerline.

There were six accelerometers attached to the test-section windows, with
three being on each side as shown in Figure
[\[fig:07\_test\_section\_mic\_accel\]](#fig:07_test_section_mic_accel){reference-type="ref"
reference="fig:07_test_section_mic_accel"}. The locations of the three
accelerometers (sensors 8-10) on the model side can be seen in Figure
[\[fig:07\_sensor placement\]](#fig:07_sensor placement){reference-type="ref"
reference="fig:07_sensor placement"}, the three accelerometers on the
other window used the opposite pattern (two high and one low). The
optical window on the far side of the test-section was moved laterally
depending on the angle of the beam relative to the flow. One
accelerometer was placed on the primary lens (also shown, sensor 7) and
one was placed in the center of the optics bench. The last two
accelerometers were located on the back of the return mirror with one on
the top and the other on the side.

Results
-------

The power-spectra of all of the sensors at the three Mach numbers are
shown in Figure
[\[fig:07\_sensor\_spectra\]](#fig:07_sensor_spectra){reference-type="ref"
reference="fig:07_sensor_spectra"}.

![Power-spectra of the additional sensor measurements at the three Mach
numbers tested. The x-axis is in Strouhal number per characteristic
length
($St/l$).](../matlab/07_multiple_sensor_filtering/sensor_spectra.eps)

[\[fig:07\_sensor\_spectra\]]{#fig:07_sensor_spectra
label="fig:07_sensor_spectra"}

These plots are presented as Strouhal number per unit characteristic
length, since this puts the signals related to the fan blade-passing
frequency at the same x-axis location for all three tested wind speeds.
Figure
[\[fig:07\_sensor\_spectra\]](#fig:07_sensor_spectra){reference-type="ref"
reference="fig:07_sensor_spectra"} also shows the different groups of
sensors shown together in separate plots. The blade-passing frequency
for these data sets is at a $St/l$ of approximately 3 $m^{-1}$ with a
clear and consistent narrow-band signal at that $St/l$ for all but the
$M=0.3$ run, which has a slight increase in signal for some of the
sensors. For the $M=0.5$ case there is an additional strong narrow-band
signal at 20 $m^{-1}$ for all sensors and a slightly broader signal at
38 $m^{-1}$ that is only present in the test-section mounted sensors
that may be due to extra fan vibration which was limiting the top speed
of the wind-tunnel. The test-section mounted microphones are picking up
boundary layer acoustic noise above $St/l$ of approximately 20 $m^{-1}$.

Two variants of the filtering technique were tried. The first was a
standard LSE-SPOD technique in which the spectral POD was performed on
the data set that was Fourier transformed in time only. For the second
technique, which will be referred to here as LSE-MSPOD, the spectral POD
was applied to a data set in which the Fourier transform was performed
in all dimensions of space and time, which is a portion of the
computation for the multidimensional spectral estimation. Figures
[\[fig:07\_lse\_spod\]](#fig:07_lse_spod){reference-type="ref"
reference="fig:07_lse_spod"} and
[\[fig:07\_lse\_mspod\]](#fig:07_lse_mspod){reference-type="ref"
reference="fig:07_lse_mspod"} show multidimensional power spectrum plots
at a temporal block length of $2^{10}$ with no overlap.

![A multidimensional power spectrum of an unfiltered wavefront and the
same wavefront filtered with the LSE-SPOD method using all 16 additional
microphone or accelerometer measurements.
](../matlab/07_multiple_sensor_filtering/lse_spod.eps)

[\[fig:07\_lse\_spod\]]{#fig:07_lse_spod label="fig:07_lse_spod"}

![A multidimensional power spectrum of an unfiltered wavefront and the
same wavefront filtered with the LSE-MSPOD method using all 16
additional microphone or accelerometer measurements.
](../matlab/07_multiple_sensor_filtering/lse_mspod.eps)

[\[fig:07\_lse\_mspod\]]{#fig:07_lse_mspod label="fig:07_lse_mspod"}

These plots show the $f$-$\xi_x$ plane of the multidimensional spectrum
that captures horizontally-moving (streamwise) plane waves with a
portion of the acoustic cone isosurface wrapping behind it. Both of
these methods performed effectively identically to one another with a
14.2% drop in overall RMS value of the filtered wavefront (both time and
space). There is a significant drop in the signal at the blade-passing
frequency and its harmonics, especially at the higher spatial
frequencies. The stationary signal information is also significantly
reduced along with the high temporal-frequency acoustic signal. The
aero-optical boundary layer signal is also partially reduced, which is
most noticeable at higher temporal-frequencies.

                              M=0.3           M=0.4           M=0.5
  ---------------------- --------------- --------------- ---------------
         Original            0.0561          0.0521          0.0824
     Tip/Tilt Removal     0.0120(78.6%)   0.0195(62.6%)   0.0291(64.7%)
      Accelerometers      0.0102(81.8%)   0.0168(67.7%)   0.0251(69.5%)
   Ambient Microphones    0.0103(81.7%)   0.0170(67.3%)   0.0254(69.1%)
     Duct Microphones     0.0103(81.6%)   0.0170(67.3%)   0.0255(69.0%)
   Test-Section Sensors   0.0103(81.6%)   0.0168(67.8%)   0.0252(69.4%)
       All Sensors        0.0099(82.3%)   0.0163(68.8%)   0.0242(70.6%)

  : $\opdrms$ ($\mu m$) comparison of using different combinations of
  additional sensor information in the LSE-MSPOD filtering process.

[\[tab:07\_lse\_mspod\_table\]]{#tab:07_lse_mspod_table
label="tab:07_lse_mspod_table"}

Table
[\[tab:07\_lse\_mspod\_table\]](#tab:07_lse_mspod_table){reference-type="ref"
reference="tab:07_lse_mspod_table"} shows the time averaged $\opdrms$ of
three different data sets at a beam angle through the test-section of
$90^\circ$. The data sets were at Mach numbers of 0.3, 0.4, and 0.5 and
had an unfiltered $\opdrms$ of 0.0561, 0.0521, and 0.0824 $\mu m$
respectively. Note that in the raw processed wavefronts, the $\opdrms$
at a Mach number of 0.3 was higher than the 0.4 case. There was a
significant drop of between 62.6 and 78.6% in the $\opdrms$ by removing
the Zernike modes corresponding to tip and tilt. It is at this point the
Mach number of 0.4 case has a higher $\opdrms$ than the 0.3 case as
would be expected [@Gordeyev-2014-jcJndkHM]. Note that it is standard
practice to remove optical tip/tilt from wavefront measurements, since
tip/tilt is largely imposed by the measurement optics rather than the
actual aero-optical flow.

Table
[\[tab:07\_lse\_mspod\_table\]](#tab:07_lse_mspod_table){reference-type="ref"
reference="tab:07_lse_mspod_table"} also shows the effect of five
different combinations of additional sensors that were used for
filtering with the LSE-MSPOD process (the bracketed percentage in Table
[\[tab:07\_lse\_mspod\_table\]](#tab:07_lse_mspod_table){reference-type="ref"
reference="tab:07_lse_mspod_table"} shows the percent reduction in
$\opdrms$ due to the filtering). The first set was all of the
accelerometers which resulted in an additional drop in $\opdrms$ of
between 3 and 5%. The second and third sets used either the ambient or
duct microphones and those sets had slightly less reduction than the
accelerometers. The fourth set was the test-section sensors comprised of
six window mounted accelerometers and four duct mounted microphones.
This set of sensors performed the same as all of the accelerometers,
while the use of all of the additional sensors in the last set performed
the best, with an additional reduction in $\opdrms$ of 4 to 6% from the
tip/tilt removal cases.

In summary, Table
[\[tab:07\_lse\_mspod\_table\]](#tab:07_lse_mspod_table){reference-type="ref"
reference="tab:07_lse_mspod_table"} shows that using either the temporal
or multidimensional version of the LSE-SPOD filtering technique can help
remove some of the narrow-band acoustic and vibration reduction in an
optical wavefront. These temporally narrow-band signals have broadband
spatial content that is attenuated. This additional reduction does seem
to be somewhat tied to the number of sensors used with more sensors
having a greater impact on the signal reduction. Since the vibrations
and acoustics have the same primary source, the wind-tunnel fan, they
seems to do a relatively equivalent job at filtering the optical
contamination. Accelerometers have the benefit of easier installation
but the microphones do not necessarily have to be installed inside of
the wind-tunnel.

Combination of Filters {#chap:07_multiple_filter}
======================

The previous chapter investigated a series of filters that were applied
in a singular fashion to a set of optical wavefronts. This chapter will
discuss combining several of these filters together in series.

Velocity and LSE-SPOD Filter
----------------------------

In addition to the LSE-SPOD filter using all 16 additional sensors that
was shown in Chapter [6](#chap:06_single_filter){reference-type="ref"
reference="chap:06_single_filter"}, a velocity filter was applied to the
wavefront first. Table
[\[tab:07\_lse\_mspod\_table\_vel\]](#tab:07_lse_mspod_table_vel){reference-type="ref"
reference="tab:07_lse_mspod_table_vel"} shows the summary of these
filters when used separately or together. The LSE-SPOD was shown
previously to remove vibration noise from wavefront measurements with an
approximately 85% reduction in $\opdrms$ at Mach of 0.3
[@DeLucca-2014-RAJvGdv7]. Similar results were observed using the
combination of optical tip/tilt removal and LSE-SPOD on both single
dimension (temporal) and multidimensional spectra. Optical tip/tilt
removal alone accounted for a 78.6% reduction in $\opdrms$, with a
combination of 16 microphones and accelerometers and the LSE-SPOD
bringing the reduction in $\opdrms$ to 83.9% at Mach of 0.3. The
combination of tip/tilt removal and the velocity filter showed a greater
reduction of 82.3%. At a Mach number of 0.5, the use of optical tip/tilt
removal, the velocity filter, and 16 sensors in LSE-SPOD, the $\opdrms$
was brought down to 0.0181 $\mu m$ and stilled showed a significant
amount of narrow-band signals (see Figure
[\[fig:07\_lse\_spod\]](#fig:07_lse_spod){reference-type="ref"
reference="fig:07_lse_spod"} and
[\[fig:07\_lse\_mspod\]](#fig:07_lse_mspod){reference-type="ref"
reference="fig:07_lse_mspod"}). This is about a 30% reduction when
compared with the other filters used in Table
[\[tab:08\_filter\_summary\]](#tab:08_filter_summary){reference-type="ref"
reference="tab:08_filter_summary"}, and represents almost entirely an
additional reduction in contamination to the aero-optical signal by
removing the broadband disturbances. This was also significantly above
the estimated $\opdrms$ of 0.0142 $\mu m$ for the $M=0.6$ case (See
Section [2.1.2](#sect:02_BL_OPD){reference-type="ref"
reference="sect:02_BL_OPD"} and [@Gordeyev-2014-jcJndkHM]).

                            M=0.3           M=0.4           M=0.5
  -------------------- --------------- --------------- ---------------
        Original           0.0561          0.0521          0.0824
       LSE-MSPOD        0.0099(82.3%)   0.0163(68.8%)   0.0242(70.6%)
    Velocity Filter     0.0090(83.9%)   0.0146(72.1%)   0.0217(73.7%)
   Velocity+LSE-MSPOD   0.0075(86.7%)   0.0122(76.7%)   0.0181(78.0%)

  : $\opdrms$ ($\mu m$) comparison of using LSE-MSPOD filtering process
  when combined with a velocity filter.

[\[tab:07\_lse\_mspod\_table\_vel\]]{#tab:07_lse_mspod_table_vel
label="tab:07_lse_mspod_table_vel"}

With the LSE-SPOD method the more sensors that were used in the
filtering process the greater the reduction in the $\opdrms$, as can be
seen in Figure
[\[fig:08\_lse\_summary\]](#fig:08_lse_summary){reference-type="ref"
reference="fig:08_lse_summary"}.

![Percent reduction in $\opdrms$ from the tip/tilt removed case using
LSE-SPOD filtering.](../matlab/08_conclusion/lse_summary.eps)

[\[fig:08\_lse\_summary\]]{#fig:08_lse_summary
label="fig:08_lse_summary"}

The combination of the DAQ and preamplifier used for the duct-mounted
microphones had a significantly lower dynamic range when compared to the
other sensors, possibly leading to a diminished reduction in the
performance of the four-sensor filtering. The signal reduction using all
16 sensors was fairly uniform with frequency, as shown in Figure
[\[fig:08\_lse\_mspod\_freq\]](#fig:08_lse_mspod_freq){reference-type="ref"
reference="fig:08_lse_mspod_freq"}.

![Reduction in $\opdrms(t)$ as a function of temporal frequency using 16
sensors with LSE-SPOD in the M=0.5 case when compared to tip/tilt
removal.](../matlab/07_multiple_sensor_filtering/lse_mspod_freq.eps)

[\[fig:08\_lse\_mspod\_freq\]]{#fig:08_lse_mspod_freq
label="fig:08_lse_mspod_freq"}

On average there was a 1.3dB/Hz reduction in the $\opdrms$ with slight
peaks at some of the significant narrow-band signals. At the
blade-passing frequency (517 Hz) there was a 2dB/Hz reduction and for
the narrow-band signals around 3 and 6 kHz there was a 3dB/Hz reduction.
The first, second, and third harmonics of the blade-passing frequency,
at 1034 Hz, 2068 Hz, and 4136 Hz, had a below average reduction in the
signal.

While the use of additional sensor measurements to aid in filtering of
optical wavefront measurements using LSE-SPOD showed little benefit in
this study (at least compared to the single sensor filtering
techniques), it could show significant benefit in future measurements.
Specifically, for measurements with models that are likely to create
narrow-band signal noise, additional sensor information could be used in
conjunction with a baseline filter for determining which narrow-band
signals that need to be retained in the spectrum.

Backward, Velocity, and Baseline Filter
---------------------------------------

Among the filters discussed, three are useful for isolating aero-optical
signals from a wavefront. The first of these is a filter for separating
the portion of the optical disturbances that are moving either upstream
or downstream to the flow (Section
[6.2](#chap:06_up_down_filter){reference-type="ref"
reference="chap:06_up_down_filter"}). An undesirable effect of this
filter is that it may remove some of the aero-optical signal, which can
happen to the boundary-layer signal[^1] at low temporal frequencies. The
second useful filter is the low-pass velocity filter which preserves the
signal that is moving within a narrow velocity range (Section
[6.3](#chap:06_velocity_filter){reference-type="ref"
reference="chap:06_velocity_filter"}). The third is the baseline
estimator (Section [6.4](#chap:06_baseline){reference-type="ref"
reference="chap:06_baseline"}), which removes the narrow-band signals
associated with the blade-passing frequency and its harmonics, the
mean-lensing component, and other temporally narrow-band signals.
However, some of these removed narrow-band signals could include part of
the aero-optical signal of the wind-tunnel model.

Figure
[\[fig:08\_dispersion\_filters\]](#fig:08_dispersion_filters){reference-type="ref"
reference="fig:08_dispersion_filters"} shows the multidimensional
spectra of the output of these three filters individually plus the
spectra of these three filters combined.

![Multidimensional spectra of three single sensor filtering techniques
and a combination
filter.](../matlab/08_conclusion/dispersion_filters.eps)

[\[fig:08\_dispersion\_filters\]]{#fig:08_dispersion_filters
label="fig:08_dispersion_filters"}

The backward moving filter, that removes all upstream-moving
disturbances (Figure
[\[fig:08\_dispersion\_filters\]](#fig:08_dispersion_filters){reference-type="ref"
reference="fig:08_dispersion_filters"} top left), does remove some of
the boundary-layer signal at low temporal frequencies. The portion of
the acoustic cone and stationary modes that are on the downstream-moving
portion of the spectrum are retained. The velocity filter (Figure
[\[fig:08\_dispersion\_filters\]](#fig:08_dispersion_filters){reference-type="ref"
reference="fig:08_dispersion_filters"} top right) removes most of the
broadband signal from the various noise sources. There is a portion of
the acoustic cone and stationary modes that intersect or lay near the
boundary-layer signal that is slightly attenuated, producing a slight
hump on the upstream-moving side of the boundary-layer that extends up
to about 10 kHz and along the $\xi_y$ axis over the range of about
$\pm25\ m^{-1}$.

The baseline filter (Figure
[\[fig:08\_dispersion\_filters\]](#fig:08_dispersion_filters){reference-type="ref"
reference="fig:08_dispersion_filters"} bottom left) removes all of the
temporal narrow-band signals including the mean-lensing portion of the
spectra. The noisy surface of the spectra is removed which also
eliminates some the boundary-layer aero-optical signal. The combination
filter (Figure
[\[fig:08\_dispersion\_filters\]](#fig:08_dispersion_filters){reference-type="ref"
reference="fig:08_dispersion_filters"} bottom right) applies the
velocity and backward moving filter to the baseline filter. This filter
loses some of the boundary-layer signal due to the noisy surface being
smoothed out and the portion that crosses into the upstream-traveling
portion of the spectrum. The portion of the acoustic cone and stationary
modes that is the most contaminating in the velocity filter is removed
due to the backward moving and baseline filter.

A zoomed in slice of the multidimensional spectra is shown in Figure
[\[fig:08\_dispersion\_filters\_slices\]](#fig:08_dispersion_filters_slices){reference-type="ref"
reference="fig:08_dispersion_filters_slices"} for the horizontal moving
plane waves.

![Multidimensional spectral slices for the various single sensor
filtering techniques showing the horizontal moving plane
waves.](../matlab/08_conclusion/dispersion_filters_slices.eps)

[\[fig:08\_dispersion\_filters\_slices\]]{#fig:08_dispersion_filters_slices
label="fig:08_dispersion_filters_slices"}

A large portion of the signal contamination happens at the blade-passing
frequency and its harmonics as well as in the mean-lensing region. This
contamination is present in all of the multidimensional spectra that do
not utilize the baseline filter. Even with the velocity filter there is
significant contamination on the upstream-moving portion of the spectra
due to these narrow-band signals as well as due to the presence of the
acoustic cone and stationary modes. While the backward moving filter
removes some of the boundary-layer signal it removes significantly more
of the noise signals that would otherwise be present in the spectra with
just the velocity and baseline filters applied.

Representative wavefronts were generated from these multidimensional
spectra using the same process as generating a synthetic wavefront from
the synthetic spectra in Chapter
[5](#chap:05_synthetic){reference-type="ref"
reference="chap:05_synthetic"} in order to calculate the $\opdrms$.
Table
[\[tab:08\_filter\_summary\]](#tab:08_filter_summary){reference-type="ref"
reference="tab:08_filter_summary"} shows the $\opdrms$ values for the
various filters used in Figure
[\[fig:08\_dispersion\_filters\_slices\]](#fig:08_dispersion_filters_slices){reference-type="ref"
reference="fig:08_dispersion_filters_slices"}.

       Filter        $\opdrms\ (\mu m)$
  ----------------- --------------------
        None               0.0260
   Backward Moving         0.0166
      Velocity             0.0238
      Baseline             0.0156
         V+B               0.0140
       BM+V+B              0.0110

  : Summary of single sensor filters

[\[tab:08\_filter\_summary\]]{#tab:08_filter_summary
label="tab:08_filter_summary"}

Both the backward moving and baseline filters reduced the $\opdrms$ of
the wavefront a similar amount of 36 and 40% respectively. The velocity
filter only reduced the $\opdrms$ a small amount of 8.5% due to the
retention of the strongest portion of the narrow-band signals. The
combination of the velocity and baseline filters reduced the $\opdrms$
of the wavefront by 46% but those still retain a significant portion of
the acoustic cone and stationary mode signal. By combining these three
single sensors filters, the $\opdrms$ was reduced 58% but this is likely
under the true value due to some loss of the boundary-layer signal from
the backward moving filter at low temporal frequencies and the removal
of the fluctuations from the baseline filter. There could be some
narrow-band signals that would be generated by a model that would be
removed with this filtering scheme. The estimated $\opdrms$ from
Gordeyev [@Gordeyev-2014-jcJndkHM] (Equations
[\[eqn:02\_opdrms\_gor\]](#eqn:02_opdrms_gor){reference-type="ref"
reference="eqn:02_opdrms_gor"} and
[\[eqn:02\_opdrms\_gor\_fit\]](#eqn:02_opdrms_gor_fit){reference-type="ref"
reference="eqn:02_opdrms_gor_fit"}) is $0.0142\ \mu m$ for a double
boundary layer, which puts the velocity and baseline filter combination
in good agreement.

Conclusion {#chap:08_conclusion}
==========

When aero-optical measurements are made in a wind tunnel, there are a
number of sources that contaminate the measurement with noise. This can
be seen in Figure
[\[fig:08\_dispersion\_isosurface\]](#fig:08_dispersion_isosurface){reference-type="ref"
reference="fig:08_dispersion_isosurface"} which shows a multidimensional
spectral estimation of an optical wavefront measurement made in a wind
tunnel.

![Multidimensional spectral estimation of an optical wavefront
measurement made in a wind
tunnel.](../matlab/08_conclusion/dispersion_isosurface.eps "fig:")
(-195,120) (-305,250) (-300,69)[BPF
$\Longrightarrow$]{style="color: white"}
(-231,180)[]{style="color: white"} (-235,50)

[\[fig:08\_dispersion\_isosurface\]]{#fig:08_dispersion_isosurface
label="fig:08_dispersion_isosurface"}

Figure
[\[fig:08\_dispersion\_isosurface\]](#fig:08_dispersion_isosurface){reference-type="ref"
reference="fig:08_dispersion_isosurface"} shows the full
multi-dimensional spectrum for wavefront data acquired in a wind tunnel,
including streamwise and vertical spatial frequencies ($\xi_x$ and
$\xi_y$), and temporal frequencies ($f$); however, in in Figure
[\[fig:08\_dispersion\_isosurface\]](#fig:08_dispersion_isosurface){reference-type="ref"
reference="fig:08_dispersion_isosurface"}, the half of the isosurface
which represents the portion of the signal that has a component that is
traveling vertically downward has been made transparent to show some of
the internal power spectrum of planar waves that are traveling parallel
to the direction of flow.

In Figure
[\[fig:08\_dispersion\_isosurface\]](#fig:08_dispersion_isosurface){reference-type="ref"
reference="fig:08_dispersion_isosurface"}, the aero-optical signal that
is considered to be the objective of the measurement is the boundary
layer which resembles a thin ellipsoid that has an angle in the
$x-\xi_x$ plane (where the $xi_x$-coordinate represents spatial
frequencies in the stream-wise direction) by an amount related to the
free-stream velocity (see Equation
[\[eqn:04\_velocity\_assumed\]](#eqn:04_velocity_assumed){reference-type="ref"
reference="eqn:04_velocity_assumed"}). Acoustic duct modes make up a
temporally broadband signal that forms a cone and have a significant
portion of the signal that travels upstream. In the $\xi_x-f$ plane the
outer surface of the acoustic cone is limited by the sonic lines at
$u\pm c$, while in the $\xi_y-f$ plane the limit is at $\pm c$. The
wind-tunnel fan produces temporally narrow-band acoustic and vibration
modes that are able to contaminate the wavefront measurement at the
blade-passing frequency (BPF) and its various harmonics.

Sources of noise shown in Figure
[\[fig:08\_dispersion\_isosurface\]](#fig:08_dispersion_isosurface){reference-type="ref"
reference="fig:08_dispersion_isosurface"} not related to the acoustics
include stationary modes and mean-lensing. The stationary modes do not
travel in any direction, their spatial frequencies are near zero and
their signal strength is fairly constant in time. Due to the temporally
white-noise nature of this signal, it is likely not physically relevant
and could be optical mode noise from the laser, electronic noise in the
camera, or even numerical noise from the processing code. At lower
frequencies, especially around the blade-passing frequency or its
harmonics, there is likely a significant number of stationary modes that
are due to vibration of various optical elements. The mean-lensing
portion of the signal ($\lessapprox 100$ Hz) is a slowly varying signal
with large spatial frequency content. A color coded multidimensional
spectral estimation plot that allows for easier identification of the
various component signals is shown in Figure
[\[fig:05\_synthetic\_dispersion\_input\]](#fig:05_synthetic_dispersion_input){reference-type="ref"
reference="fig:05_synthetic_dispersion_input"} and was used for
generating a synthetic wavefront. As such, a major contribution of this
dissertation research is an improved understanding of the signals and
contamination that appear in aero-optical data, and how those signals
appear in multi-dimensional spectra. This information provides a better
understanding of aero-optical data, as well as guidance towards methods
of filtering out contaminating noise sources.

Filtering of Optical Wavefronts
-------------------------------

Two main families of filtering techniques were examined in this
dissertation. The first family was single sensor filters, Chapter
[6](#chap:06_single_filter){reference-type="ref"
reference="chap:06_single_filter"}, which operate on the optical
wavefronts without knowledge of any other time resolved data. Some of
these filters may rely on additional information about the average
sampling conditions used to measure the wavefronts. The second family
was multiple sensor filters, Chapter
[7](#chap:07_multiple_filter){reference-type="ref"
reference="chap:07_multiple_filter"}, which filter the optical wavefront
using time resolved measurements from additional sensors.

### Single Sensor Filters

The single sensors filters operated directly on the optical wavefront
measurements. Most of these filters are based on Butterworth filters
[@Butterworth-1930-DvDrjKha] that operate in the multidimensional
Fourier domain using a transfer function, $\hat{H}(\xi_x,\xi_y,f)$,
$$\widehat{WF}(\xi_x,\xi_y,f) = \hat{H}(\xi_x,\xi_y,f)\fftthree(wf(x,y,t)) \textrm{,}$$
which can be inverse Fourier transformed back into the physical domain
or be used for calculating the multidimensional spectrum. Filtering can
also be performed on the multidimensional spectrum using the gain
function, $G^2 = \hat{H}\hat{H}^*$,
$$S_{xx}(\xi_x,\xi_y,f) = G^2(\xi_x,\xi_y,f)S_{xx}(\xi_x,\xi_y,f) \textrm{.}$$
The only filter that was investigated that was not based on basic
filters was a baseline spectrum estimator [@Schulze-2012-GmyAqzC7]. This
filter removes narrow-band peaks and noise peaks along the temporal
frequency axis smooth spectrum.

Other Useful Products
---------------------

### Synthetic Wavefront {#synthetic-wavefront}

A synthetic wavefront was developed in Chapter
[5](#chap:05_synthetic){reference-type="ref"
reference="chap:05_synthetic"} to test various filters used in Chapter
[6](#chap:06_single_filter){reference-type="ref"
reference="chap:06_single_filter"}. In the process used to create the
synthetic wavefront, each of these signal components was generated
separately in the multidimensional spectrum. While this synthetic
wavefront generation technique produced a qualitative approximation of a
wavefront, it provided a useful set of fully known data to test various
filters. There is some significant room for improvement in the process
of creating synthetic wavefronts that are more physically accurate. Even
without improvement this process may be useful in generating a set of
synthetic wavefronts with a known aero-optical and noise components that
can be used for training a neural network to filter [@Lo-1994-W6aWeuaT]
wavefront measurements. A neural network based filter may be able to
separate the overlapping component signals at low frequencies.

### Measuring Acoustic Field Optically

In section [3.2.2](#sect:03_examples_spherical){reference-type="ref"
reference="sect:03_examples_spherical"}, optical wavefront were shown to
have a fairly good agreement with a microphone for measuring the
fluctuating field strength of a spherical wave generated by a speaker.
The optical wavefront measurement however had issues when the acoustic
field diverged from being nearly spherical. Optical wavefronts can be a
method to non-intrusively measure an acoustic field, although the
beam-path integrated results of the wavefront measurement require
additional interpretation to extract information on the acoustic field.

### Acoustic Mode-Marching

An acoustic mode-marching method was developed to quickly estimate the
acoustic field within a wind-tunnel test-section assuming that the
primary noise source was the wind-tunnel fan. Although, this is likely
to have limited application in filtering of optical wavefronts, it is
useful for assisting researchers in determining whether specific
narrow-band signals are produced by the wind-tunnel fan and can be
filtered out. Since there may be upstream-traveling components of the
aero-optical signal such as that produced by recirculation zones or
sound produced by the test model, the capability to definitively
identify the optical signal produced by the wind-tunnel main fan is
useful information. There also maybe some application during the initial
design of a tunnel for estimating the acoustic field in some critical
components.

Recommendations For Future Research
-----------------------------------

There is a lot of research that can still be done on various filtering
techniques to remove signal contamination of aero-optical wavefront
measurements. This is especially true for filters that can utilize
additional sensor measurements. The process for creating the synthetic
wavefronts used in this research was a qualitative approximation that
can be made more physically accurate. Synthetic signal algorithms could
be developed for types other aero-optical disturbances such as sheer
layers [@Jumper-2017-8UnkaeqW]. Synthetic wavefront signals could aid in
the testing of algorithms used on adaptive optic systems. The acoustic
mode-marching analysis could be expanded to the case where a simple
model in the wind-tunnel test section.

[^1]: These low frequency aero-optical disturbances may be a combination
    of the outer boundary layer and free-stream turbulence.
